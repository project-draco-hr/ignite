{
  if (ccfg != null) {
    CacheMemoryMode memMode=ccfg.getMemoryMode();
    return new CacheObjectContext(ctx,new GridCacheDefaultAffinityKeyMapper(),ccfg.isCopyOnRead() && memMode == ONHEAP_TIERED,ctx.config().isPeerClassLoadingEnabled() || GridQueryProcessor.isEnabled(ccfg));
  }
 else   return new CacheObjectContext(ctx,new GridCacheDefaultAffinityKeyMapper(),false,ctx.config().isPeerClassLoadingEnabled());
}
