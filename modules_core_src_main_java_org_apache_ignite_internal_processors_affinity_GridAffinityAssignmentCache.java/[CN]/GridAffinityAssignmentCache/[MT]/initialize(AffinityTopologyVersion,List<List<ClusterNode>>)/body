{
  GridAffinityAssignment assignment=new GridAffinityAssignment(topVer,affAssignment);
  affCache.put(topVer,assignment);
  head.set(assignment);
  for (  Map.Entry<AffinityTopologyVersion,AffinityReadyFuture> entry : readyFuts.entrySet()) {
    if (entry.getKey().compareTo(topVer) >= 0)     entry.getValue().onDone(topVer);
  }
}
