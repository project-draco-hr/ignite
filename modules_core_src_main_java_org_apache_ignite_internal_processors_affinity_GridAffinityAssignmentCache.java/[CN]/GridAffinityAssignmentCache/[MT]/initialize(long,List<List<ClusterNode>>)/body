{
  GridAffinityAssignment assignment=new GridAffinityAssignment(topVer,affAssignment);
  affCache.put(topVer,assignment);
  head.set(assignment);
  for (  Map.Entry<Long,AffinityReadyFuture> entry : readyFuts.entrySet()) {
    if (entry.getKey() >= topVer)     entry.getValue().onDone(topVer);
  }
}
