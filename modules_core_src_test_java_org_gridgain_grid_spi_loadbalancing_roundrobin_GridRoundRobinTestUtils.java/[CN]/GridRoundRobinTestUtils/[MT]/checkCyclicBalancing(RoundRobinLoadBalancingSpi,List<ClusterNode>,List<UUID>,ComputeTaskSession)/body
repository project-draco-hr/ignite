{
  ClusterNode firstNode=spi.getBalancedNode(ses,allNodes,new GridTestJob());
  int startIdx=firstBalancedNodeIndex(firstNode,orderedNodes);
  for (int i=0; i < allNodes.size() * 2; i++) {
    int actualIdx=(startIdx + i + 1) % allNodes.size();
    ClusterNode nextNode=spi.getBalancedNode(ses,allNodes,new GridTestJob());
    assertEquals("Balancer returns node out of order",nextNode.id(),orderedNodes.get(actualIdx));
  }
}
