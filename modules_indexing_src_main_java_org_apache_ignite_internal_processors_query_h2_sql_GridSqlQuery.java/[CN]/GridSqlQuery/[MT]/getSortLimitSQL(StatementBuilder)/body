{
  if (!sort.isEmpty()) {
    buff.append("\nORDER BY ");
    boolean first=true;
    for (    GridSqlSortColumn col : sort) {
      if (first)       first=false;
 else       buff.append(", ");
      int idx=col.column();
      if (idx >= 0)       buff.append(idx + 1);
 else {
        throw new IgniteException("Failed to generate query: " + buff);
      }
      if (!col.asc())       buff.append(" DESC");
      if (col.nullsFirst())       buff.append(" NULLS FIRST");
 else       if (col.nullsLast())       buff.append(" NULLS LAST");
    }
  }
  if (limit != null)   buff.append(" LIMIT ").append(StringUtils.unEnclose(limit.getSQL()));
  if (offset != null)   buff.append(" OFFSET ").append(StringUtils.unEnclose(offset.getSQL()));
}
