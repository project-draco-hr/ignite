{
  this.cfgStore=cfgStore;
  store=cacheStoreWrapper(ctx,cfgStore,cfg);
  singleThreadGate=store == null ? null : new CacheStoreBalancingWrapper<>(store);
  if (cfgStore != null && cfg.getAtomicityMode() == TRANSACTIONAL) {
    try {
      Field sesField=CacheStore.class.getDeclaredField("ses");
      sesField.setAccessible(true);
      sesField.set(cfgStore,new ThreadLocalSession(sesHolder));
      sesEnabled=true;
    }
 catch (    IllegalAccessException|NoSuchFieldException e) {
      throw new IgniteCheckedException(e);
    }
  }
 else   sesEnabled=true;
  locStore=U.hasAnnotation(cfgStore,CacheLocalStore.class);
}
