{
  IgniteConfiguration cfg=super.getConfiguration(gridName);
  cfg.setDiscoverySpi(new TcpDiscoverySpi().setIpFinder(IP_FINDER).setForceServerMode(true));
  CacheConfiguration ccfg=cacheConfiguration();
  cfg.setCacheConfiguration(ccfg);
  DelayCommunicationSpi spi=new DelayCommunicationSpi();
  spi.setSharedMemoryPort(-1);
  cfg.setCommunicationSpi(spi);
  if (testClientNode() && getTestGridName(0).equals(gridName))   cfg.setClientMode(true);
  GridTestUtils.setMemoryMode(cfg,ccfg,memMode,100,1024);
  return cfg;
}
