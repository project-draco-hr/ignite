{
  GridLicenseUseRegistry.onUsage(DATA_GRID,GridOffHeapMapFactory.class);
  long max=cctx.config().getOffHeapMaxMemory();
  long init=max > 0 ? max / 1024 : 8L * 1024L * 1024L;
  int parts=cctx.config().getAffinity().partitions();
  GridOffHeapEvictListener lsnr=!swapEnabled && !offheapEnabled ? null : new GridOffHeapEvictListener(){
    @Override public void onEvict(    int part,    int hash,    byte[] kb,    byte[] vb){
      try {
        writeToSwap(part,null,kb,vb);
      }
 catch (      GridException e) {
        log.error("Failed to unmarshal off-heap entry [part=" + part + ", hash="+ hash+ ']',e);
      }
    }
  }
;
  offheap.create(spaceName,parts,init,max,lsnr);
}
