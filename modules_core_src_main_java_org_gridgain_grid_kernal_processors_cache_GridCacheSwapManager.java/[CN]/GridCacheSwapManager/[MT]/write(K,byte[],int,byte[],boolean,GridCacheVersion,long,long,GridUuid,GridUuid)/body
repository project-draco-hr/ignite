{
  if (!offheapEnabled && !swapEnabled)   return;
  checkIteratorQueue();
  int part=cctx.affinity().partition(key);
  if (offheapEnabled) {
    GridCacheSwapEntry<V> entry=new GridCacheSwapEntry<>(keyHash,val,valIsByteArr,ver,ttl,expireTime,keyClsLdrId,valClsLdrId);
    offheap.put(spaceName,part,key,keyBytes,marshal(entry));
    if (cctx.events().isRecordable(EVT_CACHE_OBJECT_TO_OFFHEAP))     cctx.events().addEvent(part,key,cctx.nodeId(),(GridUuid)null,null,EVT_CACHE_OBJECT_TO_OFFHEAP,null,false,null,true,null);
  }
 else   if (swapEnabled) {
    GridCacheSwapEntry<V> entry=new GridCacheSwapEntry<>(keyHash,val,valIsByteArr,ver,ttl,expireTime,keyClsLdrId,valClsLdrId);
    writeToSwap(part,key,keyBytes,marshal(entry));
  }
  GridCacheQueryManager<K,V> qryMgr=cctx.queries();
  if (qryMgr != null)   qryMgr.onSwap(spaceName,key);
}
