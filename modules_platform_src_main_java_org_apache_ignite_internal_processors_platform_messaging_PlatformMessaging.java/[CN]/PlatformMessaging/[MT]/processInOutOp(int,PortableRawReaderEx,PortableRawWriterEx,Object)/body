{
switch (type) {
case OP_REMOTE_LISTEN:
{
      Object nativeFilter=reader.readObjectDetached();
      long ptr=reader.readLong();
      Object topic=reader.readObjectDetached();
      GridLifecycleAwareMessageFilter filter=platformCtx.createRemoteMessageFilter(nativeFilter,ptr);
      UUID listenId=messaging.remoteListen(topic,filter);
      writer.writeUuid(listenId);
      break;
    }
default :
  throw new IgniteCheckedException("Unsupported operation type: " + type);
}
}
