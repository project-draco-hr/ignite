{
  IgniteConfiguration cfg=loadConfiguration("modules/kafka/src/test/resources/example-ignite.xml");
  cfg.setClientMode(false);
  grid=startGrid("igniteServerNode",cfg);
  kafkaBroker=new TestKafkaBroker();
  for (  String topic : TOPICS)   kafkaBroker.createTopic(topic,PARTITIONS,REPLICATION_FACTOR);
  WorkerConfig workerCfg=new StandaloneConfig(makeWorkerProps());
  OffsetBackingStore offBackingStore=mock(OffsetBackingStore.class);
  offBackingStore.configure(workerCfg);
  worker=new Worker(WORKER_ID,new SystemTime(),workerCfg,offBackingStore);
  worker.start();
  herder=new StandaloneHerder(worker);
  herder.start();
}
