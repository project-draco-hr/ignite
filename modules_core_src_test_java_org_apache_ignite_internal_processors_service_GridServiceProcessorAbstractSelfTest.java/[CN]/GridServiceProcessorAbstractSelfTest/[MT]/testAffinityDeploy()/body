{
  Ignite g=randomGrid();
  final Integer affKey=1;
  g.cache(CACHE_NAME).put(affKey,affKey.toString());
  String name="serviceAffinity";
  IgniteManaged svcs=g.managed().withAsync();
  svcs.deployKeyAffinitySingleton(name,new AffinityService(affKey),CACHE_NAME,affKey);
  IgniteInternalFuture<?> fut=svcs.future();
  info("Deployed service: " + name);
  fut.get();
  info("Finished waiting for service future: " + name);
  checkCount(name,g.managed().deployedServices(),1);
}
