{
  TestSuite suite=new TestSuite();
  if (cfg.gridCount() < testedNodeCnt)   throw new IllegalArgumentException("Failed to initialize test suite [nodeCnt=" + testedNodeCnt + ", cfgGridCnt="+ cfg.gridCount()+ "]");
  for (int i=0; i < testedNodeCnt; i++) {
    boolean stopNodes=cfg.isStopNodes() && i + 1 == testedNodeCnt;
    boolean startCache=i == 0;
    boolean stopCache=i + 1 == testedNodeCnt;
    VariationsTestsConfig cfg0=new VariationsTestsConfig(cfg.configurationFactory(),cfg.description(),stopNodes,startCache,stopCache,cfg.cacheStartMode(),cfg.gridCount(),i,withClients,!skipWaitParMapExchange);
    suite.addTest(new IgniteConfigVariationsTestSuite(cls,cfg0));
  }
  return suite;
}
