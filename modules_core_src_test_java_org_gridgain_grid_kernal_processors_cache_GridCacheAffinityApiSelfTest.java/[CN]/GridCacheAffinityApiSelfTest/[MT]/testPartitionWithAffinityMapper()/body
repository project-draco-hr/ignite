{
  GridCacheAffinityKey<Integer> key=new GridCacheAffinityKey<>(1,2);
  int expPart=affinity().partition(affinityMapper().affinityKey(key));
  for (int i=0; i < gridCount(); i++) {
    assertEquals(expPart,grid(i).cache(null).affinity().partition(key));
    assertEquals(expPart,grid(i).cache(null).entry(key).partition());
  }
  assertTrue(grid(0).cache(null).putx(key,1));
  for (int i=0; i < gridCount(); i++) {
    assertEquals(expPart,grid(i).cache(null).affinity().partition(key));
    assertEquals(expPart,grid(i).cache(null).entry(key).partition());
  }
}
