{
  JobConf taskJobConf=new JobConf(jobInfo.configuration());
  Collection<URL> clsPath=rsrcMgr.classPath();
  if (!clsPath.isEmpty()) {
    URL[] urls=new URL[clsPath.size()];
    clsPath.toArray(urls);
    taskJobConf.setClassLoader(new ClassLoaderWrapper(new URLClassLoader(urls),getClass().getClassLoader()));
  }
  JobContextImpl taskJobContext=new JobContextImpl(taskJobConf,hadoopJobID);
  part=createPartitioner(taskJobContext);
  sortComp=taskJobContext.getSortComparator();
  combineGrpComp=COMBINE_KEY_GROUPING_SUPPORTED ? taskJobContext.getCombinerKeyGroupingComparator() : null;
  reduceGrpComp=taskJobContext.getGroupingComparator();
  GridHadoopTaskContext taskCtx=new GridHadoopV2TaskContext(info,this,in,out,taskJobContext);
  return taskCtx;
}
