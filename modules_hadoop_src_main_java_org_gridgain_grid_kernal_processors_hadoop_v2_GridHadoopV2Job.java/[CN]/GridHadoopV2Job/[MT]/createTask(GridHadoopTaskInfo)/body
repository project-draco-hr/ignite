{
  boolean isAbort=taskInfo.type() == GridHadoopTaskType.ABORT;
switch (taskInfo.type()) {
case SETUP:
    return useNewMapper ? new GridHadoopV2SetupTask(taskInfo,log) : new GridHadoopV1SetupTask(taskInfo,log);
case MAP:
  return useNewMapper ? new GridHadoopV2MapTask(taskInfo,log) : new GridHadoopV1MapTask(taskInfo,log);
case REDUCE:
return useNewReducer ? new GridHadoopV2ReduceTask(taskInfo,true,log) : new GridHadoopV1ReduceTask(taskInfo,true,log);
case COMBINE:
return useNewCombiner ? new GridHadoopV2ReduceTask(taskInfo,false,log) : new GridHadoopV1ReduceTask(taskInfo,false,log);
case COMMIT:
case ABORT:
return useNewReducer ? new GridHadoopV2CleanupTask(taskInfo,isAbort,log) : new GridHadoopV1CleanupTask(taskInfo,isAbort,log);
default :
return null;
}
}
