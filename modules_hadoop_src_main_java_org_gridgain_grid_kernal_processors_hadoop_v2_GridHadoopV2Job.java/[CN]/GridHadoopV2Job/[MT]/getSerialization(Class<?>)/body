{
  A.notNull(cls,"cls");
  SerializationFactory factory=new SerializationFactory(ctx.getJobConf());
  Serialization<?> serialization=factory.getSerialization(cls);
  if (serialization == null)   throw new GridException("Failed to find serialization for: " + cls.getName());
  if (serialization.getClass() == WritableSerialization.class)   return new GridHadoopWritableSerialization((Class<? extends Writable>)cls);
  return new GridHadoopSerializationWrapper(serialization,cls);
}
