{
  String locTaskId=info.type().toString() + info.taskNumber();
  GridHadoopTaskContext res=contexts.get(locTaskId);
  if (res != null)   return res;
  JobConf taskJobConf=new JobConf(jobInfo.configuration());
  Collection<URL> clsPath=rsrcMgr.classPath();
  if (!clsPath.isEmpty()) {
    URL[] urls=new URL[clsPath.size()];
    clsPath.toArray(urls);
    taskJobConf.setClassLoader(new ClassLoaderWrapper(new URLClassLoader(urls),getClass().getClassLoader()));
  }
  JobContextImpl taskJobCtx=new JobContextImpl(taskJobConf,hadoopJobID);
  res=new GridHadoopV2TaskContext(info,this,taskJobCtx);
  contexts.put(locTaskId,res);
  return res;
}
