{
  curr=null;
  while (idx < docs.length) {
    Document doc;
    try {
      doc=searcher.doc(docs[idx++].doc);
    }
 catch (    IOException e) {
      throw new IgniteCheckedException(e);
    }
    String keyStr=doc.get(KEY_FIELD_NAME);
    ClassLoader ldr=null;
    if (ctx != null && ctx.deploy().enabled())     ldr=ctx.cache().internalCache(spaceName).context().deploy().globalLoader();
    K k=marshaller.unmarshal(org.apache.commons.codec.binary.Base64.decodeBase64(keyStr),ldr);
    byte[] valBytes=doc.getBinaryValue(VAL_FIELD_NAME);
    V v=valBytes != null ? marshaller.<V>unmarshal(valBytes,ldr) : type.valueClass() == String.class ? (V)doc.get(VAL_STR_FIELD_NAME) : null;
    if (!filter(k,v))     continue;
    curr=new IgniteBiTuple<>(k,v);
    break;
  }
}
