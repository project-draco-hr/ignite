{
  GridHadoopV2JobImpl jobImpl=(GridHadoopV2JobImpl)taskCtx.job();
  JobContext jobCtx=jobImpl.hadoopJobContext();
  Reducer reducer;
  OutputFormat outputFormat;
  try {
    reducer=U.newInstance(jobCtx.getReducerClass());
    outputFormat=U.newInstance(jobCtx.getOutputFormatClass());
  }
 catch (  ClassNotFoundException e) {
    throw new GridException(e);
  }
  GridHadoopV2Context hadoopCtx=new GridHadoopV2Context(jobCtx.getConfiguration(),taskCtx,jobImpl.attemptId(info()));
  try {
    RecordWriter writer=outputFormat.getRecordWriter(hadoopCtx);
    hadoopCtx.writer(writer);
    try {
      reducer.run(new WrappedReducer().getReducerContext(hadoopCtx));
    }
  finally {
      writer.close(hadoopCtx);
    }
    OutputCommitter outputCommitter=outputFormat.getOutputCommitter(hadoopCtx);
    outputCommitter.commitTask(hadoopCtx);
    outputCommitter.commitJob(hadoopCtx);
  }
 catch (  IOException e) {
    throw new GridException(e);
  }
catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
    throw new GridInterruptedException(e);
  }
}
