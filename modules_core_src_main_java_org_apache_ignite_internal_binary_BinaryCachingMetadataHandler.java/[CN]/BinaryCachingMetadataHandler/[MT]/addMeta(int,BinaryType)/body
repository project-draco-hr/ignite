{
synchronized (this) {
    BinaryType oldType=metas.put(typeId,type);
    if (oldType != null) {
      BinaryMetadata oldMeta=((BinaryTypeImpl)oldType).metadata();
      BinaryMetadata newMeta=((BinaryTypeImpl)type).metadata();
      BinaryMetadata mergedMeta=PortableUtils.mergeMetadata(oldMeta,newMeta);
      BinaryType mergedType=mergedMeta.wrap(((BinaryTypeImpl)oldType).context());
      metas.put(typeId,mergedType);
    }
  }
}
