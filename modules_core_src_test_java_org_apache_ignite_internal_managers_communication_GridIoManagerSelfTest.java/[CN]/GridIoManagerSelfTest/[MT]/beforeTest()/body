{
  ctx.config().setCommunicationSpi(new TcpCommunicationSpi());
  ctx.config().setMarshaller(new IgniteJdkMarshaller());
  ctx.config().setPeerClassLoadingEnabled(false);
  GridDiscoveryManager mockedDiscoveryMgr=Mockito.mock(GridDiscoveryManager.class);
  when(mockedDiscoveryMgr.localNode()).thenReturn(locNode);
  when(mockedDiscoveryMgr.remoteNodes()).thenReturn(F.<ClusterNode>asList(rmtNode));
  ctx.add(mockedDiscoveryMgr);
}
