{
  Collection<R> res=null;
  while (res == null) {
synchronized (mux) {
      res=queue.poll();
    }
    if (res == null && !isDone()) {
      loadPage();
      long timeout=qry.query().timeout();
      long waitTime=timeout == 0 ? Long.MAX_VALUE : timeout - (U.currentTimeMillis() - startTime);
      if (waitTime <= 0)       break;
synchronized (mux) {
        try {
          if (queue.isEmpty() && !isDone())           mux.wait(waitTime);
        }
 catch (        InterruptedException e) {
          Thread.currentThread().interrupt();
          throw new GridException("Query was interrupted: " + qry,e);
        }
      }
    }
  }
  checkError();
  return res;
}
