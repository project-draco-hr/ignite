{
  parseHeaderIfNeeded();
  LinkedHashMap<Integer,Integer> fields=new LinkedHashMap<>();
  int searchPos=footerStart;
  int searchEnd=searchPos + footerLen;
  int idx=0;
  while (searchPos < searchEnd) {
    int fieldId=in.readIntPositioned(searchPos);
    fields.put(fieldId,idx++);
    searchPos+=4 + offsetSize;
  }
  return new PortableSchema(fields);
}
