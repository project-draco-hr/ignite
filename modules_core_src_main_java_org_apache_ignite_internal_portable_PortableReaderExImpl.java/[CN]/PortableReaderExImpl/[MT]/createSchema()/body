{
  parseHeaderIfNeeded();
  LinkedHashMap<Integer,Integer> fields=new LinkedHashMap<>();
  int searchPos=footerStart;
  int searchEnd=searchPos + footerLen;
  while (searchPos < searchEnd) {
    int fieldId=in.readIntPositioned(searchPos);
    fields.put(fieldId,searchPos + 4 - footerStart);
    searchPos+=8;
  }
  return new PortableSchema(fields);
}
