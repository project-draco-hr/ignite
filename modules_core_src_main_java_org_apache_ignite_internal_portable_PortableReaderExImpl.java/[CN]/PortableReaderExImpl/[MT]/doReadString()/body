{
  if (in.readBoolean()) {
    if (!in.hasArray())     return new String(doReadByteArray(),UTF_8);
    int strLen=in.readInt();
    int strOff=in.position();
    String res=new String(in.array(),strOff,strLen,UTF_8);
    in.position(in.position() + strLen);
    return res;
  }
 else   return String.valueOf(doReadCharArray());
}
