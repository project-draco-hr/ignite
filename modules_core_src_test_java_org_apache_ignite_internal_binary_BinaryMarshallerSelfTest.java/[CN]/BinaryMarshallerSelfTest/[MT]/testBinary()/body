{
  BinaryMarshaller marsh=binaryMarshaller(Arrays.asList(new BinaryTypeConfiguration(SimpleObject.class.getName()),new BinaryTypeConfiguration(TestBinary.class.getName())));
  TestBinary obj=binaryObject();
  BinaryObject po=marshal(obj,marsh);
  assertEquals(obj.hashCode(),po.hashCode());
  assertEquals(obj,po.deserialize());
  assertEquals(obj.b,(byte)po.field("_b"));
  assertEquals(obj.s,(short)po.field("_s"));
  assertEquals(obj.i,(int)po.field("_i"));
  assertEquals(obj.l,(long)po.field("_l"));
  assertEquals(obj.f,(float)po.field("_f"),0);
  assertEquals(obj.d,(double)po.field("_d"),0);
  assertEquals(obj.c,(char)po.field("_c"));
  assertEquals(obj.bool,(boolean)po.field("_bool"));
  assertEquals(obj.str,po.field("_str"));
  assertEquals(obj.uuid,po.field("_uuid"));
  assertEquals(obj.date,po.field("_date"));
  assertEquals(obj.ts,po.field("_ts"));
  assertArrayEquals(obj.bArr,(byte[])po.field("_bArr"));
  assertArrayEquals(obj.sArr,(short[])po.field("_sArr"));
  assertArrayEquals(obj.iArr,(int[])po.field("_iArr"));
  assertArrayEquals(obj.lArr,(long[])po.field("_lArr"));
  assertArrayEquals(obj.fArr,(float[])po.field("_fArr"),0);
  assertArrayEquals(obj.dArr,(double[])po.field("_dArr"),0);
  assertArrayEquals(obj.cArr,(char[])po.field("_cArr"));
  assertBooleanArrayEquals(obj.boolArr,(boolean[])po.field("_boolArr"));
  assertArrayEquals(obj.strArr,(String[])po.field("_strArr"));
  assertArrayEquals(obj.uuidArr,(UUID[])po.field("_uuidArr"));
  assertArrayEquals(obj.dateArr,(Date[])po.field("_dateArr"));
  assertArrayEquals(obj.objArr,(Object[])po.field("_objArr"));
  assertEquals(obj.col,po.field("_col"));
  assertEquals(obj.map,po.field("_map"));
  assertEquals(new Integer(obj.enumVal.ordinal()),new Integer(((BinaryObject)po.field("_enumVal")).enumOrdinal()));
  assertArrayEquals(ordinals(obj.enumArr),ordinals((BinaryObject[])po.field("_enumArr")));
  assertNull(po.field("unknown"));
  BinaryObject simplePo=po.field("_simple");
  assertEquals(obj.simple,simplePo.deserialize());
  assertEquals(obj.simple.b,(byte)simplePo.field("b"));
  assertEquals(obj.simple.s,(short)simplePo.field("s"));
  assertEquals(obj.simple.i,(int)simplePo.field("i"));
  assertEquals(obj.simple.l,(long)simplePo.field("l"));
  assertEquals(obj.simple.f,(float)simplePo.field("f"),0);
  assertEquals(obj.simple.d,(double)simplePo.field("d"),0);
  assertEquals(obj.simple.c,(char)simplePo.field("c"));
  assertEquals(obj.simple.bool,(boolean)simplePo.field("bool"));
  assertEquals(obj.simple.str,simplePo.field("str"));
  assertEquals(obj.simple.uuid,simplePo.field("uuid"));
  assertEquals(obj.simple.date,simplePo.field("date"));
  assertEquals(Date.class,obj.simple.date.getClass());
  assertEquals(obj.simple.ts,simplePo.field("ts"));
  assertArrayEquals(obj.simple.bArr,(byte[])simplePo.field("bArr"));
  assertArrayEquals(obj.simple.sArr,(short[])simplePo.field("sArr"));
  assertArrayEquals(obj.simple.iArr,(int[])simplePo.field("iArr"));
  assertArrayEquals(obj.simple.lArr,(long[])simplePo.field("lArr"));
  assertArrayEquals(obj.simple.fArr,(float[])simplePo.field("fArr"),0);
  assertArrayEquals(obj.simple.dArr,(double[])simplePo.field("dArr"),0);
  assertArrayEquals(obj.simple.cArr,(char[])simplePo.field("cArr"));
  assertBooleanArrayEquals(obj.simple.boolArr,(boolean[])simplePo.field("boolArr"));
  assertArrayEquals(obj.simple.strArr,(String[])simplePo.field("strArr"));
  assertArrayEquals(obj.simple.uuidArr,(UUID[])simplePo.field("uuidArr"));
  assertArrayEquals(obj.simple.dateArr,(Date[])simplePo.field("dateArr"));
  assertArrayEquals(obj.simple.objArr,(Object[])simplePo.field("objArr"));
  assertEquals(obj.simple.col,simplePo.field("col"));
  assertEquals(obj.simple.map,simplePo.field("map"));
  assertEquals(new Integer(obj.simple.enumVal.ordinal()),new Integer(((BinaryObject)simplePo.field("enumVal")).enumOrdinal()));
  assertArrayEquals(ordinals(obj.simple.enumArr),ordinals((BinaryObject[])simplePo.field("enumArr")));
  assertNull(simplePo.field("simple"));
  assertNull(simplePo.field("binary"));
  assertNull(simplePo.field("unknown"));
  BinaryObject binaryPo=po.field("_binary");
  assertEquals(obj.binary,binaryPo.deserialize());
  assertEquals(obj.binary.b,(byte)binaryPo.field("_b"));
  assertEquals(obj.binary.s,(short)binaryPo.field("_s"));
  assertEquals(obj.binary.i,(int)binaryPo.field("_i"));
  assertEquals(obj.binary.l,(long)binaryPo.field("_l"));
  assertEquals(obj.binary.f,(float)binaryPo.field("_f"),0);
  assertEquals(obj.binary.d,(double)binaryPo.field("_d"),0);
  assertEquals(obj.binary.c,(char)binaryPo.field("_c"));
  assertEquals(obj.binary.bool,(boolean)binaryPo.field("_bool"));
  assertEquals(obj.binary.str,binaryPo.field("_str"));
  assertEquals(obj.binary.uuid,binaryPo.field("_uuid"));
  assertEquals(obj.binary.date,binaryPo.field("_date"));
  assertEquals(obj.binary.ts,binaryPo.field("_ts"));
  assertArrayEquals(obj.binary.bArr,(byte[])binaryPo.field("_bArr"));
  assertArrayEquals(obj.binary.sArr,(short[])binaryPo.field("_sArr"));
  assertArrayEquals(obj.binary.iArr,(int[])binaryPo.field("_iArr"));
  assertArrayEquals(obj.binary.lArr,(long[])binaryPo.field("_lArr"));
  assertArrayEquals(obj.binary.fArr,(float[])binaryPo.field("_fArr"),0);
  assertArrayEquals(obj.binary.dArr,(double[])binaryPo.field("_dArr"),0);
  assertArrayEquals(obj.binary.cArr,(char[])binaryPo.field("_cArr"));
  assertBooleanArrayEquals(obj.binary.boolArr,(boolean[])binaryPo.field("_boolArr"));
  assertArrayEquals(obj.binary.strArr,(String[])binaryPo.field("_strArr"));
  assertArrayEquals(obj.binary.uuidArr,(UUID[])binaryPo.field("_uuidArr"));
  assertArrayEquals(obj.binary.dateArr,(Date[])binaryPo.field("_dateArr"));
  assertArrayEquals(obj.binary.objArr,(Object[])binaryPo.field("_objArr"));
  assertEquals(obj.binary.col,binaryPo.field("_col"));
  assertEquals(obj.binary.map,binaryPo.field("_map"));
  assertEquals(new Integer(obj.binary.enumVal.ordinal()),new Integer(((BinaryObject)binaryPo.field("_enumVal")).enumOrdinal()));
  assertArrayEquals(ordinals(obj.binary.enumArr),ordinals((BinaryObject[])binaryPo.field("_enumArr")));
  assertNull(binaryPo.field("_simple"));
  assertNull(binaryPo.field("_binary"));
  assertNull(binaryPo.field("unknown"));
}
