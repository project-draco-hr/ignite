{
  GridDiscoveryTopologySnapshot snapshot=tx != null ? tx.topologySnapshot() : cctx.mvcc().lastExplicitLockTopologySnapshot(Thread.currentThread().getId());
  if (snapshot != null) {
    topSnapshot.compareAndSet(null,snapshot);
    map(keys);
    markInitialized();
    return;
  }
  mapOnTopology();
}
