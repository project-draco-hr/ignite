{
  GridHadoopTestTaskContext mapCtx=new GridHadoopTestTaskContext(gridJob);
  GridHadoopTaskInfo taskInfo=new GridHadoopTaskInfo(null,GridHadoopTaskType.MAP,jobId,0,0,fileBlock);
  GridHadoopTask task=gridJob.createTask(taskInfo);
  task.run(mapCtx);
  GridHadoopTestTaskContext combineCtx=new GridHadoopTestTaskContext(gridJob);
  combineCtx.makeTreeOfWritables(mapCtx.mockOutput());
  taskInfo=new GridHadoopTaskInfo(null,GridHadoopTaskType.COMBINE,jobId,0,0,null);
  task=gridJob.createTask(taskInfo);
  task.run(combineCtx);
  return combineCtx;
}
