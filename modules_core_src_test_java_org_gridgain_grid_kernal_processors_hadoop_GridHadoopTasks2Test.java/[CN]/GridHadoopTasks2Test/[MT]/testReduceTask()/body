{
  Path outputDir=Files.createTempDirectory(GridGainWordCount2.class.getSimpleName() + "-output");
  try {
    URI testOutputDirURI=URI.create(outputDir.toString());
    Job hadoopJob=GridGainWordCount2.getJob("/",testOutputDirURI.toString());
    hadoopJob.setJobID(new JobID());
    GridHadoopJobId jobId=new GridHadoopJobId(new UUID(0,0),0);
    GridHadoopDefaultJobInfo jobInfo=new GridHadoopDefaultJobInfo(hadoopJob.getConfiguration());
    GridHadoopV2JobImpl gridJob=new GridHadoopV2JobImpl(jobId,jobInfo);
    runTaskWithInput(gridJob,jobId,GridHadoopTaskType.REDUCE,0,"word1","5","word2","10");
    runTaskWithInput(gridJob,jobId,GridHadoopTaskType.REDUCE,1,"word3","7","word4","15");
    assertEquals("word1\t5\n" + "word2\t10\n",readFile(outputDir + "/part-r-00000"));
    assertEquals("word3\t7\n" + "word4\t15\n",readFile(outputDir + "/part-r-00001"));
  }
  finally {
    FileUtils.deleteDirectory(outputDir.toFile());
  }
}
