{
  Job hadoopJob=GridGainWordCount2.getJob("/","/");
  hadoopJob.setJobID(new JobID());
  GridHadoopJobId jobId=new GridHadoopJobId(new UUID(0,0),0);
  GridHadoopDefaultJobInfo jobInfo=new GridHadoopDefaultJobInfo(hadoopJob.getConfiguration());
  GridHadoopV2JobImpl gridJob=new GridHadoopV2JobImpl(jobId,jobInfo);
  GridHadoopTestTaskContext ctx=runTaskWithInput(gridJob,jobId,GridHadoopTaskType.COMBINE,0,"word1","5","word2","10");
  assertEquals("word1,5; word2,10",Joiner.on("; ").join(ctx.mockOutput()));
  ctx=runTaskWithInput(gridJob,jobId,GridHadoopTaskType.COMBINE,1,"word3","7","word4","15");
  assertEquals("word3,7; word4,15",Joiner.on("; ").join(ctx.mockOutput()));
}
