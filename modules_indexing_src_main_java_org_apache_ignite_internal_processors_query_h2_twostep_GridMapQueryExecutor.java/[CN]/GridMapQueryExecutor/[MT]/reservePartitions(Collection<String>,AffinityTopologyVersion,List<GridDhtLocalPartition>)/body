{
  for (  String cacheName : cacheNames) {
    GridCacheContext<?,?> cctx=cacheContext(cacheName,topVer);
    Set<Integer> partIds=cctx.affinity().primaryPartitions(ctx.localNodeId(),topVer);
    for (    int partId : partIds) {
      GridDhtLocalPartition part=cctx.topology().localPartition(partId,topVer,false);
      if (part != null) {
        part.owningFuture().get();
        if (part.reserve()) {
          reserved.add(part);
          continue;
        }
      }
      return false;
    }
  }
  return true;
}
