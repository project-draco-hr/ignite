{
  this.ctx=ctx;
  this.h2=h2;
  log=ctx.log(GridMapQueryExecutor.class);
  ctx.event().addLocalEventListener(new GridLocalEventListener(){
    @Override public void onEvent(    final Event evt){
      UUID nodeId=((DiscoveryEvent)evt).eventNode().id();
      ConcurrentMap<Long,QueryResults> nodeRess=qryRess.remove(nodeId);
      if (nodeRess == null)       return;
      for (      QueryResults ress : nodeRess.values())       ress.cancel();
    }
  }
,EventType.EVT_NODE_FAILED,EventType.EVT_NODE_LEFT);
  ctx.io().addMessageListener(GridTopic.TOPIC_QUERY,this);
}
