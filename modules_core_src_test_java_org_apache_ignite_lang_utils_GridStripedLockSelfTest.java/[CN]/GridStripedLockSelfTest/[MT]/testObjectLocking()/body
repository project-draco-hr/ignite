{
  GridTestUtils.runMultiThreaded(new Runnable(){
    @Override public void run(){
      try {
        barrier.await();
      }
 catch (      Exception e) {
        fail("Failed to await other threads: " + e.getMessage());
      }
      for (      Object o : testObjects((int)ITERATION_COUNT)) {
        lock.lock(o);
        try {
          int holdCnt=0;
          for (          Object lockObject : testObjects(STRIPE_COUNT))           if (((ReentrantLock)lock.getLock(lockObject)).isHeldByCurrentThread())           holdCnt++;
          if (o == null || o.hashCode() % STRIPE_COUNT == 0)           assertEquals(2,holdCnt);
 else           assertEquals("Test object " + o.hashCode(),1,holdCnt);
        }
  finally {
          lock.unlock(o);
        }
      }
    }
  }
,THREAD_COUNT,"GridStripedLock-test");
}
