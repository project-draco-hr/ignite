{
  try {
    if (val == null)     return GridH2RowFactory.create(wrap(key,keyType));
    return schema.offheap == null ? new GridH2KeyValueRowOnheap(this,key,keyType,val,valType,expirationTime) : new GridH2KeyValueRowOffheap(this,key,keyType,val,valType,expirationTime);
  }
 catch (  ClassCastException e) {
    throw new IgniteCheckedException("Failed to convert key to SQL type. " + "Please make sure that you always store each value type with the same key type " + "or configure key type as common super class for all actual keys for this value type.",e);
  }
}
