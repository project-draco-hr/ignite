{
  String schema=schema(ccfg.getName());
  if (schemas.putIfAbsent(schema,new Schema(ccfg.getName(),ccfg.getOffHeapMaxMemory() >= 0 || ccfg.getMemoryMode() == CacheMemoryMode.OFFHEAP_TIERED ? new GridUnsafeMemory(0) : null,ccfg)) != null)   throw new IgniteCheckedException("Cache already registered: " + ccfg.getName());
  createSchema(schema);
  createSqlFunctions(schema,ccfg.getSqlFunctionClasses());
}
