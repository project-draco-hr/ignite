{
  String schema=schemaNameFromCacheConf(ccfg);
  if (schemas.putIfAbsent(schema,new Schema(ccfg.getName(),schema,ccfg.getOffHeapMaxMemory() >= 0 || ccfg.getMemoryMode() == CacheMemoryMode.OFFHEAP_TIERED ? new GridUnsafeMemory(0) : null,ccfg)) != null)   throw new IgniteCheckedException("Schema for cache already registered: " + U.maskName(ccfg.getName()));
  space2schema.put(emptyIfNull(ccfg.getName()),schema);
  createSchema(schema);
  createSqlFunctions(schema,ccfg.getSqlFunctionClasses());
}
