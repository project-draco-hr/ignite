{
  if (log.isDebugEnabled())   log.debug("Removing key from cache query index [locId=" + nodeId + ", key="+ key+ ", val="+ val+ ']');
  CacheObjectContext coctx=objectContext(spaceName);
  Class<?> keyCls=getClass(coctx,key);
  Class<?> valCls=val == null ? null : getClass(coctx,val);
  for (  TableDescriptor tbl : tables(schema(spaceName))) {
    if (tbl.type().keyClass().isAssignableFrom(keyCls) && (val == null || tbl.type().valueClass().isAssignableFrom(valCls))) {
      if (tbl.tbl.update(key,val,0,true)) {
        if (tbl.luceneIdx != null)         tbl.luceneIdx.remove(key);
        return;
      }
    }
  }
}
