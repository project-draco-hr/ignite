{
  if (!validateTypeDescriptor(spaceName,type))   return false;
  String schemaName=schema(spaceName);
  Schema schema=schemas.get(schemaName);
  TableDescriptor tbl=new TableDescriptor(schema,type);
  try {
    Connection conn=connectionForThread(schemaName);
    createTable(schema,tbl,conn);
    schema.add(tbl);
  }
 catch (  SQLException e) {
    onSqlException();
    throw new IgniteCheckedException("Failed to register query type: " + type,e);
  }
  return true;
}
