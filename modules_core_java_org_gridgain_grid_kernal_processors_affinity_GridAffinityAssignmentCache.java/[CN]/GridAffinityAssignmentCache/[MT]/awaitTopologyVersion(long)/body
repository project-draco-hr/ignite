{
  GridAffinityAssignment aff=head.get();
  if (aff.topologyVersion() >= topVer)   return;
  try {
    System.out.println("WIll wait for topology version: " + topVer);
    readyFuture(topVer).get();
  }
 catch (  GridException e) {
    throw new GridRuntimeException("Failed to wait for affinity ready future for topology version: " + topVer,e);
  }
}
