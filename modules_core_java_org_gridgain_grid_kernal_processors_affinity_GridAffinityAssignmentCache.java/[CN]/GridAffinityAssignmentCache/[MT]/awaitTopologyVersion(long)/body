{
  GridAffinityAssignment aff=head.get();
  if (aff.topologyVersion() >= topVer)   return;
  try {
    U.debug(log,"Will wait for topology version [locNodeId=" + ctx.localNodeId() + ", topVer="+ topVer+ ']');
    readyFuture(topVer).get();
    U.debug(log,"Finished waiting for topology version [locNodeId=" + ctx.localNodeId() + ", topVer="+ topVer+ ']');
  }
 catch (  GridException e) {
    throw new GridRuntimeException("Failed to wait for affinity ready future for topology version: " + topVer,e);
  }
}
