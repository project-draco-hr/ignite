{
  if (!F.eq(GridGgfs.GGFS_SCHEME,uri.getScheme()))   throw new IllegalArgumentException("Normalization can only be applied to GGFS URI: " + uri);
  NewGridGgfsHadoopEndpoint endpoint=new NewGridGgfsHadoopEndpoint(uri.getAuthority());
  try {
    return new URI(uri.getScheme(),endpoint.ggfsName + ":" + endpoint.gridName,endpoint.host,endpoint.port,uri.getPath(),uri.getQuery(),uri.getFragment());
  }
 catch (  URISyntaxException e) {
    throw new IllegalArgumentException("Failed to normalize URI: " + uri,e);
  }
}
