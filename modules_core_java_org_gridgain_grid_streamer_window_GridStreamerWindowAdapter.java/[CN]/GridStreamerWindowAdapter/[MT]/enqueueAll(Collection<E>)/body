{
  lock.readLock();
  try {
    boolean ignoreFilter=filter == null || F.isAlwaysTrue(filter);
    boolean res=true;
    for (    E evt : evts) {
      if (ignoreFilter || filter.apply(evt)) {
        updateIndexes(evt,false);
        boolean added=enqueue0(evt);
        if (!added)         updateIndexes(evt,true);
        res&=added;
      }
    }
    return res;
  }
  finally {
    lock.readUnlock();
  }
}
