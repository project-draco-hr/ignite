{
  Transaction tx=tx(id);
  try {
    tx.close();
    return tx.state().ordinal();
  }
  finally {
    unregisterTx(id);
  }
}
