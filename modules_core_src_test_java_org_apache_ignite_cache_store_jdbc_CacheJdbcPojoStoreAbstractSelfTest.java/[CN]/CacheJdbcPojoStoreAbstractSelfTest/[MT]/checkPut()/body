{
  IgniteCache<PersonKey,Person> c1=grid().cache(null);
  Connection conn=getConnection();
  try {
    PreparedStatement stmt=conn.prepareStatement("SELECT ID, ORG_ID, BIRTHDAY, NAME FROM PERSON WHERE ID = ?");
    stmt.setInt(1,-1);
    ResultSet rs=stmt.executeQuery();
    assertFalse("Unexpected non empty result set",rs.next());
    U.closeQuiet(rs);
    PersonKey key=new PersonKey(-1);
    Date testDate=Date.valueOf("2001-05-05");
    c1.put(key,new Person(-1,-2,testDate,"Person-to-test-put-insert",999));
    rs=stmt.executeQuery();
    assertTrue("Unexpected empty result set",rs.next());
    assertEquals(-1,rs.getInt(1));
    assertEquals(-2,rs.getInt(2));
    assertEquals(testDate,rs.getDate(3));
    assertEquals("Person-to-test-put-insert",rs.getString(4));
    assertFalse("Unexpected more data in result set",rs.next());
    U.closeQuiet(rs);
    testDate=Date.valueOf("2016-04-04");
    c1.put(key,new Person(-1,-3,testDate,"Person-to-test-put-update",999));
    rs=stmt.executeQuery();
    assertTrue("Unexpected empty result set",rs.next());
    assertEquals(-1,rs.getInt(1));
    assertEquals(-3,rs.getInt(2));
    assertEquals(testDate,rs.getDate(3));
    assertEquals("Person-to-test-put-update",rs.getString(4));
    assertFalse("Unexpected more data in result set",rs.next());
    U.closeQuiet(rs);
  }
  finally {
    U.closeQuiet(conn);
  }
}
