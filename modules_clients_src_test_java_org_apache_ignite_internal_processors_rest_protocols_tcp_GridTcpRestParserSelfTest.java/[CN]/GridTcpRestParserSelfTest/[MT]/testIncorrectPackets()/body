{
  final GridNioSession ses=new GridMockNioSession();
  final GridTcpRestParser parser=new GridTcpRestParser();
  final byte[] opaque=new byte[]{0x01,0x02,0x03,(byte)0xFF};
  final String key="key";
  final String val="value";
  GridTestUtils.assertThrows(log(),new Callable<Object>(){
    @Nullable @Override public Object call() throws Exception {
      parser.decode(ses,rawPacket((byte)0x01,(byte)0x01,opaque,key.getBytes(),val.getBytes(),EXTRAS));
      return null;
    }
  }
,IOException.class,null);
  GridTestUtils.assertThrows(log(),new Callable<Object>(){
    @Nullable @Override public Object call() throws Exception {
      parser.decode(ses,rawPacket(MEMCACHE_REQ_FLAG,(byte)0x01,opaque,key.getBytes(),val.getBytes(),null));
      return null;
    }
  }
,IOException.class,null);
  GridTestUtils.assertThrows(log(),new Callable<Object>(){
    @Nullable @Override public Object call() throws Exception {
      ByteBuffer fake=ByteBuffer.allocate(21);
      fake.put(GRIDGAIN_REQ_FLAG);
      fake.put(U.intToBytes(-5));
      fake.put(U.longToBytes(0));
      fake.put(U.longToBytes(0));
      fake.flip();
      parser.decode(ses,fake);
      return null;
    }
  }
,IOException.class,null);
}
