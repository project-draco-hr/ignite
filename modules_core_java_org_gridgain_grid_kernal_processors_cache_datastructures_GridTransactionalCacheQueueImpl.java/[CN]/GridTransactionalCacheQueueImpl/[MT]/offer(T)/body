{
  try {
    try (GridCacheTx tx=cache.txStart(PESSIMISTIC,REPEATABLE_READ)){
      Long idx=(Long)cache.transformCompute(queueKey,new AddClosure(uuid,1));
      if (idx == null)       return false;
      checkRemoved(idx);
      boolean putx=cache.putx(new ItemKey(uuid,idx,collocated()),item,null);
      assert putx;
      tx.commit();
      return true;
    }
   }
 catch (  GridException e) {
    throw new GridRuntimeException(e);
  }
}
