{
  return GridTestUtils.runMultiThreadedAsync(new CA(){
    @Override public void apply(){
      try {
        for (int i=0; i < TOP_CHANGE_CNT; i++) {
          if (failed.get())           return;
          String name=UUID.randomUUID().toString();
          try {
            log.info("Start node: " + name);
            Ignite g=startGrid(name);
            cb.apply(g);
          }
  finally {
            if (i != TOP_CHANGE_CNT - 1)             stopGrid(name);
          }
        }
      }
 catch (      Exception e) {
        if (failed.compareAndSet(false,true))         throw F.wrap(e);
      }
    }
  }
,topChangeThreads,"topology-change-thread");
}
