{
  if (!F.eq(GridGgfs.GGFS_SCHEME,uri.getScheme()))   throw new IllegalArgumentException("Normalization can only be applied to GGFS URI: " + uri);
  try {
    GridGgfsHadoopEndpoint endpoint=new GridGgfsHadoopEndpoint(uri.getAuthority());
    return new URI(uri.getScheme(),endpoint.ggfsName + ":" + endpoint.gridName,endpoint.host,endpoint.port,uri.getPath(),uri.getQuery(),uri.getFragment());
  }
 catch (  GridException|URISyntaxException e) {
    throw new IllegalArgumentException("Failed to normalize URI: " + uri,e);
  }
}
