{
  fillCaches();
  String cache="partitioned";
  GridCacheQueriesEx<Integer,FactPurchase> qx=(GridCacheQueriesEx<Integer,FactPurchase>)ignite.<Integer,FactPurchase>cache(cache).queries();
  GridCacheTwoStepQuery q=new GridCacheTwoStepQuery("select cast(sum(x) as long) from _cnts_ where ? = ?",1,1);
  q.addMapQuery("_cnts_","select count(*) x from \"partitioned\".FactPurchase where ? = ?",2,2);
  Object cnt=qx.execute(cache,q).get().iterator().next().get(0);
  assertEquals(10L,cnt);
}
