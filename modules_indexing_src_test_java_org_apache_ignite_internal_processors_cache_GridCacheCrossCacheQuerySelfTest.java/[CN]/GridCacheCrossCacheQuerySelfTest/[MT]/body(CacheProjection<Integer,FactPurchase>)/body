{
  CacheQuery<Map.Entry<Integer,FactPurchase>> qry=(prj == null ? ignite.<Integer,FactPurchase>cache("partitioned") : prj).queries().createSqlQuery(FactPurchase.class,"from \"replicated\".DimStore, \"partitioned\".FactPurchase where DimStore.id = FactPurchase.storeId");
  List<Map.Entry<Integer,FactPurchase>> res=new ArrayList<>(qry.execute().get());
  Collections.sort(res,new Comparator<Map.Entry<Integer,FactPurchase>>(){
    @Override public int compare(    Map.Entry<Integer,FactPurchase> o1,    Map.Entry<Integer,FactPurchase> o2){
      return o1.getKey() > o2.getKey() ? 1 : o1.getKey() < o2.getKey() ? -1 : 0;
    }
  }
);
  return res;
}
