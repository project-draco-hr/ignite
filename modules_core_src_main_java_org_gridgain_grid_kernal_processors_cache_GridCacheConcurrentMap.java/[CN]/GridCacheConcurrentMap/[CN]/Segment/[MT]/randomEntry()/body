{
  SegmentHeader<K,V> hdr=headerForRead();
  try {
    GridCacheMapEntry<K,V>[] tbl=hdr.table();
    Collection<GridCacheMapEntry<K,V>> entries=new ArrayList<>(3);
    int pubCnt=0;
    int start=RAND.nextInt(tbl.length);
    for (int i=start; i < start + tbl.length; i++) {
      GridCacheMapEntry<K,V> first=tbl[i % tbl.length];
      if (first == null)       continue;
      entries.add(first);
      for (GridCacheMapEntry<K,V> e=first; e != null; e=e.next(hdr.id()))       if (!e.isInternal())       pubCnt++;
      if (entries.size() == 3)       break;
    }
    if (entries.isEmpty())     return null;
    if (pubCnt == 0)     return null;
    int idx=RAND.nextInt(pubCnt);
    int i=0;
    GridCacheMapEntry<K,V> retVal=null;
    for (    GridCacheMapEntry<K,V> e : entries) {
      for (; e != null; e=e.next(hdr.id())) {
        if (!(e.key instanceof GridCacheInternal)) {
          retVal=e;
          if (idx == i++)           break;
        }
      }
    }
    return retVal;
  }
  finally {
    hdr.onReadEnd();
  }
}
