{
  A.notNull(r,"job");
  if (r instanceof ComputeJobMasterLeaveAware)   return new C5(r,cacheName,affKey);
 else {
    return new ComputeJobAdapter(){
      /** 
 */
      @GridCacheName private final String cn=cacheName;
      /** 
 */
      @GridCacheAffinityKeyMapped private final Object ak=affKey;
      @Nullable @Override public Object execute(){
        r.run();
        return null;
      }
    }
;
  }
}
