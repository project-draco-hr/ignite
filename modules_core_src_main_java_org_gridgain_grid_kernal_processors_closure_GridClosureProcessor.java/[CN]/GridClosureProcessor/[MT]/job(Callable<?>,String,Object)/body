{
  A.notNull(c,"job");
  if (c instanceof ComputeJobMasterLeaveAware)   return new C3(c,cacheName,affKey);
 else {
    return new ComputeJobAdapter(){
      /** 
 */
      @GridCacheName private final String cn=cacheName;
      /** 
 */
      @GridCacheAffinityKeyMapped private final Object ak=affKey;
      @Override public Object execute(){
        try {
          return c.call();
        }
 catch (        Exception e) {
          throw new IgniteException(e);
        }
      }
    }
;
  }
}
