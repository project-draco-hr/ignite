{
  Collection<UUID> topIds=new HashSet<>(top.size(),1.0f);
  for (  GridNode topNode : top)   topIds.add(topNode.id());
  Map<UUID,Collection<GridHadoopInputSplit>> mappers=mappers(top,topIds,splits);
  Map<UUID,int[]> reducers=reducers(top,mappers,job.reducers());
  return new GridHadoopDefaultMapReducePlan(mappers,reducers);
}
