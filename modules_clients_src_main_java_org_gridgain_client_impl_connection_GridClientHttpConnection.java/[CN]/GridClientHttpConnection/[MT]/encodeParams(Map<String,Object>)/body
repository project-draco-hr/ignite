{
  StringBuilder data=new StringBuilder();
  for (  Map.Entry<String,Object> e : params.entrySet()) {
    if (e.getValue() instanceof String) {
      if (data.length() > 0)       data.append('&');
      data.append(URLEncoder.encode(e.getKey(),"UTF-8")).append('=').append(URLEncoder.encode((String)e.getValue(),"UTF-8"));
    }
 else     if (e.getValue() instanceof GridSecurityCredentials) {
      GridSecurityCredentials cred=(GridSecurityCredentials)e.getValue();
      if (data.length() > 0)       data.append('&');
      Object login=cred.getLogin();
      if (login != null) {
        if (!(login instanceof String))         throw new IllegalArgumentException("Http connection supports only string login" + ", while received: " + login);
        data.append("gridgain.login=").append(URLEncoder.encode((String)login,"UTF-8"));
      }
      if (data.length() > 0)       data.append('&');
      Object pwd=cred.getPassword();
      if (pwd != null) {
        if (!(pwd instanceof String))         throw new IllegalArgumentException("Http connection supports only string password" + ", while received: " + login);
        data.append("gridgain.password=").append(URLEncoder.encode((String)pwd,"UTF-8"));
      }
    }
 else     throw new IllegalArgumentException("Http connection supports only string arguments in requests" + ", while received [key=" + e.getKey() + ", value="+ e.getValue()+ "]");
  }
  return data;
}
