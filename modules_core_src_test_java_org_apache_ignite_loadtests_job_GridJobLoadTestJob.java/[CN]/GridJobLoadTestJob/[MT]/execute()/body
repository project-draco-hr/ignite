{
  try {
    if (log.isInfoEnabled())     log.info("Job started " + getJobInfo());
    doJob();
    if (new Random().nextDouble() <= failProbability) {
      if (log.isInfoEnabled())       log.info("Failing job " + getJobInfo());
      throw new RuntimeException("Task failure simulation");
    }
    sleep(new Random().nextInt(completionDelay));
    if (log.isInfoEnabled())     log.info("Job is completing normally " + getJobInfo());
  }
 catch (  InterruptedException ignored) {
    if (log.isDebugEnabled())     log.debug("Job was cancelled " + getJobInfo());
  }
  return 1;
}
