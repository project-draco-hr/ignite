{
  IgniteConfiguration cfg=super.getConfiguration(gridName);
  cfg.setMarshaller(new IgniteOptimizedMarshaller(false));
  if (hasCache)   cfg.setCacheConfiguration(cache(null,null),cache(CACHE,null),cache(EMPTY_CACHE,null));
 else   cfg.setCacheConfiguration();
  cfg.setDiscoverySpi(discovery());
  return cfg;
}
