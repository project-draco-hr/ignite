{
  try {
    Ignite g1=startGridsMultiThreaded(3);
    daemon=true;
    Ignite g2=startGrid(4);
    for (long i=0; i < Integer.MAX_VALUE; i=(i << 1) + 1) {
      GridNode n;
      assertNotNull(n=g1.cluster().mapKeyToNode(null,i));
      if (cacheMode() == PARTITIONED)       assertEquals(n,g2.cluster().mapKeyToNode(null,i));
 else       assertNotNull(g2.cluster().mapKeyToNode(null,i));
    }
  }
  finally {
    stopAllGrids();
  }
}
