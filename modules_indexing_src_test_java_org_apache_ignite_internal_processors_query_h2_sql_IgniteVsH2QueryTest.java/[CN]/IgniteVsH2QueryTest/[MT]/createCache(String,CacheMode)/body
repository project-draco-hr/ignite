{
  CacheConfiguration<?,?> cc=defaultCacheConfiguration();
  cc.setName(name);
  cc.setCacheMode(mode);
  cc.setWriteSynchronizationMode(CacheWriteSynchronizationMode.FULL_SYNC);
  cc.setEvictNearSynchronized(false);
  cc.setAtomicityMode(CacheAtomicityMode.TRANSACTIONAL);
  cc.setDistributionMode(PARTITIONED_ONLY);
  if (mode == CacheMode.PARTITIONED)   cc.setIndexedTypes(Integer.class,Organization.class,CacheAffinityKey.class,Person.class,CacheAffinityKey.class,Purchase.class);
 else   if (mode == CacheMode.REPLICATED)   cc.setIndexedTypes(Integer.class,Product.class);
 else   throw new IllegalStateException("mode: " + mode);
  return cc;
}
