{
  log.info("Test tx put/remove [concurrency=" + concurrency + ", isolation="+ isolation+ ']');
  IgniteCache<Integer,Integer> cache=jcache(0);
  List<Integer> keys=testKeys(cache,3);
  Integer key1=keys.get(0);
  Integer key2=keys.get(1);
  Integer key3=keys.get(2);
  try (IgniteTx tx=startTx(concurrency,isolation)){
    log.info("Do tx put1.");
    cache.put(key1,key1);
    log.info("Do tx put2.");
    cache.put(key2,key2);
    log.info("Do tx remove.");
    cache.remove(key3);
    expData.add(new ExpectedData("writeAll",new HashMap<>(),null));
    expData.add(new ExpectedData("delete",F.<Object,Object>asMap(0,"writeAll"),null));
    expData.add(new ExpectedData("txEnd",F.<Object,Object>asMap(0,"writeAll",1,"delete"),null));
    log.info("Do tx commit.");
    tx.commit();
  }
   assertEquals(0,expData.size());
}
