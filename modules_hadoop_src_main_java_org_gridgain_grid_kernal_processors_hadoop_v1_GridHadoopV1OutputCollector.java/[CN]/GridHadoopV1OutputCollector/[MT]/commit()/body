{
  if (writer != null) {
    OutputCommitter outputCommitter=jobConf.getOutputCommitter();
    TaskAttemptContextImpl taskCtx=new TaskAttemptContextImpl(jobConf,attempt);
    if (outputCommitter.needsTaskCommit(taskCtx))     outputCommitter.commitTask(taskCtx);
  }
}
