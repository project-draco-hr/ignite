{
  try {
    Grid grid=startGridsMultiThreaded(2);
    String taskClsName="org.gridgain.grid.tests.p2p.GridSingleSplitTestTask";
    String jobClsName="org.gridgain.grid.tests.p2p.GridSingleSplitTestTask$GridSingleSplitTestJob";
    ClassLoader ldr=getExternalClassLoader();
    Class<? extends GridComputeTask<?,?>> taskCls=(Class<? extends GridComputeTask<?,?>>)ldr.loadClass(taskClsName);
    Class<? extends GridComputeTask<?,?>> jobCls=(Class<? extends GridComputeTask<?,?>>)ldr.loadClass(jobClsName);
    grid.compute().localDeployTask(taskCls,ldr);
    grid.compute().execute(taskClsName,2);
    ConcurrentMap<Class<?>,GridOptimizedClassDescriptor> cache=U.staticField(GridOptimizedMarshallerUtils.class,"CLS_DESC_CACHE");
    assertTrue(cache.containsKey(jobCls));
    grid.compute().undeployTask(taskClsName);
    Thread.sleep(1000);
    assertFalse(cache.containsKey(jobCls));
  }
  finally {
    stopAllGrids();
  }
}
