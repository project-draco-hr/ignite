{
  for (int i=0; i < SEND_RETRY_COUNT; i++) {
    try {
      ctx.io().send(dstNodeId,topic,msg,GridIoPolicy.SYSTEM_POOL);
      return;
    }
 catch (    IgniteCheckedException e) {
      if (log.isDebugEnabled())       log.debug("Failed to send message to remote node (will retry) [dstNodeId=" + dstNodeId + ", msg="+ msg+ ", err="+ e+ ']');
      if (!ctx.discovery().alive(dstNodeId))       throw new ClusterTopologyException("Failed to send message (destination node left grid): " + dstNodeId);
      if (i == SEND_RETRY_COUNT - 1)       throw e;
      U.sleep(SEND_RETRY_DELAY);
    }
  }
}
