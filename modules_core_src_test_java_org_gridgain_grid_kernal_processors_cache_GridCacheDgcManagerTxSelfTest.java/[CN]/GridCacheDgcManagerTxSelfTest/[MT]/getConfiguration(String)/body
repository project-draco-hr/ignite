{
  GridConfiguration cfg=super.getConfiguration(gridName);
  GridCacheConfiguration repCacheCfg=defaultCacheConfiguration();
  repCacheCfg.setName("replicated");
  repCacheCfg.setCacheMode(REPLICATED);
  repCacheCfg.setPreloadMode(SYNC);
  repCacheCfg.setDgcFrequency(DGC_FREQ);
  repCacheCfg.setDgcSuspectLockTimeout(DGC_SUSPECT_LOCK_TIMEOUT);
  repCacheCfg.setDefaultTxConcurrency(PESSIMISTIC);
  repCacheCfg.setWriteSynchronizationMode(FULL_ASYNC);
  GridCacheConfiguration partCacheCfg=defaultCacheConfiguration();
  partCacheCfg.setName("partitioned");
  partCacheCfg.setCacheMode(PARTITIONED);
  partCacheCfg.setPreloadMode(SYNC);
  partCacheCfg.setDgcFrequency(DGC_FREQ);
  partCacheCfg.setDgcSuspectLockTimeout(DGC_SUSPECT_LOCK_TIMEOUT);
  partCacheCfg.setDefaultTxConcurrency(PESSIMISTIC);
  partCacheCfg.setWriteSynchronizationMode(GridCacheWriteSynchronizationMode.FULL_ASYNC);
  partCacheCfg.setAtomicityMode(TRANSACTIONAL);
  partCacheCfg.setBackups(1);
  cfg.setCacheConfiguration(repCacheCfg,partCacheCfg);
  GridTcpDiscoverySpi discoSpi=new GridTcpDiscoverySpi();
  discoSpi.setIpFinder(ipFinder);
  cfg.setDiscoverySpi(discoSpi);
  TestCommunicationSpi commSpi=new TestCommunicationSpi();
  cfg.setCommunicationSpi(commSpi);
  commSpis.add(commSpi);
  return cfg;
}
