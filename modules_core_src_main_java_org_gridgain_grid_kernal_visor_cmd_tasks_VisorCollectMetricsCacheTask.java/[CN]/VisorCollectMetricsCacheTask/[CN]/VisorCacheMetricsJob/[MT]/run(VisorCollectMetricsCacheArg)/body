{
  Collection<? extends GridCache<?,?>> caches=arg.all ? g.cachesx(null) : F.asList(g.cachex(arg.cacheName));
  if (caches != null) {
    Collection<VisorCacheMetrics> res=new ArrayList<>(caches.size());
    for (    GridCache<?,?> c : caches) {
      GridNodeMetrics m=g.localNode().metrics();
      GridCacheMetrics cm=c.metrics();
      GridCacheQueryMetrics qm=c.queries().metrics();
      res.add(new VisorCacheMetrics(c.name(),g.localNode().id(),m.getTotalCpus(),(double)m.getHeapMemoryUsed() / m.getHeapMemoryMaximum() * 100.0,m.getCurrentCpuLoad() * 100.0,m.getUpTime(),caches.size(),cm.readTime(),cm.writeTime(),cm.hits(),cm.misses(),cm.reads(),cm.writes(),new VisorCacheQueryMetrics(qm.minimumTime(),qm.maximumTime(),qm.averageTime(),qm.executions(),qm.fails())));
    }
    return res;
  }
  return null;
}
