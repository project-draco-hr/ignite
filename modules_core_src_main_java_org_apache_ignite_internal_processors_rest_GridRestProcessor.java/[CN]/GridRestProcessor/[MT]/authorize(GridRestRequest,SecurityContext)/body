{
  SecurityPermission perm=null;
  String name=null;
switch (req.command()) {
case CACHE_GET:
case CACHE_GET_ALL:
    perm=SecurityPermission.CACHE_READ;
  name=((GridRestCacheRequest)req).cacheName();
break;
case CACHE_PUT:
case CACHE_ADD:
case CACHE_PUT_ALL:
case CACHE_REPLACE:
case CACHE_CAS:
case CACHE_APPEND:
case CACHE_PREPEND:
perm=SecurityPermission.CACHE_PUT;
name=((GridRestCacheRequest)req).cacheName();
break;
case CACHE_REMOVE:
case CACHE_REMOVE_ALL:
perm=SecurityPermission.CACHE_REMOVE;
name=((GridRestCacheRequest)req).cacheName();
break;
case EXE:
case RESULT:
perm=SecurityPermission.TASK_EXECUTE;
name=((GridRestTaskRequest)req).taskName();
break;
case CACHE_METRICS:
case TOPOLOGY:
case NODE:
case VERSION:
case NOOP:
case QUIT:
case ATOMIC_INCREMENT:
case ATOMIC_DECREMENT:
break;
default :
throw new AssertionError("Unexpected command: " + req.command());
}
if (perm != null) ctx.security().authorize(name,perm,sCtx);
}
