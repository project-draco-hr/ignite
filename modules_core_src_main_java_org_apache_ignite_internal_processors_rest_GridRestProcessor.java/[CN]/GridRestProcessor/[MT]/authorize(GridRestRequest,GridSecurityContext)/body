{
  GridSecurityPermission perm=null;
  String name=null;
switch (req.command()) {
case CACHE_GET:
case CACHE_GET_ALL:
    perm=GridSecurityPermission.CACHE_READ;
  name=((GridRestCacheRequest)req).cacheName();
break;
case CACHE_QUERY_EXECUTE:
case CACHE_QUERY_FETCH:
case CACHE_QUERY_REBUILD_INDEXES:
perm=GridSecurityPermission.CACHE_READ;
name=((GridRestCacheQueryRequest)req).cacheName();
break;
case CACHE_INCREMENT:
case CACHE_DECREMENT:
perm=GridSecurityPermission.CACHE_PUT;
break;
case CACHE_PUT:
case CACHE_ADD:
case CACHE_PUT_ALL:
case CACHE_REPLACE:
case CACHE_CAS:
case CACHE_APPEND:
case CACHE_PREPEND:
perm=GridSecurityPermission.CACHE_PUT;
name=((GridRestCacheRequest)req).cacheName();
break;
case CACHE_REMOVE:
case CACHE_REMOVE_ALL:
perm=GridSecurityPermission.CACHE_REMOVE;
name=((GridRestCacheRequest)req).cacheName();
break;
case EXE:
case RESULT:
perm=GridSecurityPermission.TASK_EXECUTE;
name=((GridRestTaskRequest)req).taskName();
break;
case CACHE_METRICS:
case TOPOLOGY:
case NODE:
case VERSION:
case LOG:
case NOOP:
case QUIT:
case GET_PORTABLE_METADATA:
case PUT_PORTABLE_METADATA:
break;
default :
throw new AssertionError("Unexpected command: " + req.command());
}
if (perm != null) ctx.security().authorize(name,perm,sCtx);
}
