{
  final IgniteKernal grid=(IgniteKernal)ignite;
  final GridCache<K,V> cache=grid.cachex(cacheName);
  GridCacheAdapter<K,V> cacheAdapter=grid.context().cache().internalCache(cacheName);
  final GridCacheContext<K,V> ctx=cacheAdapter.context();
  if (ctx.affinity().affinityTopologyVersion() != topVer)   return null;
  if (cacheAdapter instanceof GridNearCacheAdapter)   cacheAdapter=((GridNearCacheAdapter<K,V>)cacheAdapter).dht();
  GridDhtCacheAdapter<K,V> dht=(GridDhtCacheAdapter<K,V>)cacheAdapter;
  IgniteDataLoader<K,V> dataLdr=grid.dataLoader(cacheName);
  for (  GridDhtLocalPartition<K,V> locPart : dht.topology().currentLocalPartitions()) {
    if (!locPart.isEmpty() && locPart.primary(topVer)) {
      for (      GridDhtCacheEntry<K,V> o : locPart.entries())       dataLdr.removeData(o.key());
    }
  }
  dataLdr.close();
  return null;
}
