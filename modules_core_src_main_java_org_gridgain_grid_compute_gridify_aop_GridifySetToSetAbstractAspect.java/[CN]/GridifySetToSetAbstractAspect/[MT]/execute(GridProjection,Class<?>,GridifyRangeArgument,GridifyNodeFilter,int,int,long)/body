{
  long now=U.currentTimeMillis();
  long end=timeout == 0 ? Long.MAX_VALUE : timeout + now;
  if (end < 0)   end=Long.MAX_VALUE;
  if (now > end)   throw new GridComputeTaskTimeoutException("Timeout occurred while waiting for completion.");
  Collection<?> res=subgrid.compute().withTimeout(timeout == 0 ? 0L : (end - now)).execute(new GridifyDefaultRangeTask(cls,nodeFilter,threshold,splitSize,false),arg).get();
  return result(arg.getMethodReturnType(),res);
}
