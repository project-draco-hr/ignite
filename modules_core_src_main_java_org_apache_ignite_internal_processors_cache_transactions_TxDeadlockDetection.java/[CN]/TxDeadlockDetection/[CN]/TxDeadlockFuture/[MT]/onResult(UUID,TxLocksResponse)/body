{
  boolean set=compareAndSet(nodeId,null);
  if (res != null && set) {
    if (res.classError() != null) {
      IgniteLogger log=cctx.logger(TxDeadlockDetection.class);
      log.warning("Failed to finish deadlock detection due to an error: " + nodeId);
      onDone();
    }
 else     detect(res);
  }
 else   onDone();
}
