{
  final ServerSocket sock=new ServerSocket();
  sock.bind(new InetSocketAddress("0.0.0.0",PORT));
  Thread runner=new Thread(){
    @Override public void run(){
      try {
        while (!Thread.currentThread().isInterrupted()) {
          Socket accepted=sock.accept();
          new EchoReader(accepted).start();
        }
      }
 catch (      IOException e) {
        System.err.println("Accept thread failed: " + e.getMessage());
      }
 finally {
        System.out.println("Server finished.");
      }
    }
  }
;
  runner.start();
  runner.join();
}
