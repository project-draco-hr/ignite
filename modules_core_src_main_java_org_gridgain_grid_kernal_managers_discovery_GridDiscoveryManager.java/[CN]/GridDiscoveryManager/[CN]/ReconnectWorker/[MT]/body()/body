{
  while (!isCancelled()) {
    queue.take();
    try {
      U.warn(log,"Will try to reconnect discovery SPI to topology " + "(according to configured segmentation policy).");
      if (hasRslvrs)       checkSegmentOnStart();
      topVer.set(0);
      getSpi().reconnect();
      locNode=getSpi().getLocalNode();
    }
 catch (    GridException e) {
      U.error(log,"Failed to reconnect discovery SPI to topology (will stop node).",e);
      stopNode();
    }
  }
}
