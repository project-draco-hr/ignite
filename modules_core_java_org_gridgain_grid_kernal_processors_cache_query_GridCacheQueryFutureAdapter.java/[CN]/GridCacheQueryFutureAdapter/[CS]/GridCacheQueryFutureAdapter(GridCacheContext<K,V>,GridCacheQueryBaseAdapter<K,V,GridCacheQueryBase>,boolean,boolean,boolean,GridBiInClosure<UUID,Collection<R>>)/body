{
  super(cctx.kernalContext());
  this.cctx=cctx;
  this.qry=qry;
  this.loc=loc;
  this.single=single;
  this.pageLsnr=pageLsnr;
  log=U.logger(ctx,logRef,GridCacheQueryFutureAdapter.class);
  startTime=U.currentTimeMillis();
  long timeout=qry.timeout();
  if (timeout > 0) {
    endTime=startTime + timeout;
    if (endTime < 0)     endTime=Long.MAX_VALUE;
    cctx.time().addTimeoutObject(this);
  }
  if (qry instanceof GridCacheReduceQueryAdapter) {
    GridCacheReduceQueryAdapter rdcQry=(GridCacheReduceQueryAdapter)qry;
    locRdc=rmtRdcOnly ? null : rdcQry.localReducer();
  }
 else   if (qry instanceof GridCacheReduceFieldsQueryAdapter) {
    GridCacheReduceFieldsQueryAdapter rdcQry=(GridCacheReduceFieldsQueryAdapter)qry;
    locRdc=rmtRdcOnly ? null : rdcQry.localReducer();
  }
}
