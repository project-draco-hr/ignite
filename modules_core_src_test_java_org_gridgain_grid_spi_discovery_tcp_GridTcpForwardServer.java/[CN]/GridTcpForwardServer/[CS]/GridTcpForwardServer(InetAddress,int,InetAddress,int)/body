{
  mainThread=new Thread(new Runnable(){
    @Override public void run(){
      ServerSocket inputSock=null;
      Socket outputCon=null;
      try {
        inputSock=new ServerSocket(fromPort,0,fromAddr);
        boolean closed=false;
        while (!closed) {
          try {
            Socket inputCon=inputSock.accept();
            outputCon=new Socket(toAddr,toPort);
            latch=new CountDownLatch(2);
            new ForwardThread("[" + fromAddr + ":"+ fromPort+ "->"+ toAddr+ ":"+ toPort+ "]",inputCon.getInputStream(),outputCon.getOutputStream()).start();
            new ForwardThread("[" + toAddr + ":"+ toPort+ "->"+ fromAddr+ ":"+ fromPort+ "]",outputCon.getInputStream(),inputCon.getOutputStream()).start();
            latch.await();
          }
 catch (          IOException ignore) {
          }
catch (          Throwable ignored) {
            closed=true;
          }
 finally {
            U.closeQuiet(outputCon);
          }
        }
      }
 catch (      IOException ignore) {
        X.error("Failed to bind to input socket [fromAddr=" + fromAddr + ", fromPort="+ fromPort+ "]");
      }
 finally {
        U.closeQuiet(inputSock);
        U.closeQuiet(outputCon);
      }
    }
  }
);
  mainThread.start();
}
