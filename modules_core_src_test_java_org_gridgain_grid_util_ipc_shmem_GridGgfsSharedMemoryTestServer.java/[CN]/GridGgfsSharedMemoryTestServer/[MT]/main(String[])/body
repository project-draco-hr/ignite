{
  System.out.println("Starting server ...");
  U.setWorkDirectory(null,U.getGridGainHome());
  X.println(GridJavaProcess.PID_MSG_PREFIX + U.jvmPid());
  InputStream is=null;
  try {
    GridIpcServerEndpoint srv=new GridIpcSharedMemoryServerEndpoint();
    new GridTestResources().inject(srv);
    srv.start();
    GridIpcEndpoint clientEndpoint=srv.accept();
    is=clientEndpoint.inputStream();
    for (; ; ) {
      X.println("Before read.");
      is.read();
      Thread.sleep(GridIpcSharedMemoryCrashDetectionSelfTest.RW_SLEEP_TIMEOUT);
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
 finally {
    U.closeQuiet(is);
  }
}
