{
  create(igfs,paths(DIR,SUBDIR),null);
  GridTestUtils.assertThrows(log,new Callable<Object>(){
    @Override public Object call() throws Exception {
      IgfsOutputStream os=null;
      try {
        os=igfs.create(FILE,true);
        IgniteUuid id=igfs.context().meta().fileId(FILE);
        igfs.delete(SUBDIR,true);
        while (igfs.context().meta().exists(id))         U.sleep(100);
        os.close();
      }
  finally {
        U.closeQuiet(os);
      }
      return null;
    }
  }
,IOException.class,"File was concurrently deleted: " + FILE);
}
