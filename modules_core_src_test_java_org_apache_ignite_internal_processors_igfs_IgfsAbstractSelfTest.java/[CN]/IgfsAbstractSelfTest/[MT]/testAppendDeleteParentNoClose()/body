{
  create(igfs,paths(DIR,SUBDIR),null);
  createFile(igfs.asSecondary(),FILE,false);
  GridTestUtils.assertThrows(log,new Callable<Object>(){
    @Override public Object call() throws Exception {
      IgfsOutputStream os=null;
      try {
        IgniteUuid id=igfs.context().meta().fileId(FILE);
        os=igfs.append(FILE,false);
        igfs.delete(SUBDIR,true);
        for (int i=0; i < 100 && igfs.context().meta().exists(id); i++)         U.sleep(100);
        os.write(chunk);
        os.close();
      }
  finally {
        U.closeQuiet(os);
      }
      return null;
    }
  }
,IOException.class,"File was concurrently deleted: " + FILE);
}
