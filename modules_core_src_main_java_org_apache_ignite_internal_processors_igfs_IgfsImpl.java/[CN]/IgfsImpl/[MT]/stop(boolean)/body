{
  busyLock.block();
  boolean interrupted=Thread.interrupted();
  if (secondaryFs != null) {
    for (    IgfsFileWorkerBatch batch : workerMap.values())     batch.cancel();
    try {
      if (secondaryFs instanceof LifecycleAware)       ((LifecycleAware)secondaryFs).stop();
    }
 catch (    Exception e) {
      log.error("Failed to close secondary file system.",e);
    }
  }
  igfsCtx.kernalContext().io().removeMessageListener(topic,delMsgLsnr);
  igfsCtx.kernalContext().event().removeLocalEventListener(delDiscoLsnr);
  if (interrupted)   Thread.currentThread().interrupt();
}
