{
  if (busyLock.enterBusy()) {
    try {
      GridGgfsPathSummary sum=new GridGgfsPathSummary();
      summary0(ROOT_ID,sum);
      long secondarySpaceSize=0;
      if (secondaryFs != null) {
        try {
          secondarySpaceSize=secondaryFs.usedSpaceSize();
        }
 catch (        GridException ignore) {
          secondarySpaceSize=-1;
        }
      }
      return new GridGgfsMetricsAdapter(ggfsCtx.data().spaceSize(),ggfsCtx.data().maxSpaceSize(),secondarySpaceSize,sum.directoriesCount(),sum.filesCount(),metrics.filesOpenedForRead(),metrics.filesOpenedForWrite(),metrics.readBlocks(),metrics.readBlocksSecondary(),metrics.writeBlocks(),metrics.writeBlocksSecondary(),metrics.readBytes(),metrics.readBytesTime(),metrics.writeBytes(),metrics.writeBytesTime());
    }
  finally {
      busyLock.leaveBusy();
    }
  }
 else   throw new IllegalStateException("Failed to get metrics because Grid is stopping.");
}
