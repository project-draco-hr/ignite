{
  String marshallerName=GridTestProperties.getProperty("marshaller.class");
  Marshaller marshaller;
  if (marshallerName == null)   marshaller=new OptimizedMarshaller();
 else {
    try {
      Class<? extends Marshaller> cls=(Class<? extends Marshaller>)Class.forName(marshallerName);
      marshaller=cls.newInstance();
    }
 catch (    ClassNotFoundException|IllegalAccessException|InstantiationException e) {
      throw new IgniteCheckedException("Failed to create test marshaller [marshaller=" + marshallerName + ']',e);
    }
  }
  marshaller.setContext(new MarshallerContextTestImpl());
  return marshaller;
}
