{
  Map<UUID,int[]> rdcMap=new HashMap<>(top.size());
  int avgCnt=(int)((float)job.reducers() / top.size() + 0.5f);
  int firstCnt=top.size() - avgCnt * (top.size() - 1);
  int i=0;
  for (  GridNode n : top) {
    int cnt=i == 0 ? firstCnt : avgCnt;
    int[] rdc=new int[cnt];
    for (int r=0; r < cnt; r++)     rdc[r]=i * avgCnt + r;
    rdcMap.put(n.id(),rdc);
    i++;
  }
  return rdcMap;
}
