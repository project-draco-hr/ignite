{
  if (col == null)   out.writeByte(GridPortableMarshaller.NULL);
 else {
    if (tryWriteAsHandle(col))     return;
    out.unsafeEnsure(1 + 4 + 1);
    out.unsafeWriteByte(GridPortableMarshaller.COL);
    out.unsafeWriteInt(col.size());
    out.unsafeWriteByte(ctx.collectionType(col.getClass()));
    for (    Object obj : col)     doWriteObject(obj);
  }
}
