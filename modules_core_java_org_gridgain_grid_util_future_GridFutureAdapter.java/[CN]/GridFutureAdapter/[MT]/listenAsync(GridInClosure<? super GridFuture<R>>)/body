{
  if (lsnr != null) {
    checkValid();
    boolean done=isDone();
    if (!done) {
synchronized (mux) {
        done=isDone();
        if (!done) {
          if (lsnrs == null)           lsnrs=new ArrayList<>();
          lsnrs.add(lsnr);
        }
      }
    }
    if (done) {
      try {
        if (syncNotify)         notifyListener(lsnr);
 else {
          ctx.closure().runLocalSafe(new GPR(){
            @Override public void run(){
              notifyListener(lsnr);
            }
          }
,true);
        }
      }
 catch (      IllegalStateException ignore) {
        U.warn(null,"Future notification will not proceed because grid is stopped: " + ctx.gridName());
      }
    }
  }
}
