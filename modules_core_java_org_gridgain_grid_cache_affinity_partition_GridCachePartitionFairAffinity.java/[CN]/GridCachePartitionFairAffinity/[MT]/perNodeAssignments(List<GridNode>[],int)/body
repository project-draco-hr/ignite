{
  Map<UUID,PartitionSet> res=new HashMap<>();
  for (int part=0; part < assignments.length; part++) {
    if (tier == -1) {
      for (      GridNode node : assignments[part]) {
        PartitionSet parts=res.get(node.id());
        if (parts == null) {
          parts=new PartitionSet(node);
          res.put(node.id(),parts);
        }
        parts.add(part);
      }
    }
 else {
      GridNode node=assignments[part].get(tier);
      PartitionSet parts=res.get(node.id());
      if (parts == null) {
        parts=new PartitionSet(node);
        res.put(node.id(),parts);
      }
      parts.add(part);
    }
  }
  return res;
}
