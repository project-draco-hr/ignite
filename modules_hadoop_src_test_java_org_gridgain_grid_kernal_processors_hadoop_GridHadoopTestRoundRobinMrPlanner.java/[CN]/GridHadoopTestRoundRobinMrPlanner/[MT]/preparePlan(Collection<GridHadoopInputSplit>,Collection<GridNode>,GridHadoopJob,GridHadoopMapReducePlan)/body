{
  if (top.isEmpty())   throw new IllegalArgumentException("Topology is empty");
  Iterator<GridNode> it=top.iterator();
  Map<UUID,Collection<GridHadoopInputSplit>> mappers=new HashMap<>();
  for (  GridHadoopInputSplit block : blocks) {
    GridNode node=it.next();
    Collection<GridHadoopInputSplit> nodeBlocks=mappers.get(node.id());
    if (nodeBlocks == null) {
      nodeBlocks=new ArrayList<>();
      mappers.put(node.id(),nodeBlocks);
    }
    nodeBlocks.add(block);
    if (!it.hasNext())     it=top.iterator();
  }
  int[] rdc=new int[job.reducers()];
  for (int i=0; i < job.reducers(); i++)   rdc[i]=i;
  return new GridHadoopDefaultMapReducePlan(mappers,Collections.singletonMap(it.next().id(),rdc));
}
