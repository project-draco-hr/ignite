{
  Byte flag=PLAIN_CLASS_TO_FLAG.get(val.getClass());
  if (flag == null)   throw new IllegalArgumentException("Can't write object with type: " + val.getClass());
switch (flag) {
case GridPortableMarshaller.BYTE:
    writer.writeByte(flag);
  writer.writeByte((Byte)val);
break;
case GridPortableMarshaller.SHORT:
writer.writeByte(flag);
writer.writeShort((Short)val);
break;
case GridPortableMarshaller.INT:
writer.writeByte(flag);
writer.writeInt((Integer)val);
break;
case GridPortableMarshaller.LONG:
writer.writeByte(flag);
writer.writeLong((Long)val);
break;
case GridPortableMarshaller.FLOAT:
writer.writeByte(flag);
writer.writeFloat((Float)val);
break;
case GridPortableMarshaller.DOUBLE:
writer.writeByte(flag);
writer.writeDouble((Double)val);
break;
case GridPortableMarshaller.CHAR:
writer.writeByte(flag);
writer.writeChar((Character)val);
break;
case GridPortableMarshaller.BOOLEAN:
writer.writeByte(flag);
writer.writeBoolean((Boolean)val);
break;
case GridPortableMarshaller.DECIMAL:
writer.doWriteDecimal((BigDecimal)val);
break;
case GridPortableMarshaller.STRING:
writer.doWriteString((String)val);
break;
case GridPortableMarshaller.UUID:
writer.doWriteUuid((UUID)val);
break;
case GridPortableMarshaller.DATE:
writer.doWriteDate((Date)val);
break;
case GridPortableMarshaller.TIMESTAMP:
writer.doWriteTimestamp((Timestamp)val);
break;
case GridPortableMarshaller.BYTE_ARR:
writer.doWriteByteArray((byte[])val);
break;
case GridPortableMarshaller.SHORT_ARR:
writer.doWriteShortArray((short[])val);
break;
case GridPortableMarshaller.INT_ARR:
writer.doWriteIntArray((int[])val);
break;
case GridPortableMarshaller.LONG_ARR:
writer.doWriteLongArray((long[])val);
break;
case GridPortableMarshaller.FLOAT_ARR:
writer.doWriteFloatArray((float[])val);
break;
case GridPortableMarshaller.DOUBLE_ARR:
writer.doWriteDoubleArray((double[])val);
break;
case GridPortableMarshaller.CHAR_ARR:
writer.doWriteCharArray((char[])val);
break;
case GridPortableMarshaller.BOOLEAN_ARR:
writer.doWriteBooleanArray((boolean[])val);
break;
case GridPortableMarshaller.DECIMAL_ARR:
writer.doWriteDecimalArray((BigDecimal[])val);
break;
case GridPortableMarshaller.STRING_ARR:
writer.doWriteStringArray((String[])val);
break;
case GridPortableMarshaller.UUID_ARR:
writer.doWriteUuidArray((UUID[])val);
break;
case GridPortableMarshaller.DATE_ARR:
writer.doWriteDateArray((Date[])val);
break;
case GridPortableMarshaller.TIMESTAMP_ARR:
writer.doWriteTimestampArray((Timestamp[])val);
break;
default :
throw new IllegalArgumentException("Can't write object with type: " + val.getClass());
}
}
