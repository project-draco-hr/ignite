{
  try {
    while (true) {
      Long idx=transformHeader(new PollProcessor(id));
      if (idx == null)       return null;
      checkRemoved(idx);
      QueueItemKey key=itemKey(idx);
      T data=(T)cache.getAndRemove(key);
      if (data != null)       return data;
      long stop=U.currentTimeMillis() + RETRY_TIMEOUT;
      while (U.currentTimeMillis() < stop) {
        data=(T)cache.getAndRemove(key);
        if (data != null)         return data;
      }
      U.warn(log,"Failed to get item, will retry poll [queue=" + queueName + ", idx="+ idx+ ']');
    }
  }
 catch (  IgniteCheckedException e) {
    throw U.convertException(e);
  }
}
