{
  if (!enterBusy())   return;
  try {
    if (msg.exchangeId() == null) {
      if (log.isDebugEnabled())       log.debug("Received local partition update [nodeId=" + node.id() + ", parts="+ msg.partitions().toFullString()+ ']');
      if (top.update(null,msg.partitions()) != null) {
        demandPool.resendPartitions();
        cctx.dataStructures().onPartitionsChange();
      }
    }
 else {
      exchangeFuture(msg.exchangeId(),null).onReceive(node.id(),msg);
      cctx.dataStructures().onPartitionsChange();
    }
  }
  finally {
    leaveBusy();
  }
}
