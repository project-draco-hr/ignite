{
  GridNode oldest=CU.oldest(cctx);
  if (log.isDebugEnabled())   log.debug("Refreshing partitions [oldest=" + oldest.id() + ", loc="+ cctx.nodeId()+ ']');
  Collection<GridNode> rmts=null;
  try {
    if (oldest.id().equals(cctx.nodeId())) {
      rmts=CU.remoteNodes(cctx);
      GridDhtPartitionFullMap map=top.partitionMap(true);
      if (log.isDebugEnabled())       log.debug("Refreshing partitions from oldest node: " + map.toFullString());
      sendAllPartitions(rmts,map);
    }
 else {
      if (log.isDebugEnabled())       log.debug("Refreshing local partitions from non-oldest node: " + top.localPartitionMap().toFullString());
      sendLocalPartitions(oldest,null);
    }
  }
 catch (  GridInterruptedException e) {
    throw e;
  }
catch (  GridException e) {
    U.error(log,"Failed to refresh partition map [oldest=" + oldest.id() + ", rmts="+ U.nodeIds(rmts)+ ", loc="+ cctx.nodeId()+ ']',e);
  }
}
