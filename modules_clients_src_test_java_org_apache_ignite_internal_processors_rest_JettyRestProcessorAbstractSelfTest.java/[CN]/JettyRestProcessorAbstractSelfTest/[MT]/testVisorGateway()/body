{
  ClusterNode locNode=grid(1).localNode();
  final String successRes=pattern("\\{\\\"error\\\":\\\"\\\",\\\"finished\\\":true,\\\"id\\\":\\\"[^\\\"]+\\\",\\\"result\\\":.+}",true);
  final IgniteUuid cid=grid(1).context().cache().internalCache("person").context().dynamicDeploymentId();
  String ret=content(new VisorGatewayArgument(VisorCacheConfigurationCollectorTask.class).forNode(locNode).collection(IgniteUuid.class,cid));
  info("VisorCacheConfigurationCollectorTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorCacheNodesTask.class).forNode(locNode).argument("person"));
  info("VisorCacheNodesTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorCacheLoadTask.class).forNode(locNode).tuple3(Set.class,Long.class,Object[].class,"person",0,"null"));
  info("VisorCacheLoadTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorCacheSwapBackupsTask.class).forNode(locNode).set(String.class,"person"));
  info("VisorCacheSwapBackupsTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorCacheRebalanceTask.class).forNode(locNode).set(String.class,"person"));
  info("VisorCacheRebalanceTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorCacheMetadataTask.class).forNode(locNode).argument("person"));
  info("VisorCacheMetadataTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorCacheResetMetricsTask.class).forNode(locNode).argument("person"));
  info("VisorCacheResetMetricsTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorIgfsSamplingStateTask.class).forNode(locNode).pair(String.class,Boolean.class,"igfs",false));
  info("VisorIgfsSamplingStateTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorIgfsProfilerClearTask.class).forNode(locNode).argument("igfs"));
  info("VisorIgfsProfilerClearTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorIgfsProfilerTask.class).forNode(locNode).argument("igfs"));
  info("VisorIgfsProfilerTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorIgfsFormatTask.class).forNode(locNode).argument("igfs"));
  info("VisorIgfsFormatTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorIgfsResetMetricsTask.class).forNode(locNode).set(String.class,"igfs"));
  info("VisorIgfsResetMetricsTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorThreadDumpTask.class).forNode(locNode));
  info("VisorThreadDumpTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorLatestTextFilesTask.class).forNode(locNode).pair(String.class,String.class,"",""));
  info("VisorLatestTextFilesTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorLatestVersionTask.class).forNode(locNode));
  info("VisorLatestVersionTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorFileBlockTask.class).forNode(locNode).argument(VisorFileBlockTask.VisorFileBlockArg.class,"",0L,1,0L));
  info("VisorFileBlockTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorNodePingTask.class).forNode(locNode).argument(UUID.class,locNode.id()));
  info("VisorNodePingTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorNodeConfigurationCollectorTask.class).forNode(locNode));
  info("VisorNodeConfigurationCollectorTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorComputeResetMetricsTask.class).forNode(locNode));
  info("VisorComputeResetMetricsTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorQueryTask.class).forNode(locNode).argument(VisorQueryArg.class,"person",URLEncoder.encode("select * from Person"),false,1));
  info("VisorQueryTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  JSONObject json=JSONObject.fromObject(ret);
  final String qryId=(String)((Map)((Map)((Map)json.get("response")).get("result")).get("value")).get("queryId");
  ret=content(new VisorGatewayArgument(VisorQueryNextPageTask.class).forNode(locNode).pair(String.class,Integer.class,qryId,1));
  info("VisorQueryNextPageTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorQueryCleanupTask.class).map(UUID.class,Set.class,F.asMap(locNode.id(),qryId)));
  info("VisorQueryCleanupTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorResolveHostNameTask.class).forNode(locNode));
  info("VisorResolveHostNameTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorComputeCancelSessionsTask.class).map(UUID.class,Set.class,new HashMap()));
  info("VisorComputeCancelSessionsTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorCacheMetricsCollectorTask.class).pair(Boolean.class,Set.class,false,"person"));
  info("VisorCacheMetricsCollectorTask result: " + ret);
  ret=content(new VisorGatewayArgument(VisorCacheMetricsCollectorTask.class).forNodes(grid(1).cluster().nodes()).pair(Boolean.class,Set.class,false,"person"));
  info("VisorCacheMetricsCollectorTask (with nodes) result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorLogSearchTask.class).argument(VisorLogSearchTask.VisorLogSearchArg.class,".",".","abrakodabra.txt",1));
  info("VisorLogSearchTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorNodeGcTask.class));
  info("VisorNodeGcTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorAckTask.class).argument("MSG"));
  info("VisorAckTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorNodeEventsCollectorTask.class).argument(VisorNodeEventsCollectorTask.VisorNodeEventsCollectorTaskArg.class,"null","null","null","taskName","null"));
  info("VisorNodeEventsCollectorTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorNodeDataCollectorTask.class).argument(VisorNodeDataCollectorTaskArg.class,false,"CONSOLE_" + UUID.randomUUID(),UUID.randomUUID(),10,false));
  info("VisorNodeDataCollectorTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorComputeToggleMonitoringTask.class).pair(String.class,Boolean.class,UUID.randomUUID(),false));
  info("VisorComputeToggleMonitoringTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorNodeSuppressedErrorsTask.class).map(UUID.class,Long.class,new HashMap()));
  info("VisorNodeSuppressedErrorsTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorCacheClearTask.class).forNode(locNode).argument("person"));
  info("VisorCacheClearTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  final String START_CACHE="<beans xmlns=\"http://www.springframework.org/schema/beans\"\n" + "    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n" + "    xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n"+ "        http://www.springframework.org/schema/beans/spring-beans-2.5.xsd\">\n"+ "    <bean id=\"cacheConfiguration\" class=\"org.apache.ignite.configuration.CacheConfiguration\">\n"+ "        <property name=\"cacheMode\" value=\"PARTITIONED\"/>\n"+ "        <property name=\"name\" value=\"c\"/>\n"+ "   </bean>\n"+ "</beans>";
  ret=content(new VisorGatewayArgument(VisorCacheStartTask.class).argument(VisorCacheStartTask.VisorCacheStartArg.class,false,"person2",URLEncoder.encode(START_CACHE)));
  info("VisorCacheStartTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
  ret=content(new VisorGatewayArgument(VisorCacheStopTask.class).forNode(locNode).argument(String.class,"c"));
  info("VisorCacheStopTask result: " + ret);
  assertNotNull(ret);
  assertTrue(!ret.isEmpty());
  jsonEquals(ret,successRes);
}
