{
  idxSpi.forceFail(true);
  for (int i=0; i < KEY_CNT; i++) {
    final int key=i;
    GridTestUtils.assertThrows(log,new Callable<Object>(){
      @Override public Object call() throws Exception {
        return cache(0).removex(String.valueOf(key));
      }
    }
,GridCacheTxHeuristicException.class,null);
  }
}
