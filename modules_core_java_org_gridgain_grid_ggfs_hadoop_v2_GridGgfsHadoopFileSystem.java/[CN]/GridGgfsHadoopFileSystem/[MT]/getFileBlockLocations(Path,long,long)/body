{
  A.notNull(path,"path");
  GridGgfsPath ggfsPath=convert(path);
  enterBusy();
  try {
    if (modeRslvr.resolveMode(ggfsPath) == PROXY)     return secondaryFs.getFileBlockLocations(path,start,len);
 else {
      long now=System.currentTimeMillis();
      List<GridGgfsBlockLocation> affinity=new ArrayList<>(rmtClient.affinity(ggfsPath,start,len).get());
      BlockLocation[] arr=new BlockLocation[affinity.size()];
      for (int i=0; i < arr.length; i++)       arr[i]=convert(affinity.get(i));
      if (LOG.isDebugEnabled())       LOG.debug("Fetched file locations [path=" + path + ", fetchTime="+ (System.currentTimeMillis() - now)+ ", locations="+ Arrays.asList(arr)+ ']');
      return arr;
    }
  }
 catch (  GridException e) {
    throw cast(e);
  }
 finally {
    leaveBusy();
  }
}
