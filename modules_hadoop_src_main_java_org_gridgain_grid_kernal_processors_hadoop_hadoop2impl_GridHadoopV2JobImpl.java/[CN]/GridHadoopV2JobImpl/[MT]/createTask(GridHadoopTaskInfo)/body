{
  boolean isAbort=taskInfo.type() == GridHadoopTaskType.ABORT;
switch (taskInfo.type()) {
case MAP:
{
      if (ctx.getJobConf().getUseNewMapper())       return new GridHadoopV2MapTask(taskInfo);
 else       return new GridHadoopV1MapTask(taskInfo);
    }
case REDUCE:
{
    if (ctx.getJobConf().getUseNewReducer())     return new GridHadoopV2ReduceTask(taskInfo);
 else     return new GridHadoopV1ReduceTask(taskInfo);
  }
case COMBINE:
{
  if (ctx.getJobConf().getCombinerClass() == null)   return new GridHadoopV2CombineTask(taskInfo);
 else   return new GridHadoopV1CombineTask(taskInfo);
}
case COMMIT:
case ABORT:
{
if (ctx.getJobConf().getUseNewReducer()) return new GridHadoopV2CleanupTask(taskInfo,isAbort);
 else return new GridHadoopV1CleanupTask(taskInfo,isAbort);
}
default :
return null;
}
}
