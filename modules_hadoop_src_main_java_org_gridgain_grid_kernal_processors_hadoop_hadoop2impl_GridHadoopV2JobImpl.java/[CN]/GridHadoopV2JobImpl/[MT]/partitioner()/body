{
  Class partClsOld=ctx.getConfiguration().getClass("mapred.partitioner.class",null);
  if (partClsOld != null)   return new GridHadoopV1PartitionerAdapter(U.newInstance(ctx.getJobConf().getPartitionerClass()));
  try {
    Class<? extends Partitioner<?,?>> partCls=ctx.getPartitionerClass();
    return new GridHadoopV2PartitionerAdapter((Partitioner<Object,Object>)U.newInstance(partCls));
  }
 catch (  ClassNotFoundException e) {
    throw new GridException(e);
  }
}
