{
  final String hadoopHome=systemOrEnv("HADOOP_HOME",systemOrEnv("HADOOP_PREFIX",null));
  String commonHome=resolveLocation("HADOOP_COMMON_HOME",hadoopHome,"/share/hadoop/common");
  String hdfsHome=resolveLocation("HADOOP_HDFS_HOME",hadoopHome,"/share/hadoop/hdfs");
  String mapredHome=resolveLocation("HADOOP_MAPRED_HOME",hadoopHome,"/share/hadoop/mapreduce");
  return new HadoopLocations(hadoopHome,commonHome,hdfsHome,mapredHome);
}
