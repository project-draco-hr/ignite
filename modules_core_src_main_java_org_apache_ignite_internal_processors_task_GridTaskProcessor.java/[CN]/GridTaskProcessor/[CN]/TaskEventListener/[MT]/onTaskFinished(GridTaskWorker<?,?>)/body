{
  GridTaskSessionImpl ses=worker.getSession();
  if (ses.isFullSupport()) {
synchronized (worker.getSession()) {
      worker.getSession().onClosed();
    }
    ctx.checkpoint().onSessionEnd(ses,false);
    ctx.session().removeSession(ses.getId());
  }
  boolean rmv=tasks.remove(worker.getTaskSessionId(),worker);
  assert rmv;
  if (worker.endTime() < Long.MAX_VALUE)   ctx.timeout().removeTimeoutObject(worker);
  release(worker.getDeployment());
  if (!worker.isInternal())   execTasks.increment();
  if (ses.isFullSupport()) {
    try {
      for (      ComputeJobSibling sibling : worker.getSession().getJobSiblings()) {
        GridJobSiblingImpl s=(GridJobSiblingImpl)sibling;
        ctx.io().removeMessageListener(s.taskTopic(),msgLsnr);
      }
    }
 catch (    IgniteException e) {
      U.error(log,"Failed to unregister job communication message listeners and counters.",e);
    }
  }
}
