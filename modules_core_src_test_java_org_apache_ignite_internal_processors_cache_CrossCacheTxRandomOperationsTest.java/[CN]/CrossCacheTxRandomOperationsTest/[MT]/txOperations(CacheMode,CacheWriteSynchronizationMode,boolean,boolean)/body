{
  Ignite ignite=ignite(0);
  try {
    ignite.createCache(cacheConfiguration(CACHE1,cacheMode,writeSync,fairAff));
    ignite.createCache(cacheConfiguration(CACHE2,cacheMode,writeSync,fairAff));
    txOperations(PESSIMISTIC,REPEATABLE_READ,crossCacheTx,false);
    txOperations(PESSIMISTIC,REPEATABLE_READ,crossCacheTx,true);
    txOperations(OPTIMISTIC,REPEATABLE_READ,crossCacheTx,false);
    txOperations(OPTIMISTIC,REPEATABLE_READ,crossCacheTx,true);
    if (writeSync == FULL_SYNC) {
      txOperations(OPTIMISTIC,SERIALIZABLE,crossCacheTx,false);
      txOperations(OPTIMISTIC,SERIALIZABLE,crossCacheTx,true);
    }
  }
  finally {
    ignite.destroyCache(CACHE1);
    ignite.destroyCache(CACHE2);
  }
}
