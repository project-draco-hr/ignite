{
  ArrayList<VisorGgfsProfilerParsedLine> parsedLines=new ArrayList<>(512);
  try (BufferedReader br=Files.newBufferedReader(p,Charset.forName("UTF-8"))){
    String line=br.readLine();
    if (line != null) {
      if (line.equalsIgnoreCase(HDR))       line=br.readLine();
      while (line != null) {
        try {
          VisorGgfsProfilerParsedLine ln=parseLine(line);
          if (ln != null)           parsedLines.add(ln);
        }
 catch (        NumberFormatException ignored) {
        }
        line=br.readLine();
      }
    }
  }
   Map<Long,List<VisorGgfsProfilerParsedLine>> byStreamId=new HashMap<>();
  for (  VisorGgfsProfilerParsedLine line : parsedLines) {
    List<VisorGgfsProfilerParsedLine> grp=byStreamId.get(line.streamId);
    if (grp == null) {
      grp=new ArrayList<>();
      byStreamId.put(line.streamId,grp);
    }
    grp.add(line);
  }
  List<VisorGgfsProfilerEntry> entries=new ArrayList<>(byStreamId.size());
  for (  List<VisorGgfsProfilerParsedLine> lines : byStreamId.values()) {
    VisorGgfsProfilerEntry entry=aggregateParsedLines(lines);
    if (entry != null)     entries.add(entry);
  }
  Map<String,List<VisorGgfsProfilerEntry>> byPath=new HashMap<>();
  for (  VisorGgfsProfilerEntry entry : entries) {
    List<VisorGgfsProfilerEntry> grp=byPath.get(entry.path());
    if (grp == null) {
      grp=new ArrayList<>();
      byPath.put(entry.path(),grp);
    }
    grp.add(entry);
  }
  List<VisorGgfsProfilerEntry> res=new ArrayList<>(byPath.size());
  for (  List<VisorGgfsProfilerEntry> lst : byPath.values())   res.add(VisorGgfsProfiler.aggregateGgfsProfilerEntries(lst));
  return res;
}
