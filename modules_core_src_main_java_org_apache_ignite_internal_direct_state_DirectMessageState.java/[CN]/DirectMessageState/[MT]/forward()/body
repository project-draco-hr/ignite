{
  pos++;
  if (pos == stack.length) {
    T[] stack0=stack;
    stack=(T[])Array.newInstance(stack.getClass().getComponentType(),stack.length << 1);
    System.arraycopy(stack0,0,stack,0,stack0.length);
  }
  if (stack[pos] == null)   stack[pos]=factory.apply();
}
