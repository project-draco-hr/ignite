{
  if (cancelled)   throw new GridHadoopTaskCancelledException("Task cancelled.");
  try (GridHadoopTaskOutput out=createOutputInternal(ctx);GridHadoopTaskInput in=createInputInternal(ctx)){
    ctx.input(in);
    ctx.output(out);
    task=job.createTask(ctx.taskInfo());
    if (cancelled)     throw new GridHadoopTaskCancelledException("Task cancelled.");
    task.run(ctx);
  }
 }
