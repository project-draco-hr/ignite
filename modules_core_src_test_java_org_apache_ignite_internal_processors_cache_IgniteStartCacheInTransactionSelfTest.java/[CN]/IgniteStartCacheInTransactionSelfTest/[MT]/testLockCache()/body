{
  if (atomicityMode() != TRANSACTIONAL)   return;
  final Ignite ignite=grid(0);
  final String key="key";
  Lock lock=ignite.cache(null).lock(key);
  lock.lock();
  GridTestUtils.assertThrows(log,new Callable<Object>(){
    @Override public Object call() throws Exception {
      ignite.createCache("NEW_CACHE");
      return null;
    }
  }
,IgniteException.class,"Cannot start/stop cache within lock.");
  lock.unlock();
}
