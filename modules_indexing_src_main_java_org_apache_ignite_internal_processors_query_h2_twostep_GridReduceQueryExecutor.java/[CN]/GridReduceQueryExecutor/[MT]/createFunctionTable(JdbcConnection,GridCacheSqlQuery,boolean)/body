{
  try {
    Session ses=(Session)conn.getSession();
    CreateTableData data=new CreateTableData();
    data.tableName="T___";
    data.schema=ses.getDatabase().getSchema(ses.getCurrentSchemaName());
    data.create=true;
    if (!explain) {
      Prepared prepare=ses.prepare(qry.query(),false);
      List<org.h2.expression.Parameter> parsedParams=prepare.getParameters();
      for (int i=Math.min(parsedParams.size(),qry.parameters().length); --i >= 0; ) {
        Object val=qry.parameters()[i];
        parsedParams.get(i).setValue(DataType.convertToValue(ses,val,Value.UNKNOWN));
      }
      data.columns=generateColumnsFromQuery((Query)prepare);
    }
 else     data.columns=planColumns();
    return new GridMergeTable(data,ctx);
  }
 catch (  Exception e) {
    U.closeQuiet(conn);
    throw new IgniteCheckedException(e);
  }
}
