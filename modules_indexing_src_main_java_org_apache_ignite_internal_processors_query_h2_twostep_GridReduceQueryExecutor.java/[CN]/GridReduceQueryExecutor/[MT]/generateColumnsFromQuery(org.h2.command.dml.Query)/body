{
  int columnCount=asQuery.getColumnCount();
  ArrayList<Expression> expressions=asQuery.getExpressions();
  ArrayList<Column> cols=new ArrayList<>();
  for (int i=0; i < columnCount; i++) {
    Expression expr=expressions.get(i);
    int type=expr.getType();
    String name=expr.getAlias();
    long precision=expr.getPrecision();
    int displaySize=expr.getDisplaySize();
    DataType dt=DataType.getDataType(type);
    if (precision > 0 && (dt.defaultPrecision == 0 || (dt.defaultPrecision > precision && dt.defaultPrecision < Byte.MAX_VALUE))) {
      precision=dt.defaultPrecision;
    }
    int scale=expr.getScale();
    if (scale > 0 && (dt.defaultScale == 0 || (dt.defaultScale > scale && dt.defaultScale < precision))) {
      scale=dt.defaultScale;
    }
    if (scale > precision) {
      precision=scale;
    }
    Column col=new Column(name,type,precision,scale,displaySize);
    cols.add(col);
  }
  return cols;
}
