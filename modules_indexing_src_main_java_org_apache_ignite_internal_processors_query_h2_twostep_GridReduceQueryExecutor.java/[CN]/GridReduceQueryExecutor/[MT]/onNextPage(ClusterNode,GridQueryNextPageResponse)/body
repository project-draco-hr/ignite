{
  final long qryReqId=msg.queryRequestId();
  final int qry=msg.query();
  final QueryRun r=runs.get(qryReqId);
  if (r == null)   return;
  final int pageSize=r.pageSize;
  GridMergeIndex idx=r.tbls.get(msg.query()).getScanIndex(null);
  idx.addPage(new GridResultPage(node.id(),msg,false){
    @Override public void fetchNextPage(){
      if (r.rmtErr != null)       throw new CacheException("Next page fetch failed.",r.rmtErr);
      try {
        GridQueryNextPageRequest msg0=new GridQueryNextPageRequest(qryReqId,qry,pageSize);
        if (node.isLocal())         h2.mapQueryExecutor().onMessage(ctx.localNodeId(),msg0);
 else         ctx.io().send(node,GridTopic.TOPIC_QUERY,msg0,GridIoPolicy.PUBLIC_POOL);
      }
 catch (      IgniteCheckedException e) {
        throw new CacheException(e);
      }
    }
  }
);
  if (msg.allRows() != -1)   r.latch.countDown();
}
