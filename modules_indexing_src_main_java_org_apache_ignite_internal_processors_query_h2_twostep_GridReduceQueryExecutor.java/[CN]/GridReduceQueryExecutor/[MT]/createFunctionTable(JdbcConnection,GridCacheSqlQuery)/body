{
  try {
    Session ses=(Session)conn.getSession();
    CreateTableData data=new CreateTableData();
    data.tableName="T___";
    data.schema=ses.getDatabase().getSchema(ses.getCurrentSchemaName());
    data.create=true;
    data.columns=generateColumnsFromQuery((Query)ses.prepare(qry.query(),false));
    return new GridMergeTable(data);
  }
 catch (  Exception e) {
    U.closeQuiet(conn);
    throw new IgniteCheckedException(e);
  }
}
