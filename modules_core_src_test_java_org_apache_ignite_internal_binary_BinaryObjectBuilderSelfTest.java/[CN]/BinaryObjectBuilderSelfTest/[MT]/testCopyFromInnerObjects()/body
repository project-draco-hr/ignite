{
  ArrayList<Object> list=new ArrayList<>();
  list.add(new GridPortableTestClasses.TestObjectAllTypes());
  list.add(list.get(0));
  GridPortableTestClasses.TestObjectContainer c=new GridPortableTestClasses.TestObjectContainer(list);
  BinaryObjectBuilderImpl builder=builder(toPortable(c));
  builder.<List>getField("foo").add("!!!");
  BinaryObject res=builder.build();
  GridPortableTestClasses.TestObjectContainer deserialized=res.deserialize();
  List deserializedList=(List)deserialized.foo;
  assertSame(deserializedList.get(0),deserializedList.get(1));
  assertEquals("!!!",deserializedList.get(2));
  assertTrue(deserializedList.get(0) instanceof GridPortableTestClasses.TestObjectAllTypes);
}
