{
  startServerNodes(3);
  startClientNodes(3);
  checkNodes(3,3);
  srvFailedLatch=new CountDownLatch(2);
  clientFailedLatch=new CountDownLatch(3);
  attachListeners(3,3);
  ((GridTcpDiscoverySpi)G.grid("server-2").configuration().getDiscoverySpi()).simulateNodeFailure();
  await(srvFailedLatch);
  await(clientFailedLatch);
  checkNodes(2,3);
}
