{
  startServerNodes(2);
  startClientNodes(2);
  checkNodes(2,2);
  GridMessaging msg=grid(masterName).message();
  UUID id=null;
  try {
    id=msg.remoteListen(null,new MessageListener()).get();
    msgLatch=new CountDownLatch(4);
    msg.send(null,"Message 1");
    await(msgLatch);
    startServerNodes(1);
    startClientNodes(1);
    checkNodes(3,3);
    msgLatch=new CountDownLatch(6);
    msg.send(null,"Message 2");
    await(msgLatch);
  }
  finally {
    if (id != null)     msg.stopRemoteListen(id);
  }
}
