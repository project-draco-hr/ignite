{
  final SqlFieldsQuery qry=new SqlFieldsQuery(sql);
  qry.setDistributedJoins(true);
  qry.setEnforceJoinOrder(enforceJoinOrder);
  GridTestUtils.assertThrows(log,new Callable<Void>(){
    @Override public Void call() throws Exception {
      cache.query(qry);
      return null;
    }
  }
,CacheException.class,null);
}
