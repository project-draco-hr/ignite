{
  final List<Event> evtList=new ArrayList<>();
  final int evtsCnt=3 + 4 + 1;
  final CountDownLatch latch=new CountDownLatch(evtsCnt);
  grid(1).events().localListen(lsnr=new IgnitePredicate<Event>(){
    @Override public boolean apply(    Event evt){
      log.info("Received event [evt=" + evt + ']');
      evtList.add(evt);
      latch.countDown();
      return true;
    }
  }
,EVTS_GGFS);
  final IgfsPath file=new IgfsPath("/file1");
  ggfs.create(file,false).close();
  ggfs.create(file,true).close();
  try {
    ggfs.create(file,false).close();
  }
 catch (  Exception ignore) {
  }
  assertTrue(latch.await(10,TimeUnit.SECONDS));
  assertEquals(evtsCnt,evtList.size());
  final IgfsPath file1=new IgfsPath("/file1");
  IgniteFsEvent evt=(IgniteFsEvent)evtList.get(0);
  assertEquals(EVT_GGFS_FILE_CREATED,evt.type());
  assertEquals(file1,evt.path());
  evt=(IgniteFsEvent)evtList.get(1);
  assertEquals(EVT_GGFS_FILE_OPENED_WRITE,evt.type());
  assertEquals(file1,evt.path());
  evt=(IgniteFsEvent)evtList.get(2);
  assertEquals(EVT_GGFS_FILE_CLOSED_WRITE,evt.type());
  assertEquals(file1,evt.path());
  assertEquals(0,evt.dataSize());
  assertOneToOne(evtList.subList(3,8),new P1<Event>(){
    @Override public boolean apply(    Event e){
      IgniteFsEvent e0=(IgniteFsEvent)e;
      return e0.type() == EVT_GGFS_FILE_DELETED && e0.path().equals(file1);
    }
  }
,new P1<Event>(){
    @Override public boolean apply(    Event e){
      IgniteFsEvent e0=(IgniteFsEvent)e;
      return e0.type() == EVT_GGFS_FILE_PURGED && e0.path().equals(file1);
    }
  }
,new P1<Event>(){
    @Override public boolean apply(    Event e){
      IgniteFsEvent e0=(IgniteFsEvent)e;
      return e0.type() == EVT_GGFS_FILE_CREATED && e0.path().equals(file1);
    }
  }
,new P1<Event>(){
    @Override public boolean apply(    Event e){
      IgniteFsEvent e0=(IgniteFsEvent)e;
      return e0.type() == EVT_GGFS_FILE_OPENED_WRITE && e0.path().equals(file1);
    }
  }
,new P1<Event>(){
    @Override public boolean apply(    Event e){
      IgniteFsEvent e0=(IgniteFsEvent)e;
      return e0.type() == EVT_GGFS_FILE_CLOSED_WRITE && e0.path().equals(file1);
    }
  }
);
}
