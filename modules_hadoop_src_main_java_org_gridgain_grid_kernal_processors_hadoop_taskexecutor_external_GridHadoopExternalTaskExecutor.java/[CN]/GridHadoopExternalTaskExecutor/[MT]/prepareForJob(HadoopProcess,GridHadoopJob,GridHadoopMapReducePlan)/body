{
  try {
    Collection<GridHadoopInputSplit> mappers=plan == null ? null : plan.mappers(ctx.localNodeId());
    comm.sendMessage(proc.descriptor(),new GridHadoopPrepareForJobRequest(job.id(),job.info(),!F.isEmpty(mappers),plan.reducers()));
  }
 catch (  GridException e) {
    U.error(log,"Failed to send job prepare request to remote process [proc=" + proc + ", job="+ job+ ", plan="+ plan+ ']',e);
    proc.terminate();
  }
}
