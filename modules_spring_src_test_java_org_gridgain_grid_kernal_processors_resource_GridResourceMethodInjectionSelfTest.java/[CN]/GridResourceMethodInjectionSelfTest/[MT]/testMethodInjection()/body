{
  Ignite ignite1=null;
  Ignite ignite2=null;
  try {
    GenericApplicationContext ctx=new GenericApplicationContext();
    RootBeanDefinition bf=new RootBeanDefinition();
    bf.setBeanClass(UserSpringBean.class);
    ctx.registerBeanDefinition(SPRING_BEAN_RSRC_NAME,bf);
    ctx.refresh();
    ignite1=startGrid(1,new GridSpringResourceContextImpl(ctx));
    ignite2=startGrid(2,new GridSpringResourceContextImpl(ctx));
    ignite1.compute().execute(UserResourceTask.class,null);
    checkUsageCount(createClss,UserResource1.class,4);
    checkUsageCount(createClss,UserResource2.class,4);
    checkUsageCount(createClss,UserResource3.class,4);
    checkUsageCount(createClss,UserResource4.class,4);
    checkUsageCount(createClss,UserResource5.class,4);
    checkUsageCount(deployClss,UserResource1.class,4);
    checkUsageCount(deployClss,UserResource2.class,4);
    checkUsageCount(deployClss,UserResource3.class,4);
    checkUsageCount(deployClss,UserResource4.class,4);
  }
  finally {
    GridTestUtils.close(ignite1,log());
    GridTestUtils.close(ignite2,log());
  }
  checkUsageCount(deployClss,UserResource5.class,8);
  checkUsageCount(undeployClss,UserResource1.class,4);
  checkUsageCount(undeployClss,UserResource2.class,4);
  checkUsageCount(undeployClss,UserResource3.class,4);
  checkUsageCount(undeployClss,UserResource4.class,4);
  checkUsageCount(undeployClss,UserResource5.class,8);
}
