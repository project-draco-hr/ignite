{
  createCache(OFFHEAP_MAX_SIZE,true);
  for (int i=0; i < KEYS_CNT; i++)   cache.put(i,i);
  printStat();
  assertEquals(cache.localMetrics().getCacheEvictions(),cache.localMetrics().getOffHeapPuts());
  assertEquals(KEYS_CNT,cache.localMetrics().getOffHeapGets());
  assertEquals(0,cache.localMetrics().getOffHeapHits());
  assertEquals(0f,cache.localMetrics().getOffHeapHitPercentage());
  assertEquals(KEYS_CNT,cache.localMetrics().getOffHeapMisses());
  assertEquals(100f,cache.localMetrics().getOffHeapMissPercentage());
  assertEquals(0,cache.localMetrics().getOffHeapRemovals());
  assertEquals(KEYS_CNT - MAX_SIZE - OFFHEAP_MAX_CNT,cache.localMetrics().getOffHeapEvictions());
  assertEquals(OFFHEAP_MAX_CNT,cache.localMetrics().getOffHeapEntriesCount());
  assertEquals(OFFHEAP_MAX_CNT,cache.localMetrics().getOffHeapPrimaryEntriesCount());
  assertEquals(0,cache.localMetrics().getOffHeapBackupEntriesCount());
  assertEquals(cache.localMetrics().getOffHeapEvictions(),cache.localMetrics().getSwapPuts());
  assertEquals(KEYS_CNT,cache.localMetrics().getSwapGets());
  assertEquals(0,cache.localMetrics().getSwapHits());
  assertEquals(0f,cache.localMetrics().getSwapHitPercentage());
  assertEquals(KEYS_CNT,cache.localMetrics().getSwapMisses());
  assertEquals(100f,cache.localMetrics().getSwapMissPercentage());
  assertEquals(0,cache.localMetrics().getSwapRemovals());
  assertEquals(cache.localMetrics().getOffHeapEvictions(),cache.localMetrics().getSwapEntriesCount());
  for (int i=0; i < KEYS_CNT; i++)   cache.get(i);
  printStat();
  assertEquals(cache.localMetrics().getCacheEvictions(),cache.localMetrics().getOffHeapPuts());
  assertEquals(KEYS_CNT * 2,cache.localMetrics().getOffHeapGets());
  assertEquals(0,cache.localMetrics().getOffHeapHits());
  assertEquals(0.0,cache.localMetrics().getOffHeapHitPercentage(),0.1);
  assertEquals(KEYS_CNT * 2,cache.localMetrics().getOffHeapMisses());
  assertEquals(100.0,cache.localMetrics().getOffHeapMissPercentage(),0.1);
  assertEquals(0,cache.localMetrics().getOffHeapRemovals());
  assertEquals(cache.localMetrics().getCacheEvictions() - OFFHEAP_MAX_CNT,cache.localMetrics().getOffHeapEvictions());
  assertEquals(OFFHEAP_MAX_CNT,cache.localMetrics().getOffHeapEntriesCount());
  assertEquals(OFFHEAP_MAX_CNT,cache.localMetrics().getOffHeapPrimaryEntriesCount());
  assertEquals(0,cache.localMetrics().getOffHeapBackupEntriesCount());
  assertEquals(cache.localMetrics().getOffHeapEvictions(),cache.localMetrics().getSwapPuts());
  assertEquals(KEYS_CNT * 2,cache.localMetrics().getSwapGets());
  assertEquals(KEYS_CNT,cache.localMetrics().getSwapHits());
  assertEquals(100 * KEYS_CNT / (KEYS_CNT * 2.0),cache.localMetrics().getSwapHitPercentage(),0.1);
  assertEquals(KEYS_CNT,cache.localMetrics().getSwapMisses());
  assertEquals(100 * KEYS_CNT / (KEYS_CNT * 2.0),cache.localMetrics().getSwapMissPercentage(),0.1);
  assertEquals(KEYS_CNT,cache.localMetrics().getSwapRemovals());
  assertEquals(KEYS_CNT - MAX_SIZE - OFFHEAP_MAX_CNT,cache.localMetrics().getSwapEntriesCount());
  for (int i=KEYS_CNT; i < KEYS_CNT * 2; i++)   cache.get(i);
  printStat();
  assertEquals(cache.localMetrics().getCacheEvictions(),cache.localMetrics().getOffHeapPuts());
  assertEquals(KEYS_CNT * 3,cache.localMetrics().getOffHeapGets());
  assertEquals(0,cache.localMetrics().getOffHeapHits());
  assertEquals(0.0,cache.localMetrics().getOffHeapHitPercentage(),0.1);
  assertEquals(KEYS_CNT * 3,cache.localMetrics().getOffHeapMisses());
  assertEquals(100.0,cache.localMetrics().getOffHeapMissPercentage(),0.1);
  assertEquals(0,cache.localMetrics().getOffHeapRemovals());
  assertEquals(cache.localMetrics().getCacheEvictions() - OFFHEAP_MAX_CNT,cache.localMetrics().getOffHeapEvictions());
  assertEquals(OFFHEAP_MAX_CNT,cache.localMetrics().getOffHeapEntriesCount());
  assertEquals(OFFHEAP_MAX_CNT,cache.localMetrics().getOffHeapPrimaryEntriesCount());
  assertEquals(0,cache.localMetrics().getOffHeapBackupEntriesCount());
  assertEquals(cache.localMetrics().getOffHeapEvictions(),cache.localMetrics().getSwapPuts());
  assertEquals(KEYS_CNT * 3,cache.localMetrics().getSwapGets());
  assertEquals(KEYS_CNT,cache.localMetrics().getSwapHits());
  assertEquals(100 / 3.0,cache.localMetrics().getSwapHitPercentage(),0.1);
  assertEquals(KEYS_CNT * 2,cache.localMetrics().getSwapMisses());
  assertEquals(100 - (100 / 3.0),cache.localMetrics().getSwapMissPercentage(),0.1);
  assertEquals(KEYS_CNT,cache.localMetrics().getSwapRemovals());
  assertEquals(KEYS_CNT - MAX_SIZE - OFFHEAP_MAX_CNT,cache.localMetrics().getSwapEntriesCount());
  for (int i=0; i < KEYS_CNT; i++)   cache.remove(i);
  printStat();
  assertEquals(cache.localMetrics().getCacheEvictions(),cache.localMetrics().getOffHeapPuts());
  assertEquals(KEYS_CNT * 4 - MAX_SIZE,cache.localMetrics().getOffHeapGets());
  assertEquals(OFFHEAP_MAX_CNT,cache.localMetrics().getOffHeapHits());
  assertEquals(100 * OFFHEAP_MAX_CNT / (KEYS_CNT * 4.0 - MAX_SIZE),cache.localMetrics().getOffHeapHitPercentage(),0.1);
  assertEquals(KEYS_CNT * 4 - OFFHEAP_MAX_CNT - MAX_SIZE,cache.localMetrics().getOffHeapMisses());
  assertEquals(100 * (KEYS_CNT * 4 - OFFHEAP_MAX_CNT - MAX_SIZE) / (KEYS_CNT * 4.0 - MAX_SIZE),cache.localMetrics().getOffHeapMissPercentage(),0.1);
  assertEquals(OFFHEAP_MAX_CNT,cache.localMetrics().getOffHeapRemovals());
  assertEquals(cache.localMetrics().getCacheEvictions() - OFFHEAP_MAX_CNT,cache.localMetrics().getOffHeapEvictions());
  assertEquals(0,cache.localMetrics().getOffHeapEntriesCount());
  assertEquals(0,cache.localMetrics().getOffHeapPrimaryEntriesCount());
  assertEquals(0,cache.localMetrics().getOffHeapBackupEntriesCount());
  assertEquals(cache.localMetrics().getOffHeapEvictions(),cache.localMetrics().getSwapPuts());
  assertEquals(KEYS_CNT * 4 - MAX_SIZE - OFFHEAP_MAX_CNT,cache.localMetrics().getSwapGets());
  assertEquals(KEYS_CNT * 2 - MAX_SIZE - OFFHEAP_MAX_CNT,cache.localMetrics().getSwapHits());
  assertEquals(100 * (KEYS_CNT * 2.0 - MAX_SIZE - OFFHEAP_MAX_CNT) / (KEYS_CNT * 4.0 - MAX_SIZE - OFFHEAP_MAX_CNT),cache.localMetrics().getSwapHitPercentage(),0.1);
  assertEquals(KEYS_CNT * 2,cache.localMetrics().getSwapMisses());
  assertEquals(100 * KEYS_CNT * 2.0 / (KEYS_CNT * 4.0 - MAX_SIZE - OFFHEAP_MAX_CNT),cache.localMetrics().getSwapMissPercentage(),0.1);
  assertEquals(KEYS_CNT * 2 - MAX_SIZE - OFFHEAP_MAX_CNT,cache.localMetrics().getSwapRemovals());
  assertEquals(0,cache.localMetrics().getSwapEntriesCount());
}
