{
  try {
    OutputFormat outputFormat=getOutputFormat(jobCtx);
    OutputCommitter committer=outputFormat.getOutputCommitter(hadoopContext());
    if (committer != null) {
      if (abort)       committer.abortJob(jobCtx,JobStatus.State.FAILED);
 else       committer.commitJob(jobCtx);
    }
  }
 catch (  ClassNotFoundException|IOException e) {
    throw new GridException(e);
  }
catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
    throw new GridInterruptedException(e);
  }
 finally {
    jobImpl.cleanupStagingDirectory();
  }
}
