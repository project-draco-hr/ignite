{
  String addr=host + ":" + port;
  try {
    GridClientConfiguration cliCfg=new GridClientConfiguration();
    cliCfg.setProtocol(GridClientProtocol.TCP);
    cliCfg.setServers(Collections.singletonList(addr));
    cliCfg.setMarshaller(new GridClientOptimizedMarshaller());
    GridClient cli=GridClientFactory.start(cliCfg);
    return new GridHadoopClientProtocol(conf,cli);
  }
 catch (  GridClientException e) {
    throw new IOException("Failed to establish connection with GridGain node: " + addr,e);
  }
}
