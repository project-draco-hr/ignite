{
  List<ClusterNode> cp=null;
  if (master) {
    failedOverJobs.add(ctx.getJobResult().getJobContext());
    ctx.getJobResult().getJobContext().setAttribute(FAILED_NODE_LIST_ATTR,null);
    Integer failoverCnt=ctx.getJobResult().getJobContext().getAttribute(FAILOVER_NUMBER_ATTR);
    if (failoverCnt == null)     ctx.getJobResult().getJobContext().setAttribute(FAILOVER_NUMBER_ATTR,1);
 else {
      if (failoverCnt >= getMaximumFailoverAttempts()) {
        info("Job failover failed because number of maximum failover attempts is exceeded " + "[failedJob=" + ctx.getJobResult().getJob() + ", maxFailoverAttempts="+ getMaximumFailoverAttempts()+ ']');
        return null;
      }
      ctx.getJobResult().getJobContext().setAttribute(FAILOVER_NUMBER_ATTR,failoverCnt + 1);
    }
    cp=new ArrayList<>(top);
    F.retain(cp,false,new GridPredicate<ClusterNode>(){
      @Override public boolean apply(      ClusterNode node){
        return F.isAll(node,filter);
      }
    }
);
  }
  return super.failover(ctx,cp);
}
