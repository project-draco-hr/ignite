{
  AffinityTopologyVersion topVer=null;
  IgniteInternalTx tx=cctx.tm().anyActiveThreadTx();
  if (tx != null && tx.topologyVersionSnapshot() != null)   topVer=tx.topologyVersionSnapshot();
  if (topVer == null)   topVer=cctx.mvcc().lastExplicitLockTopologyVersion(Thread.currentThread().getId());
  if (topVer == null)   mapOnTopology(keys,false,null,waitTopFut);
 else {
    topLocked=true;
    map0(topVer,keys,false,null);
  }
}
