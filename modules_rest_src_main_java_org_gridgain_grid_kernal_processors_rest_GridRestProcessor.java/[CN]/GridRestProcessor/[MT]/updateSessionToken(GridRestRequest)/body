{
  byte[] subjId=U.uuidToBytes(req.clientId());
  byte[] sesTok=req.sessionToken();
  if (sesTok != null)   sesTok=ctx.secureSession().validate(REMOTE_CLIENT,subjId,req.sessionToken(),null);
  if (sesTok == null)   sesTok=ctx.secureSession().validate(REMOTE_CLIENT,subjId,null,null);
  if (sesTok == null)   throw new GridException("Cannot create session token (is secure session SPI set?).");
  return sesTok;
}
