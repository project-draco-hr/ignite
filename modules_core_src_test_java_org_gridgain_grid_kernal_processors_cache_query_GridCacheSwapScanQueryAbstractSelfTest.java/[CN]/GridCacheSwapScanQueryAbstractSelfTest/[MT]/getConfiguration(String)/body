{
  GridConfiguration cfg=super.getConfiguration(gridName);
  cfg.setMarshaller(new GridOptimizedMarshaller(false));
  GridTcpDiscoverySpi disco=new GridTcpDiscoverySpi();
  disco.setIpFinder(ipFinder);
  cfg.setDiscoverySpi(disco);
  cfg.setSwapSpaceSpi(new GridFileSwapSpaceSpi());
  GridCacheConfiguration ccfg=new GridCacheConfiguration();
  ccfg.setSwapEnabled(true);
  ccfg.setMemoryMode(OFFHEAP_TIERED);
  ccfg.setOffHeapMaxMemory(10);
  ccfg.setCacheMode(PARTITIONED);
  ccfg.setAtomicityMode(ATOMIC);
  ccfg.setPortableEnabled(portableEnabled());
  if (portableEnabled()) {
    GridPortableConfiguration pCfg=new GridPortableConfiguration();
    pCfg.setClassNames(Arrays.asList(Key.class.getName(),Person.class.getName()));
    cfg.setPortableConfiguration(pCfg);
  }
  cfg.setCacheConfiguration(ccfg);
  return cfg;
}
