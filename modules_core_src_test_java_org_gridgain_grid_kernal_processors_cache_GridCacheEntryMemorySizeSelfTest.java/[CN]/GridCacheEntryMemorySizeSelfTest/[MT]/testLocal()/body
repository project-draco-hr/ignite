{
  mode=LOCAL;
  try {
    GridCache<Integer,Value> cache=startGrid().cache(null);
    assertTrue(cache.putx(1,new Value(new byte[1024])));
    assertTrue(cache.putx(2,new Value(new byte[2048])));
    assertEquals(KEY_SIZE + NULL_REF_SIZE + ENTRY_OVERHEAD+ extrasSize(cache.entry(0)),cache.entry(0).memorySize());
    assertEquals(KEY_SIZE + ONE_KB_VAL_SIZE + ENTRY_OVERHEAD+ extrasSize(cache.entry(1)),cache.entry(1).memorySize());
    assertEquals(KEY_SIZE + TWO_KB_VAL_SIZE + ENTRY_OVERHEAD+ extrasSize(cache.entry(2)),cache.entry(2).memorySize());
  }
  finally {
    stopAllGrids();
  }
}
