{
  final SqlFieldsQuery qryWrong=new SqlFieldsQuery("select f.id, f.name " + "from " + schemaName.toUpperCase() + ".Fact f");
  cache.put(1,new Fact(1,"cacheInsensitive"));
  GridTestUtils.assertThrows(log,new Callable<Object>(){
    @Override public Object call() throws Exception {
      cache.query(qryWrong);
      return null;
    }
  }
,CacheException.class,"Failed to parse query");
  SqlFieldsQuery qryCorrect=new SqlFieldsQuery("select f.\"id\", f.\"name\" " + "from \"" + schemaName + "\".\"Fact\" f");
  for (  List<?> row : cache.query(qryCorrect)) {
    assertEquals(2,row.size());
    assertEquals(1,row.get(0));
    assertEquals("cacheInsensitive",row.get(1));
  }
}
