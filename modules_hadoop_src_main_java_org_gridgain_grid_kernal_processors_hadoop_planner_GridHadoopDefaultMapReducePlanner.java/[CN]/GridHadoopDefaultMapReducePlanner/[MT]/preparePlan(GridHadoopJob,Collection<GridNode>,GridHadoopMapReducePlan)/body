{
  Collection<UUID> topIds=new HashSet<>(top.size(),1.0f);
  for (  GridNode topNode : top)   topIds.add(topNode.id());
  Map<UUID,Collection<GridHadoopInputSplit>> mappers=mappers(top,topIds,job.input());
  int rdcCnt=job.info().reducers();
  if (rdcCnt < 0)   throw new GridException("Number of reducers must be non-negative, actual: " + rdcCnt);
  Map<UUID,int[]> reducers=reducers(top,mappers,rdcCnt);
  return new GridHadoopDefaultMapReducePlan(mappers,reducers);
}
