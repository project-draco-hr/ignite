{
  Map<UUID,Collection<GridHadoopFileBlock>> mappersMap=new HashMap<>();
  Map<String,Collection<GridNode>> nodes=groupByHost(top);
  for (  GridHadoopFileBlock block : blocks) {
    UUID nodeId=nodeId(job,block,top,nodes);
    if (log.isDebugEnabled())     log.debug("Mapped block to node [block=" + block + ", nodeId="+ nodeId+ ']');
    Collection<GridHadoopFileBlock> nodeBlocks=mappersMap.get(nodeId);
    if (nodeBlocks == null) {
      nodeBlocks=new ArrayList<>();
      mappersMap.put(nodeId,nodeBlocks);
    }
    nodeBlocks.add(block);
  }
  return mappersMap;
}
