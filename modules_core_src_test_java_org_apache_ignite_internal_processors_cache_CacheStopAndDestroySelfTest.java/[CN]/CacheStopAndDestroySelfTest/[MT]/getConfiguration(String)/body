{
  IgniteConfiguration iCfg=super.getConfiguration(gridName);
  if (getTestGridName(2).equals(gridName))   iCfg.setClientMode(true);
  ((TcpDiscoverySpi)iCfg.getDiscoverySpi()).setIpFinder(ipFinder);
  ((TcpDiscoverySpi)iCfg.getDiscoverySpi()).setForceServerMode(true);
  iCfg.setCacheConfiguration();
  TcpCommunicationSpi commSpi=new CountingTxRequestsToClientNodeTcpCommunicationSpi();
  commSpi.setLocalPort(GridTestUtils.getNextCommPort(getClass()));
  commSpi.setTcpNoDelay(true);
  iCfg.setCommunicationSpi(commSpi);
  return iCfg;
}
