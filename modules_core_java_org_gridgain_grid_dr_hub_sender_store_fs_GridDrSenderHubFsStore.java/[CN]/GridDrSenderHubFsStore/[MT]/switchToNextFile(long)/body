{
  LogFile newFile=new LogFile(id);
  if (!files.add(newFile))   return null;
  if (head != null && newFile.id < head.id) {
    files.remove(newFile);
    return null;
  }
  try {
    newFile.init();
  }
 catch (  IOException ex) {
    U.error(log,"Failed to init file: " + newFile,ex);
    files.remove(newFile);
    try {
      newFile.delete();
    }
 catch (    GridException ignored) {
    }
    throw new GridException(ex);
  }
  head=newFile;
  return newFile;
}
