{
  if (!commSpiEnabled)   return;
  Object o=msg.message();
  if (!(o instanceof GridDistributedLockRequest))   return;
  GridKernal g=(GridKernal)G.ignite(ignite.configuration().getNodeId());
  GridCacheContext<Object,Object> cacheCtx=g.internalCache(REPLICATED_ASYNC_CACHE_NAME).context();
  GridCacheTxManager<Object,Object> tm=cacheCtx.tm();
  GridCacheVersion v=((GridCacheVersionable)o).version();
  GridCacheTxEx t=tm.tx(v);
  if (t.hasWriteKey(cacheCtx.txKey("x1")))   assertFalse(t.syncCommit());
 else   if (t.hasWriteKey(cacheCtx.txKey("x2")))   assertTrue(t.syncCommit());
 else   if (t.hasWriteKey(cacheCtx.txKey("x3")))   assertFalse(t.syncCommit());
 else   if (t.hasWriteKey(cacheCtx.txKey("x4")))   assertTrue(t.syncCommit());
}
