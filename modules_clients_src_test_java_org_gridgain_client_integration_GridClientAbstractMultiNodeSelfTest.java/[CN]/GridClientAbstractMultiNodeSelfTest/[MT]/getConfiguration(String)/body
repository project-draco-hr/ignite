{
  GridConfiguration c=super.getConfiguration(gridName);
  c.setLocalHost(HOST);
  c.setRestTcpPort(REST_TCP_PORT_BASE);
  c.setRestEnabled(restEnabled);
  GridSslContextFactory sslCtxFactory=sslContextFactory();
  if (sslCtxFactory != null) {
    c.setRestTcpSslEnabled(true);
    c.setRestTcpSslContextFactory(sslCtxFactory);
  }
  GridTcpDiscoverySpi disco=new GridTcpDiscoverySpi();
  disco.setIpFinder(IP_FINDER);
  c.setDiscoverySpi(disco);
  TestCommunicationSpi spi=new TestCommunicationSpi();
  spi.setLocalPort(GridTestUtils.getNextCommPort(getClass()));
  c.setCommunicationSpi(spi);
  c.setCacheConfiguration(cacheConfiguration(null),cacheConfiguration(PARTITIONED_CACHE_NAME),cacheConfiguration(REPLICATED_CACHE_NAME),cacheConfiguration(REPLICATED_ASYNC_CACHE_NAME));
  ThreadPoolExecutor exec=new ThreadPoolExecutor(40,40,0,TimeUnit.MILLISECONDS,new LinkedBlockingQueue<Runnable>());
  exec.prestartAllCoreThreads();
  c.setExecutorService(exec);
  c.setExecutorServiceShutdown(true);
  ThreadPoolExecutor sysExec=new ThreadPoolExecutor(40,40,0,TimeUnit.MILLISECONDS,new LinkedBlockingQueue<Runnable>());
  sysExec.prestartAllCoreThreads();
  c.setSystemExecutorService(sysExec);
  c.setSystemExecutorServiceShutdown(true);
  return c;
}
