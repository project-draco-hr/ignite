{
  Collection<GridGgfsFile> res=new ArrayList<>();
  try {
    FileStatus[] statuses=fileSys.listStatus(convert(path));
    if (statuses == null)     throw new GridGgfsFileNotFoundException("Failed to list files (path not found): " + path);
    for (    FileStatus status : statuses) {
      GridGgfsFileInfo fsInfo=status.isDirectory() ? new GridGgfsFileInfo(true,properties(status)) : new GridGgfsFileInfo((int)status.getBlockSize(),status.getLen(),null,null,false,properties(status));
      res.add(new GridGgfsFileImpl(new GridGgfsPath(path,status.getPath().getName()),fsInfo,1));
    }
  }
 catch (  FileNotFoundException ignored) {
    throw new GridGgfsFileNotFoundException("Failed to list files (path not found): " + path);
  }
catch (  IOException e) {
    throw handleSecondaryFsError(e,"Failed to list statuses due to secondary file system exception: " + path);
  }
  return res;
}
