{
  boolean wrongVer=X.hasCause(e,RemoteException.class) || (e.getMessage() != null && e.getMessage().contains("Failed on local"));
  GridGgfsException ggfsErr=!wrongVer ? new GridGgfsException(detailMsg,e) : new GridGgfsInvalidHdfsVersionException("HDFS version you are connecting to differs from local " + "version.",e);
  return ggfsErr;
}
