{
  final TestObject obj=new TestObject();
  obj.longVal=100L;
  obj.doubleVal=100.0d;
  obj.longArr=new Long[100 * 1024];
  obj.doubleArr=new Double[100 * 1024];
  Arrays.fill(obj.longArr,100L);
  Arrays.fill(obj.doubleArr,100.0d);
  final IgniteOptimizedMarshaller marsh=new IgniteOptimizedMarshaller(false,null,null,5);
  try {
    multithreaded(new Callable<Object>(){
      @Override public Object call() throws Exception {
        for (int i=0; i < 50; i++)         assertEquals(obj,marsh.unmarshal(marsh.marshal(obj),null));
        return null;
      }
    }
,20);
  }
  finally {
    marsh.setPoolSize(0);
  }
}
