{
  OptimizedObjectInputStream in=OptimizedObjectStreamRegistry.in();
  try {
    byte[] arr=new byte[50];
    for (int i=0; i < arr.length; i++)     arr[i]=(byte)i;
    in.in().bytes(arr,arr.length);
    byte[] buf=new byte[10];
    assertEquals(10,in.read(buf));
    for (int i=0; i < buf.length; i++)     assertEquals(i,buf[i]);
    buf=new byte[30];
    assertEquals(20,in.read(buf,0,20));
    for (int i=0; i < buf.length; i++)     assertEquals(i < 20 ? 10 + i : 0,buf[i]);
    buf=new byte[30];
    assertEquals(10,in.read(buf,10,10));
    for (int i=0; i < buf.length; i++)     assertEquals(i >= 10 && i < 20 ? 30 + (i - 10) : 0,buf[i]);
    buf=new byte[20];
    assertEquals(10,in.read(buf));
    for (int i=0; i < buf.length; i++)     assertEquals(i < 10 ? 40 + i : 0,buf[i]);
  }
  finally {
    OptimizedObjectStreamRegistry.closeIn(in);
  }
}
