{
  WindowHolder tup=ref.get();
  AtomicInteger size=tup.size();
  GridConcurrentSkipListSet<Holder<E>> evtsQueue=tup.collection();
  Collection<E> resCol=new ArrayList<>(cnt);
  while (true) {
    int curSize=size.get();
    if (curSize > 0) {
      if (size.compareAndSet(curSize,curSize - 1)) {
        Holder<E> h=evtsQueue.pollLast();
        if (h != null) {
          resCol.add(h.val);
          if (unique)           tup.set().remove(h.val);
          if (resCol.size() >= cnt)           return resCol;
        }
 else {
          size.incrementAndGet();
          return resCol;
        }
      }
    }
 else     return resCol;
  }
}
