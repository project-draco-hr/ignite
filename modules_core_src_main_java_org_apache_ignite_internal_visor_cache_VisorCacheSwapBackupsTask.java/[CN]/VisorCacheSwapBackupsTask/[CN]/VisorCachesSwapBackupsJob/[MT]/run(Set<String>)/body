{
  Map<String,IgniteBiTuple<Integer,Integer>> total=new HashMap<>();
  ClusterNode locNode=g.localNode();
  for (  GridCache c : g.cachesx()) {
    String cacheName=c.name();
    CacheAffinity<Object> aff=g.affinity(c.name());
    if (names.contains(cacheName)) {
      Set<Entry> entries=c.entrySet();
      int before=entries.size(), after=before;
      for (      Entry entry : entries) {
        if (aff.isBackup(locNode,entry.getKey()) && c.evict(entry.getKey()))         after--;
      }
      total.put(cacheName,new IgniteBiTuple<>(before,after));
    }
  }
  return total;
}
