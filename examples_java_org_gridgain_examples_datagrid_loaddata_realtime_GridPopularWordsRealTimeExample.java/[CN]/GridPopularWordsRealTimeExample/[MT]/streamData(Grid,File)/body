{
  String[] books=inputDir.list();
  try (GridDataLoader<String,Integer> ldr=g.dataLoader(null)){
    ldr.perNodeBufferSize(2048);
    ldr.updater(new IncrementingUpdater());
    for (    String name : books) {
      System.out.println(">>> Storing all words from book in in-memory data grid: " + name);
      try (BufferedReader in=new BufferedReader(new FileReader(new File(inputDir,name)))){
        for (String line=in.readLine(); line != null; line=in.readLine())         for (        final String w : line.split("[^a-zA-Z0-9]"))         if (!w.isEmpty())         ldr.addData(w,1);
      }
       System.out.println(">>> Finished storing all words from book in in-memory data grid: " + name);
    }
  }
 }
