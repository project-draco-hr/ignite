{
  CacheAffinityFunction aff=ccfg.getAffinity();
  Integer dfltReplicas=null;
  Boolean excludeNeighbors=null;
  if (aff instanceof CacheConsistentHashAffinityFunction) {
    CacheConsistentHashAffinityFunction hashAffFunc=(CacheConsistentHashAffinityFunction)aff;
    dfltReplicas=hashAffFunc.getDefaultReplicas();
    excludeNeighbors=hashAffFunc.isExcludeNeighbors();
  }
  VisorCacheAffinityConfiguration cfg=new VisorCacheAffinityConfiguration();
  cfg.function=compactClass(aff);
  cfg.mapper=compactClass(ccfg.getAffinityMapper());
  cfg.partitions=aff.partitions();
  cfg.partitionedBackups=ccfg.getBackups();
  cfg.dfltReplicas=dfltReplicas;
  cfg.excludeNeighbors=excludeNeighbors;
  return cfg;
}
