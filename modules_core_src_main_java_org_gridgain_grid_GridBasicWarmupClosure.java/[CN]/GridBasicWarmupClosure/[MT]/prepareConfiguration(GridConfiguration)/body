{
  if (F.isEmpty(gridCfg.getCacheConfiguration()))   return null;
  GridConfiguration cp=new GridConfiguration();
  cp.setRestEnabled(false);
  Collection<GridCacheConfiguration> reduced=new ArrayList<>();
  for (  GridCacheConfiguration ccfg : gridCfg.getCacheConfiguration()) {
    if (!matches(reduced,ccfg)) {
      GridCacheConfiguration ccfgCp=new GridCacheConfiguration(ccfg);
      if (ccfgCp.getDistributionMode() == GridCacheDistributionMode.CLIENT_ONLY)       ccfgCp.setDistributionMode(GridCacheDistributionMode.PARTITIONED_ONLY);
 else       if (ccfgCp.getDistributionMode() == GridCacheDistributionMode.NEAR_ONLY)       ccfgCp.setDistributionMode(GridCacheDistributionMode.NEAR_PARTITIONED);
      ccfgCp.setStore(null);
      ccfgCp.setWriteBehindEnabled(false);
      reduced.add(ccfgCp);
    }
  }
  GridCacheConfiguration[] res=new GridCacheConfiguration[reduced.size()];
  reduced.toArray(res);
  cp.setCacheConfiguration(res);
  return cp;
}
