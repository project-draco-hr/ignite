{
  final int GRID_CNT=3;
  startGridsMultiThreaded(GRID_CNT);
  final CountDownLatch evtLatch=new CountDownLatch(1);
  log.info("Add templates.");
  for (int i=0; i < GRID_CNT; i++) {
    Ignite ignite=ignite(i);
    ignite.events().localListen(new IgnitePredicate<Event>(){
      @Override public boolean apply(      Event evt){
        log.info("Event: " + evt);
        evtLatch.countDown();
        return true;
      }
    }
,EventType.EVT_CACHE_REBALANCE_STARTED,EventType.EVT_CACHE_REBALANCE_STOPPED);
  }
  for (int i=0; i < GRID_CNT; i++) {
    Ignite ignite=ignite(i);
    CacheConfiguration ccfg=new CacheConfiguration();
    ccfg.setName("cfg-" + i);
    ignite.addCacheConfiguration(ccfg);
  }
  boolean evt=evtLatch.await(3000,TimeUnit.MILLISECONDS);
  assertFalse(evt);
  log.info("Start cache.");
  checkGetOrCreate(ignite(0),"cfg-0",0);
  evt=evtLatch.await(3000,TimeUnit.MILLISECONDS);
  assertTrue(evt);
}
