{
  if (!((CacheObjectBinaryContext)ctx).binaryEnabled())   return super.toCacheKeyObject(ctx,obj,userObj,partition);
  if (obj instanceof KeyCacheObject) {
    ((KeyCacheObject)obj).partition(partition);
    return (KeyCacheObject)obj;
  }
  if (((CacheObjectBinaryContext)ctx).binaryEnabled()) {
    obj=toBinary(obj);
    if (obj instanceof KeyCacheObject) {
      ((KeyCacheObject)obj).partition(partition);
      return (KeyCacheObject)obj;
    }
  }
  return toCacheKeyObject0(obj,userObj,partition);
}
