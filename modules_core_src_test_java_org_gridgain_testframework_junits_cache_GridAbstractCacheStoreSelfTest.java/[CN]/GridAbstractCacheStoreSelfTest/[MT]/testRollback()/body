{
  GridCacheTx tx=new DummyTx();
  store.put(tx,"k1","v1");
  store.txEnd(tx,false);
  tx=new DummyTx();
  assertNull(store.load(tx,"k1"));
  assertNull(store.load(tx,"k2"));
  store.putAll(tx,Collections.singletonMap("k2","v2"));
  store.txEnd(tx,false);
  tx=new DummyTx();
  assertNull(store.load(tx,"k2"));
  store.putAll(tx,Collections.singletonMap("k3","v3"));
  store.txEnd(tx,true);
  tx=new DummyTx();
  assertEquals("v3",store.load(tx,"k3"));
  store.put(tx,"k4","v4");
  store.txEnd(tx,false);
  tx=new DummyTx();
  assertNull(store.load(tx,"k4"));
  assertEquals("v3",store.load(tx,"k3"));
  store.remove(tx,"k3");
  store.txEnd(tx,false);
  tx=new DummyTx();
  assertEquals("v3",store.load(tx,"k3"));
  store.removeAll(tx,Arrays.asList("k3"));
  store.txEnd(tx,false);
  tx=new DummyTx();
  assertEquals("v3",store.load(tx,"k3"));
}
