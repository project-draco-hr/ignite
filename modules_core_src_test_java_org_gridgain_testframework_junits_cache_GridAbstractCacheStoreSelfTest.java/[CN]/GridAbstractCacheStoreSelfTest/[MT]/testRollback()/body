{
  IgniteTx tx=new DummyTx();
  ses.newSession(tx);
  store.put("k1","v1");
  store.txEnd(false);
  tx=new DummyTx();
  ses.newSession(tx);
  assertNull(store.load("k1"));
  assertNull(store.load("k2"));
  store.putAll(Collections.singletonMap("k2","v2"));
  store.txEnd(false);
  tx=new DummyTx();
  ses.newSession(tx);
  assertNull(store.load("k2"));
  store.putAll(Collections.singletonMap("k3","v3"));
  store.txEnd(true);
  tx=new DummyTx();
  ses.newSession(tx);
  assertEquals("v3",store.load("k3"));
  store.put("k4","v4");
  store.txEnd(false);
  tx=new DummyTx();
  ses.newSession(tx);
  assertNull(store.load("k4"));
  assertEquals("v3",store.load("k3"));
  store.remove("k3");
  store.txEnd(false);
  tx=new DummyTx();
  ses.newSession(tx);
  assertEquals("v3",store.load("k3"));
  store.removeAll(Arrays.asList("k3"));
  store.txEnd(false);
  tx=new DummyTx();
  ses.newSession(tx);
  assertEquals("v3",store.load("k3"));
}
