{
  if (obj == null)   doWriteByte(NULL);
 else {
    WriterContext wCtx=detached ? new WriterContext(this.wCtx.out,this.wCtx.handles) : this.wCtx;
    PortableWriterExImpl writer=new PortableWriterExImpl(ctx,wCtx);
    writer.marshal(obj,detached);
    if (detached)     this.wCtx.out=wCtx.out;
  }
}
