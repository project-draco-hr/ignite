{
  if (cache == null)   U.awaitQuiet(latch);
  if (clsById.putIfAbsent(id,F.t(cls,false)) == null) {
    try {
      String old=cache.putIfAbsent(id,cls.getName());
      if (old != null && !old.equals(cls.getName()))       throw new IgniteException("Type ID collision occurred in OptimizedMarshaller. Use " + "OptimizedMarshallerIdMapper to resolve it [id=" + id + ", clsName1="+ cls.getName()+ "clsName2="+ old+ ']');
    }
 catch (    IgniteCheckedException e) {
      throw U.convertException(e);
    }
  }
}
