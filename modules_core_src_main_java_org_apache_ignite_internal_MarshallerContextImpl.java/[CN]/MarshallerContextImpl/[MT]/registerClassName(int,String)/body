{
  GridCacheAdapter<Integer,String> cache0=cache;
  if (cache0 == null)   return false;
  String old;
  try {
    old=cache0.tryPutIfAbsent(id,clsName);
    if (old != null && !old.equals(clsName)) {
      U.quietAndWarn(log,"Type ID collision detected, may affect performance " + "(set idMapper property on marshaller to fix) [id=" + id + ", clsName1="+ clsName+ "clsName2="+ old+ ']');
      return false;
    }
    failedCnt=0;
    return true;
  }
 catch (  CachePartialUpdateCheckedException|GridCacheTryPutFailedException e) {
    if (++failedCnt > 10) {
      U.quietAndWarn(log,e,"Failed to register marshalled class for more than 10 times in a row " + "(may affect performance)");
      failedCnt=0;
    }
    return false;
  }
}
