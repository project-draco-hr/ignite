{
  List<List<GridNode>> assignments=new ArrayList<>(parts);
  Map<UUID,Collection<GridNode>> neighborhoodCache=exclNeighbors ? neighbors(affCtx.currentTopologySnapshot()) : null;
  for (int i=0; i < parts; i++) {
    List<GridNode> partAssignment=assignPartition(i,affCtx.currentTopologySnapshot(),affCtx.backups(),neighborhoodCache);
    assignments.add(partAssignment);
  }
  return assignments;
}
