{
  Collection<GridNode> nodes=ctx.discovery().cacheAffinityNodes(cacheName,topVer);
  if (F.isEmpty(nodes))   return Collections.emptyList();
  Collection<GridNode> affNodes=aff.nodes(part,nodes);
  if (F.isEmpty(affNodes))   throw new GridRuntimeException("Grid cache affinity returned empty nodes collection " + "[aff=" + aff + ", affinityCache="+ this+ ']');
  return U.sealList(affNodes);
}
