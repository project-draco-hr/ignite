{
  byte[] hdr=new byte[hdrLen];
  int off=0;
  if (useNames) {
    PRIM.writeInt(hdr,off,names.size());
    off+=4;
    for (    byte[] name : names) {
      U.arrayCopy(name,0,hdr,off,name.length);
      off+=name.length + 4;
    }
  }
 else {
    PRIM.writeInt(hdr,off,hashCodes.size());
    off+=4;
    for (    Integer hashCode : hashCodes) {
      PRIM.writeInt(hdr,off,hashCode);
      off+=8;
    }
  }
  return hdr;
}
