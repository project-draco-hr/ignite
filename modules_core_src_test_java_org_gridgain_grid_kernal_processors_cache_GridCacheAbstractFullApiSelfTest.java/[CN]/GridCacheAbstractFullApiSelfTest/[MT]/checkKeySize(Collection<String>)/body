{
  if (nearEnabled())   assertEquals("Invalid key size: " + cache().keySet(),keys.size(),cache().size());
 else {
    for (int i=0; i < gridCount(); i++) {
      GridCacheContext<String,Integer> ctx=context(i);
      int size=0;
      for (      String key : keys)       if (ctx.affinity().localNode(key,ctx.discovery().topologyVersion()))       size++;
      assertEquals("Incorrect key size on cache #" + i,size,cache(i).size());
    }
  }
}
