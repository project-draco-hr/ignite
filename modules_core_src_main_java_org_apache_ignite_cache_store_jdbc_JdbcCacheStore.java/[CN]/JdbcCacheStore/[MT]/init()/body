{
  if (initLatch.getCount() > 0) {
    if (initGuard.compareAndSet(false,true)) {
      if (log.isDebugEnabled())       log.debug("Initializing cache store.");
      if (dataSrc == null && F.isEmpty(connUrl))       throw new CacheException("Failed to initialize cache store (connection is not provided).");
      if (dialect == null)       dialect=resolveDialect();
      try {
        if (typeMetadata == null)         throw new CacheException("Failed to initialize cache store (mappping description is not provided).");
        buildTypeCache();
        initOk=true;
      }
  finally {
        initLatch.countDown();
      }
    }
 else     try {
      if (initLatch.getCount() > 0)       initLatch.await();
    }
 catch (    InterruptedException e) {
      Thread.currentThread().interrupt();
      throw new CacheException(e);
    }
  }
  if (!initOk)   throw new CacheException("Cache store was not properly initialized.");
}
