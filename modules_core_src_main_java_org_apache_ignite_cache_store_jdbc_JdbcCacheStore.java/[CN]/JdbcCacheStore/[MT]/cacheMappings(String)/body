{
  Map<Object,EntryMapping> entryMappings=cacheMappings.get(cacheName);
  if (entryMappings != null)   return entryMappings;
  cacheMappingsLock.lock();
  try {
    entryMappings=cacheMappings.get(cacheName);
    if (entryMappings != null)     return entryMappings;
    Collection<CacheQueryTypeMetadata> typeMetadata=ignite().cache(session().cacheName()).configuration().getQueryConfiguration().getTypeMetadata();
    entryMappings=U.newHashMap(typeMetadata.size());
    for (    CacheQueryTypeMetadata type : typeMetadata)     entryMappings.put(keyTypeId(type.getKeyType()),new EntryMapping(dialect,type));
    Map<String,Map<Object,EntryMapping>> mappings=new HashMap<>(cacheMappings);
    mappings.put(cacheName,entryMappings);
    prepareBuilders(cacheName,typeMetadata);
    cacheMappings=mappings;
    return entryMappings;
  }
  finally {
    cacheMappingsLock.unlock();
  }
}
