{
  A.notNull(keys,"keys");
  if (keys.isEmpty())   return new GridClientFutureAdapter<>(Collections.<K,V>emptyMap());
  K key=GridClientUtils.first(keys);
  return withReconnectHandling(new ClientProjectionClosure<Map<K,V>>(){
    @Override public GridClientFuture<Map<K,V>> apply(    GridClientConnection conn,    UUID destNodeId) throws GridClientConnectionResetException, GridClientClosedException {
      return conn.cacheGetAll(cacheName,(Collection<Object>)keys,flags,destNodeId).chain(new GridClientFutureCallback<Map<Object,Object>,Map<K,V>>(){
        @Override public Map<K,V> onComplete(        GridClientFuture<Map<Object,Object>> fut) throws GridClientException {
          Map<Object,Object> map=fut.get();
          Map<K,V> res=null;
          if (map != null) {
            res=new HashMap<>(map.size());
            for (            Map.Entry<Object,Object> e : map.entrySet()) {
              Object key=e.getKey();
              Object val=e.getValue();
              try {
                if (key instanceof GridPortableObject && !flags.contains(NOT_DESERIALIZE_PORTABLES))                 key=((GridPortableObject)key).deserialize();
                if (val instanceof GridPortableObject && !flags.contains(NOT_DESERIALIZE_PORTABLES))                 val=((GridPortableObject)val).deserialize();
              }
 catch (              GridPortableException ex) {
                throw new GridClientException("Failed to deserialize portable object.",ex);
              }
              res.put((K)key,(V)val);
            }
          }
          return res;
        }
      }
);
    }
  }
,cacheName,key);
}
