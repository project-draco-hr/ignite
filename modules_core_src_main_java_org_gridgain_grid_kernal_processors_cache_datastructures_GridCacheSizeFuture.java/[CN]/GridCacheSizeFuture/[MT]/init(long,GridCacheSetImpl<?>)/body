{
  final long topVer=cctx.discovery().topologyVersion();
  Collection<GridNode> nodes=set.dataNodes(topVer);
  nodeIds=new GridConcurrentHashSet<>(F.viewReadOnly(nodes,F.node2id()));
  for (  GridNode node : nodes) {
    if (node.isLocal()) {
      cctx.closures().runLocalSafe(new Runnable(){
        @Override public void run(){
          set.context().dataStructures().processSetDataRequest(cctx.localNodeId(),new GridCacheSetDataRequest<>(reqId,set.id(),topVer,0,true));
        }
      }
,false);
    }
 else     cctx.io().send(node,new GridCacheSetDataRequest<>(reqId,set.id(),topVer,0,true));
  }
}
