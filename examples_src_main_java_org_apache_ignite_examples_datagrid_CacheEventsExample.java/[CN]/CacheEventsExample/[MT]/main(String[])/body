{
  try (Ignite g=Ignition.start("examples/config/example-cache.xml")){
    System.out.println();
    System.out.println(">>> Cache events example started.");
    final Cache<Integer,String> cache=g.cache(CACHE_NAME);
    cache.globalClearAll(0);
    IgniteBiPredicate<UUID,IgniteCacheEvent> locLsnr=new IgniteBiPredicate<UUID,IgniteCacheEvent>(){
      @Override public boolean apply(      UUID uuid,      IgniteCacheEvent evt){
        System.out.println("Received event [evt=" + evt.name() + ", key="+ evt.key()+ ", oldVal="+ evt.oldValue()+ ", newVal="+ evt.newValue());
        return true;
      }
    }
;
    IgnitePredicate<IgniteCacheEvent> rmtLsnr=new IgnitePredicate<IgniteCacheEvent>(){
      @Override public boolean apply(      IgniteCacheEvent evt){
        System.out.println("Cache event [name=" + evt.name() + ", key="+ evt.key()+ ']');
        int key=evt.key();
        return key >= 10 && cache.affinity().isPrimary(g.cluster().localNode(),key);
      }
    }
;
    g.events(g.cluster().forCache(CACHE_NAME)).remoteListen(locLsnr,rmtLsnr,EVT_CACHE_OBJECT_PUT,EVT_CACHE_OBJECT_READ,EVT_CACHE_OBJECT_REMOVED);
    for (int i=0; i < 20; i++)     cache.putx(i,Integer.toString(i));
    Thread.sleep(2000);
  }
 }
