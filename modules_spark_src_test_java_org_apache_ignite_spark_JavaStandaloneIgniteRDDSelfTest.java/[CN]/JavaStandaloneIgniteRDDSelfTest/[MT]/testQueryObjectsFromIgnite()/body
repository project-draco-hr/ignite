{
  JavaSparkContext sc=new JavaSparkContext("local[*]","test");
  try {
    JavaIgniteContext<String,Entity> ic=new JavaIgniteContext<>(sc,new IgniteConfigProvider());
    JavaIgniteRDD<String,Entity> cache=ic.fromCache(PARTITIONED_CACHE_NAME);
    cache.savePairs(sc.parallelize(F.range(0,1001),2).mapToPair(INT_TO_ENTITY_F));
    List<Entity> res=cache.objectSql("Entity","name = ? and salary = ?","name50",5000).map(STR_ENTITY_PAIR_TO_ENTITY_F).collect();
    assertEquals("Invalid result length",1,res.size());
    assertEquals("Invalid result",50,res.get(0).id());
    assertEquals("Invalid result","name50",res.get(0).name());
    assertEquals("Invalid result",5000,res.get(0).salary());
    assertEquals("Invalid count",500,cache.objectSql("Entity","id > 500").count());
  }
  finally {
    sc.stop();
  }
}
