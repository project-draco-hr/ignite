{
  Collection<GridClientConnection> closeConns;
  if (closed)   return;
  closed=true;
  closeConns=new ArrayList<>(conns.values());
  conns.clear();
  for (  GridClientConnection conn : closeConns)   conn.close(CLIENT_CLOSED,waitCompletion);
  if (evtLoop != null)   evtLoop.shutdownGracefully();
 else   if (executor != null)   GridClientUtils.shutdownNow(GridClientConnectionManager.class,executor,log);
}
