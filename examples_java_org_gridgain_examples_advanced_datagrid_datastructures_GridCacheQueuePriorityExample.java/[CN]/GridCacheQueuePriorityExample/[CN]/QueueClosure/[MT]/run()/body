{
  try {
    GridCacheQueue<SampleItem> queue=GridGain.grid().cache(cacheName).dataStructures().queue(queueName,FIFO,0,false,true);
    if (put) {
      UUID locId=GridGain.grid().localNode().id();
      for (int i=0; i < RETRIES; i++) {
        String item=locId + "_" + Integer.toString(i);
        queue.put(new SampleItem(i,GridGain.grid().localNode().id().toString()));
        print("Queue item has been added: " + item);
      }
    }
 else {
      for (int i=0; i < RETRIES; i++)       print("Queue item has been read from queue head: " + queue.poll().toString());
      for (int i=0; i < RETRIES; i++)       print("Queue item has been read from queue tail: " + queue.pollLast());
    }
  }
 catch (  GridException e) {
    throw new RuntimeException(e);
  }
}
