{
  while (len > 0) {
    if (bufPosition >= bufLength) {
      currBufIdx++;
      switchCurrentBuffer(true);
    }
    int remainInBuf=bufLength - bufPosition;
    int bytesToCp=len < remainInBuf ? len : remainInBuf;
    mem.copyMemory(currBuf + bufPosition,ptr,bytesToCp);
    ptr+=bytesToCp;
    len-=bytesToCp;
    bufPosition+=bytesToCp;
  }
}
