{
  boolean changed=false;
  GridDhtLocalPartition part;
  for (int i=0; i < locParts.length(); i++) {
    part=locParts.get(i);
    if (part == null)     continue;
    GridDhtPartitionState state=part.state();
    if (state == RENTING || state == EVICTED) {
      if (log.isDebugEnabled())       log.debug("Waiting for renting partition: " + part);
      part.rent(true).get();
      if (log.isDebugEnabled())       log.debug("Finished waiting for renting partition: " + part);
    }
  }
  lock.writeLock().lock();
  try {
    for (int i=0; i < locParts.length(); i++) {
      part=locParts.get(i);
      if (part == null)       continue;
      if (part.state() == EVICTED) {
        locParts.set(i,null);
        changed=true;
      }
    }
  }
  finally {
    lock.writeLock().unlock();
  }
  return changed;
}
