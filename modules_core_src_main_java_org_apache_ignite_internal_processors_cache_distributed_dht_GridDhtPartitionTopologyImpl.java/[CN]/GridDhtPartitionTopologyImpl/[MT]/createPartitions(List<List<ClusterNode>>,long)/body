{
  ClusterNode loc=cctx.localNode();
  int num=cctx.affinity().partitions();
  for (int p=0; p < num; p++) {
    if (node2part != null && node2part.valid()) {
      if (localNode(p,aff)) {
        GridDhtLocalPartition locPart=createPartition(p);
        updateLocal(p,loc.id(),locPart.state(),updateSeq);
      }
    }
 else     if (localNode(p,aff))     createPartition(p);
  }
}
