{
  A.notNull(f,"f");
  enterBusy();
  try {
    GridGgfsPath path=convert(f);
    GridGgfsMode mode=modeRslvr.resolveMode(path);
    if (mode == PROXY) {
      FileStatus[] arr=secondaryFs.listStatus(toSecondary(f));
      if (arr != null) {
        for (int i=0; i < arr.length; i++)         arr[i]=toPrimary(arr[i]);
      }
      if (clientLog.isLogEnabled()) {
        String[] fileArr=null;
        if (arr != null) {
          fileArr=new String[arr.length];
          for (int i=0; i < arr.length; i++)           fileArr[i]=arr[i].getPath().toString();
        }
        clientLog.logListDirectory(path,PROXY,fileArr);
      }
      return arr;
    }
 else {
      List<GridGgfsFile> files=new ArrayList<>(rmtClient.listFiles(path));
      FileStatus[] arr=new FileStatus[files.size()];
      for (int i=0; i < arr.length; i++)       arr[i]=convert(files.get(i));
      if (clientLog.isLogEnabled()) {
        String[] fileArr=new String[arr.length];
        for (int i=0; i < arr.length; i++)         fileArr[i]=arr[i].getPath().toString();
        clientLog.logListDirectory(path,mode,fileArr);
      }
      return arr;
    }
  }
  finally {
    leaveBusy();
  }
}
