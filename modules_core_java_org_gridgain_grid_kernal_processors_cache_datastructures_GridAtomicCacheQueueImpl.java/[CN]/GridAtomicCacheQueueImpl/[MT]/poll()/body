{
  try {
    Long idx=(Long)cache.transformCompute(queueKey,new PollClosure(uuid));
    if (idx == null)     return null;
    checkRemoved(idx);
    ItemKey key=new ItemKey(uuid,idx,collocated());
    T data=(T)cache.remove(key,null);
    if (data != null)     return data;
    long stop=U.currentTimeMillis() + 1000;
    while (U.currentTimeMillis() < stop) {
      data=(T)cache.remove(key,null);
      if (data != null)       return data;
    }
    U.warn(log,"Failed to get item, retrying poll [queue=" + queueName + ", idx="+ idx+ ']');
    return poll();
  }
 catch (  GridException e) {
    throw new GridRuntimeException(e);
  }
}
