{
  Lock l=filesLock.readLock();
  l.lock();
  try {
    map.iterate(new GridCacheFileLocalStoreMap.Closure(){
      @Override public void apply(      long addr) throws GridException {
        DataEntry e=file(addr).read(addr);
        if (e == null)         throw new GridException("Failed to find entry. Store is corrupted.");
        K k=marsh.unmarshal(e.key(),LOADER);
        V v=marsh.unmarshal(e.value(),LOADER);
        clo.apply(k,v);
      }
    }
);
  }
  finally {
    l.unlock();
  }
}
