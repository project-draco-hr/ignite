{
  long maxWaste=0;
  int maxWasteIdx=-1;
  for (int i=0; i < files.length; i++) {
    StoreFile f=files[i];
    if (f != null && f.needCompact()) {
      long waste=f.waste();
      if (waste > maxWaste) {
        maxWaste=waste;
        maxWasteIdx=i;
      }
    }
  }
  return maxWasteIdx;
}
