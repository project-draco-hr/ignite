{
  this.idx=idx;
  this.fileIdx=fileIdx;
  this.compactIdx=compactIdx;
  path=dir.resolve(String.valueOf(fileIdx + "_" + compactIdx));
  EnumSet<StandardOpenOption> writeOptions=EnumSet.of(CREATE_NEW,APPEND);
  if (store.fsyncDelay == 0)   writeOptions.add(DSYNC);
  writeCh=FileChannel.open(path,writeOptions);
  lock(writeCh,path);
  readCh=AsynchronousFileChannel.open(path,READ);
  liveSize=new AtomicLong();
}
