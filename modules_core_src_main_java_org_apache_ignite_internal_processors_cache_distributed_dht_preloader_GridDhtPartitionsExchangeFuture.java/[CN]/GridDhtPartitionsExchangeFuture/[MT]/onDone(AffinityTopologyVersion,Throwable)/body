{
  for (  GridCacheContext<K,V> cacheCtx : cctx.cacheContexts()) {
    if (err == null) {
      if (!cacheCtx.isLocal())       cacheCtx.affinity().cleanUpCache(res.topologyVersion() - 10);
    }
    if (!F.isEmpty(reqs)) {
      for (      DynamicCacheChangeRequest req : reqs) {
        if (F.eq(cacheCtx.name(),req.cacheName())) {
          if (req.isStart())           cacheCtx.preloader().onInitialExchangeComplete(err);
 else           if (req.isClientStart()) {
            if (req.clientNodeId().equals(ctx.localNodeId()))             cacheCtx.preloader().onInitialExchangeComplete(err);
          }
        }
      }
    }
  }
  if (!F.isEmpty(reqs)) {
    for (    DynamicCacheChangeRequest req : reqs)     cctx.cache().onExchangeDone(req);
  }
  cctx.exchange().onExchangeDone(this);
  if (super.onDone(res,err) && !dummy && !forcePreload) {
    if (log.isDebugEnabled())     log.debug("Completed partition exchange [localNode=" + cctx.localNodeId() + ", exchange= "+ this+ ']');
    initFut.onDone(err == null);
    GridTimeoutObject timeoutObj=this.timeoutObj;
    if (timeoutObj != null)     cctx.kernalContext().timeout().removeTimeoutObject(timeoutObj);
    for (    GridCacheContext<K,V> cacheCtx : cctx.cacheContexts()) {
      if (exchId.event() == EventType.EVT_NODE_FAILED || exchId.event() == EventType.EVT_NODE_LEFT)       cacheCtx.config().getAffinity().removeNode(exchId.nodeId());
    }
    return true;
  }
  return dummy;
}
