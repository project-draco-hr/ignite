{
  Ignite client=grid(serverCount());
  Ignite srv=clientRouter(client);
  assertTrue(client.cluster().localNode().isClient());
  final CacheEventListener lsnr=new CacheEventListener();
  ContinuousQuery<Object,Object> qry=new ContinuousQuery<>();
  qry.setLocalListener(lsnr);
  IgniteCache<Object,Object> clnCache=client.cache(null);
  QueryCursor<?> cur=clnCache.query(qry);
  int keyCnt=100;
  for (int i=0; i < 10; i++) {
    lsnr.latch=new CountDownLatch(keyCnt);
    for (int key=0; key < keyCnt; key++)     clnCache.put(key,key);
    assertTrue("Failed to wait for event.",lsnr.latch.await(5,SECONDS));
    reconnectClientNode(client,srv,null);
    lsnr.latch=new CountDownLatch(keyCnt);
    for (int key=0; key < keyCnt; key++)     clnCache.put(key,key);
    assertTrue("Failed to wait for event.",lsnr.latch.await(5,SECONDS));
  }
  cur.close();
}
