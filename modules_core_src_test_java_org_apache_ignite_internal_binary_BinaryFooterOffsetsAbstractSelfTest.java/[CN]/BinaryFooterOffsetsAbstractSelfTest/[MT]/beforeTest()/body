{
  super.beforeTest();
  ctx=new BinaryContext(BinaryCachingMetadataHandler.create(),new IgniteConfiguration());
  marsh=new BinaryMarshaller();
  IgniteConfiguration iCfg=new IgniteConfiguration();
  BinaryConfiguration bCfg=new BinaryConfiguration();
  bCfg.setTypeConfigurations(Arrays.asList(new BinaryTypeConfiguration(TestObject.class.getName())));
  bCfg.setCompactFooter(compactFooter());
  iCfg.setBinaryConfiguration(bCfg);
  marsh.setContext(new MarshallerContextTestImpl(null));
  IgniteUtils.invoke(BinaryMarshaller.class,marsh,"setPortableContext",ctx,iCfg);
}
