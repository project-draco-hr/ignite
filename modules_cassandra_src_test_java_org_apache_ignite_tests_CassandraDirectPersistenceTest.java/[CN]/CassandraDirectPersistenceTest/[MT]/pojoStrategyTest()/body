{
  CacheStore store1=CacheStoreHelper.createCacheStore("longTypes",new ClassPathResource("org/apache/ignite/tests/persistence/pojo/persistence-settings-1.xml"),CassandraHelper.getAdminDataSrc());
  CacheStore store2=CacheStoreHelper.createCacheStore("personTypes",new ClassPathResource("org/apache/ignite/tests/persistence/pojo/persistence-settings-2.xml"),CassandraHelper.getAdminDataSrc());
  CacheStore store3=CacheStoreHelper.createCacheStore("personTypes",new ClassPathResource("org/apache/ignite/tests/persistence/pojo/persistence-settings-3.xml"),CassandraHelper.getAdminDataSrc());
  Collection<CacheEntryImpl<Long,Person>> entries1=TestsHelper.generateLongsPersonsEntries();
  Collection<CacheEntryImpl<PersonId,Person>> entries2=TestsHelper.generatePersonIdsPersonsEntries();
  Collection<CacheEntryImpl<PersonId,Person>> entries3=TestsHelper.generatePersonIdsPersonsEntries();
  LOGGER.info("Running POJO strategy write tests");
  LOGGER.info("Running single operation write tests");
  store1.write(entries1.iterator().next());
  store2.write(entries2.iterator().next());
  store3.write(entries3.iterator().next());
  LOGGER.info("Single operation write tests passed");
  LOGGER.info("Running bulk operation write tests");
  store1.writeAll(entries1);
  store2.writeAll(entries2);
  store3.writeAll(entries3);
  LOGGER.info("Bulk operation write tests passed");
  LOGGER.info("POJO strategy write tests passed");
  LOGGER.info("Running POJO strategy read tests");
  LOGGER.info("Running single operation read tests");
  Person person=(Person)store1.load(entries1.iterator().next().getKey());
  if (!entries1.iterator().next().getValue().equalsPrimitiveFields(person))   throw new RuntimeException("Person values was incorrectly deserialized from Cassandra");
  person=(Person)store2.load(entries2.iterator().next().getKey());
  if (!entries2.iterator().next().getValue().equalsPrimitiveFields(person))   throw new RuntimeException("Person values was incorrectly deserialized from Cassandra");
  person=(Person)store3.load(entries3.iterator().next().getKey());
  if (!entries3.iterator().next().getValue().equals(person))   throw new RuntimeException("Person values was incorrectly deserialized from Cassandra");
  LOGGER.info("Single operation read tests passed");
  LOGGER.info("Running bulk operation read tests");
  Map persons=store1.loadAll(TestsHelper.getKeys(entries1));
  if (!TestsHelper.checkPersonCollectionsEqual(persons,entries1,true))   throw new RuntimeException("Person values was incorrectly deserialized from Cassandra");
  persons=store2.loadAll(TestsHelper.getKeys(entries2));
  if (!TestsHelper.checkPersonCollectionsEqual(persons,entries2,true))   throw new RuntimeException("Person values was incorrectly deserialized from Cassandra");
  persons=store3.loadAll(TestsHelper.getKeys(entries3));
  if (!TestsHelper.checkPersonCollectionsEqual(persons,entries3,false))   throw new RuntimeException("Person values was incorrectly deserialized from Cassandra");
  LOGGER.info("Bulk operation read tests passed");
  LOGGER.info("POJO strategy read tests passed");
  LOGGER.info("Running POJO strategy delete tests");
  store1.delete(entries1.iterator().next().getKey());
  store1.deleteAll(TestsHelper.getKeys(entries1));
  store2.delete(entries2.iterator().next().getKey());
  store2.deleteAll(TestsHelper.getKeys(entries2));
  store3.delete(entries3.iterator().next().getKey());
  store3.deleteAll(TestsHelper.getKeys(entries3));
  LOGGER.info("POJO strategy delete tests passed");
}
