{
  IgniteInternalTx<?,?> tx=ctx.tm().txx();
  boolean inTx=tx != null && tx.user() && (tx.state() != UNKNOWN && tx.state() != ROLLED_BACK && tx.state() != COMMITTED);
  if (inTx)   return ctx.closures().callLocalSafe(cmd,false).get();
 else {
    try {
      return cmd.call();
    }
 catch (    IgniteCheckedException|IgniteException|IllegalStateException e) {
      throw e;
    }
catch (    Exception e) {
      throw new IgniteCheckedException(e);
    }
  }
}
