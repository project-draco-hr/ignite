{
  IgniteConfiguration c=super.getConfiguration(gridName);
  if (cnt == 0)   c.setClientMode(true);
 else {
    CacheConfiguration cc=new CacheConfiguration();
    cc.setAtomicityMode(atomicityMode);
    cc.setCacheMode(cacheMode);
    cc.setWriteSynchronizationMode(PRIMARY_SYNC);
    cc.setRebalanceMode(SYNC);
    cc.setStartSize(100);
    cc.setBackups(0);
    c.setCacheConfiguration(cc);
  }
  TcpDiscoverySpi disco=new TcpDiscoverySpi();
  disco.setIpFinder(ipFinder);
  c.setDiscoverySpi(disco);
  cnt++;
  return c;
}
