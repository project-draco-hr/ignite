{
  GridCache<Integer,String> near=cache();
  near.lock(1,0);
  try {
    near.put(1,"1");
    assertEquals("1",near.peek(1));
    assertEquals("1",dht().peek(1));
    assertEquals("1",near.get(1));
    assertEquals("1",near.remove(1));
    assertNull(near.peek(1));
    assertNull(dht().peek(1));
    assertTrue(near.isLocked(1));
    assertTrue(near.isLockedByThread(1));
  }
  finally {
    near.unlock(1);
  }
  assertFalse(near.isLocked(1));
  assertFalse(near.isLockedByThread(1));
}
