{
  GridCacheProjection<GridCacheAffinityKey<UUID>,AffinityPerson> cache=cache(g);
  GridCacheQuery<Map.Entry<GridCacheAffinityKey<UUID>,AffinityPerson>> qry=cache.queries().createSqlQuery(AffinityPerson.class,"from AffinityPerson, Organization " + "where " + "AffinityPerson.orgId = Organization.id and lower(Organization.name) = lower(?)");
  GridCacheQueryFuture<GridBiTuple<Double,Integer>> fut=qry.projection(p).execute(new RemoteReducer(),"GridGain");
  LocalReducer locRdc=new LocalReducer();
  GridBiTuple<Double,Integer> t;
  while ((t=fut.next()) != null) {
    if (!locRdc.collect(t))     break;
  }
  print("Average salary for 'GridGain' employees: " + locRdc.reduce());
}
