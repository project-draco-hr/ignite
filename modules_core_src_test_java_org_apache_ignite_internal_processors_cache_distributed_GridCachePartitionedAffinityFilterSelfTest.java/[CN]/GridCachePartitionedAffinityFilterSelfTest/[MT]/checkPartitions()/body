{
  int partCnt=CacheConsistentHashAffinityFunction.DFLT_PARTITION_COUNT;
  CacheAffinityFunction aff=cacheConfiguration(grid(0).configuration(),null).getAffinity();
  IgniteCache<Object,Object> cache=grid(0).jcache(null);
  for (int i=0; i < partCnt; i++) {
    assertEquals(i,aff.partition(i));
    Collection<ClusterNode> nodes=affinity(cache).mapKeyToPrimaryAndBackups(i);
    assertEquals(2,nodes.size());
    ClusterNode primary=F.first(nodes);
    ClusterNode backup=F.last(nodes);
    assertFalse(F.eq(primary.attribute(SPLIT_ATTRIBUTE_NAME),backup.attribute(SPLIT_ATTRIBUTE_NAME)));
  }
}
