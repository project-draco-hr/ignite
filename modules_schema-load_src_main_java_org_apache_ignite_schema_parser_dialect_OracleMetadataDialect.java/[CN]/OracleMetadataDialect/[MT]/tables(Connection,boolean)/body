{
  Collection<DbTable> tbls=new ArrayList<>();
  try (Statement stmt=conn.createStatement()){
    Collection<DbColumn> cols=new ArrayList<>();
    String sql=String.format(SQL_COLUMNS,tblsOnly ? "INNER JOIN all_tables b on a.table_name = b.table_name" : "","TEST");
    try (ResultSet colsRs=stmt.executeQuery(sql)){
      String prevSchema="";
      String prevTbl="";
      while (colsRs.next()) {
        String schema=colsRs.getString(OWNER_IDX);
        String tbl=colsRs.getString(TABLE_NAME_IDX);
        if (prevSchema.isEmpty()) {
          prevSchema=schema;
          prevTbl=tbl;
        }
        if (!schema.equals(prevSchema) || !tbl.equals(prevTbl)) {
          tbls.add(new DbTable(prevSchema,prevTbl,cols));
          prevSchema=schema;
          prevTbl=tbl;
          cols=new ArrayList<>();
        }
        cols.add(new DbColumn(colsRs.getString(COLUMN_NAME_IDX),decodeType(colsRs.getString(DATA_TYPE_IDX)),false,decodeNullable(colsRs.getString(NULLABLE_IDX))));
      }
      if (!cols.isEmpty())       tbls.add(new DbTable(prevSchema,prevTbl,cols));
    }
   }
   return tbls;
}
