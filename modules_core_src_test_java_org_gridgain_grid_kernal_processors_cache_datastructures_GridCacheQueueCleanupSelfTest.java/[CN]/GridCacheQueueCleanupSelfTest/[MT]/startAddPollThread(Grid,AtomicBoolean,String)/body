{
  return GridTestUtils.runAsync(new Callable<Void>(){
    @Override public Void call() throws Exception {
      GridCacheQueue<Integer> queue=grid.cache(null).dataStructures().queue(queueName,0,false,true);
      assertEquals(0,queue.size());
      for (int i=0; i < 10; i++)       assertTrue(queue.add(i));
      while (!stop.get()) {
        for (int i=0; i < 100; i++)         assertTrue(queue.add(i));
        for (int i=0; i < 100; i++)         assertNotNull(queue.poll());
      }
      assertEquals(10,queue.size());
      return null;
    }
  }
);
}
