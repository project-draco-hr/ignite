{
  GridFileLock fileLock=GridLoadTestUtils.fileLock();
  fileLock.lock();
  try {
    String outputFileName=args.length >= 1 ? args[0] : null;
    try (Ignite g=G.start(args.length >= 2 ? args[1] : "modules/core/src/test/config/load/merge-sort-base.xml")){
      int arrRealSize=args.length > 1 ? Integer.parseInt(args[1]) : ARR_SIZE;
      int arrWarmupSize=args.length > 2 ? Integer.parseInt(args[2]) : ARR_SIZE;
      X.println("Test is being executed on the gird of size " + g.cluster().nodes().size() + ".");
      X.println("Performing warm up sorting of int[" + arrWarmupSize + "]...");
      sort(g,arrWarmupSize);
      X.println("Cleaning up after warm-up...");
      g.compute().broadcast(new GridAbsClosure(){
        @Override public void apply(){
          System.gc();
        }
      }
);
      X.println("Performing measured sorting of int[" + arrRealSize + "]...");
      long execTime=sort(g,arrRealSize);
      if (outputFileName != null)       GridLoadTestUtils.appendLineToFile(outputFileName,"%s,%d",GridLoadTestUtils.DATE_TIME_FORMAT.format(new Date()),execTime / 1000);
    }
   }
  finally {
    fileLock.close();
  }
}
