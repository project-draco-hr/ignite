{
  Exception err=null;
  for (int i=0; i < 2; i++) {
    GridGgfsHadoopIpcIo locIo=null;
    try {
      locIo=ipcIo();
      return c.applyx(locIo);
    }
 catch (    GridGgfsHadoopCommunicationException e) {
      locIo.forceClose();
      clientIo.compareAndSet(locIo,null);
      if (log.isDebugEnabled())       log.debug("Failed to send message to a server: " + e);
      err=e;
    }
catch (    IOException e) {
      return new GridPlainFutureAdapter<>(e);
    }
catch (    GridException e) {
      return new GridPlainFutureAdapter<>(e);
    }
  }
  if (err == null)   throw new AssertionError();
  log.error("Failed to send message to a server.",err);
  return new GridPlainFutureAdapter<>(err);
}
