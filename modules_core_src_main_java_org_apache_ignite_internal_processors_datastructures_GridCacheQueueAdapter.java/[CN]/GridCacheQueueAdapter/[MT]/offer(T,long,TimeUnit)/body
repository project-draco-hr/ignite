{
  A.notNull(item,"item");
  A.ensure(timeout >= 0,"Timeout cannot be negative: " + timeout);
  if (!bounded()) {
    boolean offer=offer(item);
    assert offer;
    return true;
  }
  long end=U.currentTimeMillis() + MILLISECONDS.convert(timeout,unit);
  while (U.currentTimeMillis() < end) {
    boolean retVal=false;
    try {
      if (writeSem.tryAcquire(end - U.currentTimeMillis(),MILLISECONDS)) {
        checkStopping();
        retVal=offer(item);
      }
    }
 catch (    InterruptedException e) {
      Thread.currentThread().interrupt();
      throw new IgniteInterruptedException("Queue put interrupted.",e);
    }
    if (retVal)     return true;
  }
  return false;
}
