{
  IgniteConfiguration cfg=super.getConfiguration(gridName);
  BinaryTypeConfiguration typeCfg=new BinaryTypeConfiguration();
  typeCfg.setClassName(TestObject.class.getName());
  PortableMarshaller marsh=new PortableMarshaller();
  marsh.setTypeConfigurations(Collections.singleton(typeCfg));
  CacheKeyConfiguration keyCfg=new CacheKeyConfiguration(TestObject.class.getName(),"affKey");
  cfg.setCacheKeyCfg(keyCfg);
  cfg.setMarshaller(marsh);
  if (!gridName.equals(getTestGridName(GRID_CNT))) {
    CacheConfiguration cacheCfg=new CacheConfiguration();
    cacheCfg.setCacheMode(PARTITIONED);
    cfg.setCacheConfiguration(cacheCfg);
  }
  ((TcpDiscoverySpi)cfg.getDiscoverySpi()).setIpFinder(ipFinder);
  return cfg;
}
