{
  writeCnt.incrementAndGet();
  checkSession();
  if (write.get()) {
    Session hibSes=session();
switch (ses.cacheName()) {
case "cache1":
      hibSes.save(new Table1(entry.getKey(),entry.getValue()));
    break;
case "cache2":
  if (fail.get())   throw new CacheWriterException("Expected failure.");
hibSes.save(new Table2(entry.getKey(),entry.getValue()));
break;
default :
throw new CacheWriterException("Wring cache: " + ses.cacheName());
}
}
}
