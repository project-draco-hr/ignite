{
  CacheAffinity<Object> aff=grid(0).affinity(null);
  for (int i=0; i < gridCount(); i++) {
    ClusterNode node=ignite(i).cluster().localNode();
    IgniteCache<Integer,String> cache=jcache(i);
    for (int key=0; key < keys; key++) {
      String expVal=expVals.get(key);
      if (aff.isPrimaryOrBackup(node,key)) {
        assertEquals(expVal,cache.localPeek(key,CachePeekMode.ONHEAP));
        assertEquals(expVal,cache.get(key));
      }
 else {
        assertNull(cache.localPeek(key,CachePeekMode.ONHEAP));
        if (!expVals.containsKey(key))         assertNull(cache.get(key));
      }
    }
    for (int key=keys + 1000; i < keys + 1010; i++) {
      assertNull(cache.localPeek(key,CachePeekMode.ONHEAP));
      assertNull(cache.get(key));
    }
  }
}
