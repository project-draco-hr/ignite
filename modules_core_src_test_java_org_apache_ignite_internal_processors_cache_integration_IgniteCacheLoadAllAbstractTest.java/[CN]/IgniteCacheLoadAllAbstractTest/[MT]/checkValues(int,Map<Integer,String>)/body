{
  GridCacheAffinity<Object> aff=cache(0).affinity();
  for (int i=0; i < gridCount(); i++) {
    ClusterNode node=ignite(i).cluster().localNode();
    IgniteCache<Integer,String> cache=jcache(i);
    for (int key=0; key < keys; key++) {
      String expVal=expVals.get(key);
      if (aff.isPrimaryOrBackup(node,key)) {
        assertEquals(expVal,cache.localPeek(key));
        assertEquals(expVal,cache.get(key));
      }
 else {
        assertNull(cache.localPeek(key));
        if (!expVals.containsKey(key))         assertNull(cache.get(key));
      }
    }
    for (int key=keys + 1000; i < keys + 1010; i++) {
      assertNull(cache.localPeek(key));
      assertNull(cache.get(key));
    }
  }
}
