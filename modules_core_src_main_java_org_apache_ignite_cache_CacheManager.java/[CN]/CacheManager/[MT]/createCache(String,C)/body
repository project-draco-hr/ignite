{
  ensureNotClosed();
  if (cacheCfg == null)   throw new NullPointerException();
  if (cacheName == null)   throw new NullPointerException();
  if (getCache0(cacheName) != null)   throw new CacheException("Cache already exists [cacheName=" + cacheName + ", manager="+ uri+ ']');
  CacheConfiguration<K,V> igniteCacheCfg;
  if (cacheCfg instanceof CompleteConfiguration)   igniteCacheCfg=new CacheConfiguration<>((CompleteConfiguration<K,V>)cacheCfg);
 else {
    igniteCacheCfg=new CacheConfiguration<>();
    igniteCacheCfg.setTypes(cacheCfg.getKeyType(),cacheCfg.getValueType());
    igniteCacheCfg.setStoreValueBytes(cacheCfg.isStoreByValue());
  }
  igniteCacheCfg.setName(cacheName);
  IgniteCache<K,V> res=ignite.createCache(igniteCacheCfg);
  ((IgniteCacheProxy<K,V>)res).setCacheManager(this);
  if (res == null)   throw new CacheException();
  if (igniteCacheCfg.isManagementEnabled())   enableManagement(cacheName,true);
  if (igniteCacheCfg.isStatisticsEnabled())   enableStatistics(cacheName,true);
  return res;
}
