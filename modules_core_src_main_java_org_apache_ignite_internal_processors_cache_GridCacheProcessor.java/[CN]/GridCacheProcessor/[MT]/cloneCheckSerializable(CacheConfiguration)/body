{
  if (val == null)   return null;
  if (val.getCacheStoreFactory() != null) {
    try {
      marshaller.unmarshal(marshaller.marshal(val.getCacheStoreFactory()),val.getCacheStoreFactory().getClass().getClassLoader());
    }
 catch (    IgniteCheckedException e) {
      throw new IgniteCheckedException("Failed to validate cache configuration. " + "Cache store factory is not serializable. Cache name: " + U.maskName(val.getName()),e);
    }
  }
  try {
    return marshaller.unmarshal(marshaller.marshal(val),U.resolveClassLoader(ctx.config().getClassLoader()));
  }
 catch (  IgniteCheckedException e) {
    throw new IgniteCheckedException("Failed to validate cache configuration " + "(make sure all objects in cache configuration are serializable): " + U.maskName(val.getName()),e);
  }
}
