{
  if (data instanceof DynamicCacheChangeBatch) {
    DynamicCacheChangeBatch batch=(DynamicCacheChangeBatch)data;
    for (    DynamicCacheChangeRequest req : batch.requests()) {
      DynamicCacheDescriptor existing=registeredCaches.get(maskNull(req.cacheName()));
      try {
        if (req.isStart() && !req.clientStartOnly()) {
          CacheConfiguration ccfg=req.startCacheConfiguration();
          if (existing != null) {
            if (validateCfg)             checkCache(existing.cacheConfiguration(),ccfg,nodeId);
            if (existing.valid()) {
              existing.deploymentId(req.deploymentId());
              ctx.discovery().setCacheFilter(req.cacheName(),ccfg.getNodeFilter(),ccfg.getNearConfiguration() != null,ccfg.getCacheMode() == LOCAL);
            }
          }
 else           registeredCaches.put(maskNull(req.cacheName()),new DynamicCacheDescriptor(ccfg,req.deploymentId()));
        }
      }
 catch (      IgniteCheckedException e) {
        existing.validationFailed(e);
      }
    }
  }
}
