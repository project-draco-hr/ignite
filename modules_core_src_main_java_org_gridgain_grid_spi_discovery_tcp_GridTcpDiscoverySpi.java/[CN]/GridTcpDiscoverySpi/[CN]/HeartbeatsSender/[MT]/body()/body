{
  while (!isLocalNodeCoordinator())   Thread.sleep(1000);
  if (log.isDebugEnabled())   log.debug("Heartbeats sender has been started.");
  while (!isInterrupted()) {
    if (spiStateCopy() != CONNECTED) {
      if (log.isDebugEnabled())       log.debug("Stopping heartbeats sender (SPI is not connected to topology).");
      return;
    }
    GridTcpDiscoveryHeartbeatMessage msg=new GridTcpDiscoveryHeartbeatMessage(locNodeId);
    msgWorker.addMessage(msg);
    Thread.sleep(hbFreq);
  }
}
