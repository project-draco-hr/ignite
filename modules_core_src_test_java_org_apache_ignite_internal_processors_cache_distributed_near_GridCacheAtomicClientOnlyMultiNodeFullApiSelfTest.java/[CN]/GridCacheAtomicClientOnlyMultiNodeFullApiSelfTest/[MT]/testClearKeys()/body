{
  Cache<String,Integer> nearCache=cache();
  Cache<String,Integer> primary=fullCache();
  Collection<String> keys=primaryKeysForCache(primary,3);
  for (  String key : keys)   assertNull(nearCache.get(key));
  String lastKey=F.last(keys);
  Collection<String> subKeys=new ArrayList<>(keys);
  subKeys.remove(lastKey);
  Map<String,Integer> vals=new HashMap<>(keys.size());
  int i=0;
  for (  String key : keys)   vals.put(key,i++);
  nearCache.putAll(vals);
  for (  String subKey : subKeys)   nearCache.clear(subKey);
  for (  String key : subKeys) {
    assertNull(nearCache.peek(key));
    assertNotNull(primary.peek(key));
  }
  assertEquals(null,nearCache.peek(lastKey));
  nearCache.clearAll();
  vals.put(lastKey,102);
  nearCache.putAll(vals);
  for (  String key : keys)   nearCache.projection(gte100).clear(key);
  assertNull(nearCache.peek(lastKey));
  for (  String key : subKeys)   assertEquals(null,nearCache.peek(key));
}
