{
  startGridsMultiThreaded(SERVERS_COUNT);
  final int ITERS=5;
  for (int i=0; i < ITERS; i++) {
    log.info("Iteration: " + i);
    Integer key=primaryKey(grid(0).cache(CACHE_NAME));
    long topVer=grid(0).cluster().topologyVersion();
    IgniteInternalFuture<Object> fut=GridTestUtils.runAsync(new Callable<Object>(){
      @Override public Object call() throws Exception {
        U.sleep(500);
        stopGrid(0);
        return null;
      }
    }
);
    while (!fut.isDone())     grid(1).compute().affinityCall(CACHE_NAME,key,new CheckCallable(key,topVer,topVer + 1));
    fut.get();
    if (i < ITERS - 1)     startGrid(0);
  }
  stopAllGrids();
}
