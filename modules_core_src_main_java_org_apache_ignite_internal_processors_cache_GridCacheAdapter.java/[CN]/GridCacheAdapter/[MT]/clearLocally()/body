{
  ctx.denyOnFlag(READ);
  ctx.checkSecurity(GridSecurityPermission.CACHE_REMOVE);
  List<GridCacheClearAllRunnable<K,V>> jobs=splitClearAll();
  if (!F.isEmpty(jobs)) {
    ExecutorService execSvc=null;
    if (jobs.size() > 1) {
      execSvc=Executors.newFixedThreadPool(jobs.size() - 1);
      for (int i=1; i < jobs.size(); i++)       execSvc.submit(jobs.get(i));
    }
    try {
      jobs.get(0).run();
    }
  finally {
      if (execSvc != null) {
        execSvc.shutdown();
        try {
          while (!execSvc.isTerminated() && !Thread.currentThread().isInterrupted())           execSvc.awaitTermination(1000,TimeUnit.MILLISECONDS);
        }
 catch (        InterruptedException ignore) {
          U.warn(log,"Got interrupted while waiting for Cache.clearLocally() executor service to " + "finish.");
          Thread.currentThread().interrupt();
        }
      }
    }
  }
}
