{
  A.notNull(key,"key");
  if (keyCheck)   validateCacheKey(key);
  try {
    GridCacheEntryEx<K,V> e=entry0(key,ctx.discovery().topologyVersion(),false,false);
    if (e == null)     return false;
    if (e.isDht() && CU.isNearEnabled(ctx)) {
      GridCache<K,V> near=ctx.isDht() ? ctx.dht().near() : ctx.near();
      return near.isLockedByThread(key) || e.lockedByThread();
    }
    return e.lockedByThread();
  }
 catch (  GridCacheEntryRemovedException ignore) {
    return false;
  }
}
