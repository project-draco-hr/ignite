{
  try {
    checkJta();
  }
 catch (  IgniteCheckedException e) {
    return new GridFinishedFuture<>(e);
  }
  if (log.isDebugEnabled())   log.debug("Performing async op: " + op);
  IgniteTxLocalAdapter tx=ctx.tm().threadLocalTx(ctx);
  CacheOperationContext opCtx=ctx.operationContextPerCall();
  if (tx == null || tx.implicit()) {
    boolean skipStore=ctx.skipStore();
    int retries=opCtx != null && opCtx.noRetries() ? 1 : MAX_RETRIES;
    if (retries == 1) {
      tx=ctx.tm().newTx(true,op.single(),ctx.systemTx() ? ctx : null,OPTIMISTIC,READ_COMMITTED,ctx.kernalContext().config().getTransactionConfiguration().getDefaultTxTimeout(),!skipStore,0);
      return asyncOp(tx,op,opCtx);
    }
 else {
      AsyncOpRetryFuture<T> fut=new AsyncOpRetryFuture<>(op,retries,opCtx);
      fut.execute();
      return fut;
    }
  }
 else   return asyncOp(tx,op,opCtx);
}
