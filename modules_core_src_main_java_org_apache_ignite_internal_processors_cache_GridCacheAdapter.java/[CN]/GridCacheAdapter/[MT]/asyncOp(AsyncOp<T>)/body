{
  try {
    checkJta();
  }
 catch (  IgniteCheckedException e) {
    return new GridFinishedFuture<>(e);
  }
  if (log.isDebugEnabled())   log.debug("Performing async op: " + op);
  IgniteTxLocalAdapter tx=ctx.tm().threadLocalTx(ctx);
  if (tx == null || tx.implicit()) {
    tx=ctx.tm().newTx(true,op.single(),ctx.system() ? ctx : null,OPTIMISTIC,READ_COMMITTED,ctx.kernalContext().config().getTransactionConfiguration().getDefaultTxTimeout(),ctx.hasFlag(INVALIDATE),!ctx.hasFlag(SKIP_STORE),0,null,false);
    if (ctx.hasFlag(SYNC_COMMIT))     tx.syncCommit(true);
  }
  return asyncOp(tx,op);
}
