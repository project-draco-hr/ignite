{
  if (fileInfo.affinityKey() != null)   return new GridGgfsBlockKey(fileInfo.id(),fileInfo.affinityKey(),fileInfo.evictExclude(),blockIdx);
  if (fileInfo.fileMap() != null) {
    GridUuid affKey=fileInfo.fileMap().affinityKey(blockIdx * fileInfo.blockSize(),false);
    return new GridGgfsBlockKey(fileInfo.id(),affKey,fileInfo.evictExclude(),blockIdx);
  }
  return new GridGgfsBlockKey(fileInfo.id(),null,fileInfo.evictExclude(),blockIdx);
}
