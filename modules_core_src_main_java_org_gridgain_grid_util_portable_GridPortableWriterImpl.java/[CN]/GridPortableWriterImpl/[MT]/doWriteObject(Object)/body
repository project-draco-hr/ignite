{
  if (obj == null)   doWriteByte(NULL);
 else {
    int handle=wCtx.handle(obj);
    if (handle >= 0) {
      doWriteByte(HANDLE);
      doWriteInt(handle);
    }
 else {
      GridPortableWriterImpl writer=new GridPortableWriterImpl(ctx,wCtx);
      writer.marshal(obj);
    }
  }
}
