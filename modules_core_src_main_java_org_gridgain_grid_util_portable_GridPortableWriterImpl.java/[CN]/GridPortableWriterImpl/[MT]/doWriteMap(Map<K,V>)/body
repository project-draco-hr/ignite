{
  doWriteInt(map != null ? map.size() : -1);
  if (map != null) {
    doWriteByte(ctx.mapType(map.getClass()));
    for (    Map.Entry<K,V> e : map.entrySet()) {
      doWriteObject(e.getKey());
      doWriteObject(e.getValue());
    }
  }
}
