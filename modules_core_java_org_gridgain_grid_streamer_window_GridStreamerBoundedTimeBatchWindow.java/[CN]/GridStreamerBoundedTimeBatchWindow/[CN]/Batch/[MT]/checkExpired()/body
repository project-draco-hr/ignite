{
  if (U.currentTimeMillis() > batchEndTs) {
    writeLock().lock();
    try {
      finished=true;
      return true;
    }
  finally {
      writeLock().unlock();
    }
  }
  return false;
}
