{
  try {
    serverNodesCount=3;
    clientNodesCount=1;
    startServerNodes();
    client=true;
    Ignite client=startGrid(serverNodesCount);
    checkTopology(gridCount());
    awaitPartitionMapExchange();
    super.beforeTest();
    IgniteCache<Integer,Integer> cache=client.cache(null);
    performSimpleOperationsOnCache(cache);
    stopServerNodes();
    startServerNodes();
    checkTopology(gridCount());
    awaitPartitionMapExchange();
    super.beforeTest();
    performSimpleOperationsOnCache(cache);
  }
  finally {
    afterTestsStopped();
  }
}
