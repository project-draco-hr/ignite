{
  Map<GridHadoopInputSplit,Integer> res=new HashMap<>();
  int taskNum=0;
  for (  UUID nodeId : plan.mapperNodeIds()) {
    for (    GridHadoopInputSplit split : plan.mappers(nodeId)) {
      if (res.put(split,taskNum++) != null)       throw new IllegalStateException("Split duplicate.");
    }
  }
  return res;
}
