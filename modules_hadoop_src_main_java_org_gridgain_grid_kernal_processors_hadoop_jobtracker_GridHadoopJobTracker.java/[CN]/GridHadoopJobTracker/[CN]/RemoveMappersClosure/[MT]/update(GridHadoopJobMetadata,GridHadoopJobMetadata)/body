{
  Collection<GridHadoopInputSplit> splitsCp=new HashSet<>(cp.pendingSplits());
  splitsCp.removeAll(splits);
  cp.pendingSplits(splitsCp);
  if (cp.phase() != PHASE_CANCELLING && err != null)   cp.failCause(err);
  if (err != null)   cp.phase(PHASE_CANCELLING);
  if (splitsCp.isEmpty()) {
    if (cp.phase() != PHASE_CANCELLING) {
      cp.phase(PHASE_REDUCE);
      cp.mapCompleteTimestamp(System.currentTimeMillis());
    }
  }
}
