{
  Map<GridHadoopInputSplit,Integer> splitsCp=new HashMap<>(cp.pendingSplits());
  for (  GridHadoopInputSplit s : splits)   splitsCp.remove(s);
  cp.pendingSplits(splitsCp);
  if (cp.phase() != PHASE_CANCELLING && err != null)   cp.failCause(err);
  if (err != null)   cp.phase(PHASE_CANCELLING);
  if (splitsCp.isEmpty()) {
    if (cp.phase() != PHASE_CANCELLING)     cp.phase(PHASE_REDUCE);
  }
}
