{
  IgniteConfiguration cfg=super.getConfiguration(gridName);
  PortableMarshaller marsh=new PortableMarshaller();
  marsh.setClassNames(Arrays.asList(TestObject1.class.getName(),TestObject2.class.getName()));
  PortableTypeConfiguration typeCfg=new PortableTypeConfiguration();
  typeCfg.setClassName(TestObject1.class.getName());
  typeCfg.setAffinityKeyFieldName("val2");
  marsh.setTypeConfigurations(Arrays.asList(typeCfg));
  if (gridName.equals(getTestGridName(gridCount() - 1)))   cfg.setClientMode(true);
  cfg.setMarshaller(marsh);
  ((TcpDiscoverySpi)cfg.getDiscoverySpi()).setForceServerMode(true);
  return cfg;
}
