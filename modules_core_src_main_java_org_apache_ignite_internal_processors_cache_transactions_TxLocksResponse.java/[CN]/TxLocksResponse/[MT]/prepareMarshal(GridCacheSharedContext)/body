{
  super.prepareMarshal(ctx);
  if (nearTxKeyLocks != null && !nearTxKeyLocks.isEmpty()) {
    int len=nearTxKeyLocks.size();
    nearTxKeysArr=new IgniteTxKey[len];
    locksArr=new TxLockList[len];
    int i=0;
    for (    Map.Entry<IgniteTxKey,TxLockList> entry : nearTxKeyLocks.entrySet()) {
      IgniteTxKey key=entry.getKey();
      key.prepareMarshal(ctx.cacheContext(key.cacheId()));
      nearTxKeysArr[i]=key;
      locksArr[i]=entry.getValue();
      i++;
    }
  }
  if (txKeys != null && !txKeys.isEmpty()) {
    txKeysArr=new IgniteTxKey[txKeys.size()];
    int i=0;
    for (    IgniteTxKey key : txKeys) {
      key.prepareMarshal(ctx.cacheContext(key.cacheId()));
      txKeysArr[i++]=key;
    }
  }
}
