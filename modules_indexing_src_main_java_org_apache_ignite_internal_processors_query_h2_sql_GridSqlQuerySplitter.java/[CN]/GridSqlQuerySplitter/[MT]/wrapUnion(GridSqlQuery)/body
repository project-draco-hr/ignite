{
  if (qry instanceof GridSqlSelect)   return (GridSqlSelect)qry;
  GridSqlSelect wrapQry=new GridSqlSelect().from(new GridSqlSubquery(qry));
  wrapQry.explain(qry.explain());
  qry.explain(false);
  GridSqlSelect left=leftest(qry);
  int c=0;
  for (  GridSqlElement expr : left.columns(true)) {
    GridSqlType type=expr.resultType();
    String colName;
    if (expr instanceof GridSqlAlias)     colName=((GridSqlAlias)expr).alias();
 else     if (expr instanceof GridSqlColumn)     colName=((GridSqlColumn)expr).columnName();
 else {
      colName=columnName(c);
      expr=alias(colName,expr);
      left.setColumn(c,expr);
    }
    GridSqlColumn col=column(colName);
    col.resultType(type);
    wrapQry.addColumn(col,true);
    c++;
  }
  if (!qry.sort().isEmpty()) {
    for (    GridSqlSortColumn col : qry.sort())     wrapQry.addSort(col);
  }
  return wrapQry;
}
