{
  GridSqlElement el=mapSelect.get(idx);
  GridSqlAlias alias=null;
  boolean aggregateFound=false;
  if (el instanceof GridSqlAlias) {
    alias=(GridSqlAlias)el;
    el=alias.child();
  }
  if (!collocated && hasAggregates(el)) {
    aggregateFound=true;
    if (alias == null)     alias=alias(columnName(idx),el);
    splitAggregates(alias,0,mapSelect,idx,true);
    if (idx < rdcSelect.length)     rdcSelect[idx]=alias;
  }
 else {
    String mapColAlias=columnName(idx);
    String rdcColAlias;
    if (alias == null)     rdcColAlias=el instanceof GridSqlColumn ? ((GridSqlColumn)el).columnName() : mapColAlias;
 else     rdcColAlias=alias.alias();
    mapSelect.set(idx,alias(mapColAlias,el));
    if (idx < rdcSelect.length) {
      GridSqlElement rdcEl=column(mapColAlias);
      if (colNames.add(rdcColAlias))       rdcEl=alias(rdcColAlias,rdcEl);
      rdcSelect[idx]=rdcEl;
    }
  }
  return aggregateFound;
}
