{
  if (qry instanceof GridSqlUnion) {
    GridSqlUnion union=(GridSqlUnion)qry;
    collectAllSpaces(union.left(),schemas);
    collectAllSpaces(union.right(),schemas);
  }
 else {
    GridSqlSelect select=(GridSqlSelect)qry;
    collectAllSpacesInFrom(select.from(),schemas);
    for (    GridSqlElement el : select.columns(false))     collectAllSpacesInSubqueries(el,schemas);
    collectAllSpacesInSubqueries(select.where(),schemas);
  }
  return qry;
}
