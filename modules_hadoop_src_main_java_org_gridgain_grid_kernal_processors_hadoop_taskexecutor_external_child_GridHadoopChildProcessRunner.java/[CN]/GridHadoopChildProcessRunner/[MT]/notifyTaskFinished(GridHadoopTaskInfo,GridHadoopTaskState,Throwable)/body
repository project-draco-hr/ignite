{
  try {
    if (log.isDebugEnabled())     log.debug("Hadoop task execution finished, sending notification to parent node [taskInfo=" + taskInfo + ", state="+ state+ ", err="+ err+ ']');
    comm.sendMessage(nodeDesc,new GridHadoopTaskFinishedMessage(taskInfo,state,err));
    if (taskInfo.type() == GridHadoopTaskType.MAP) {
      int mappers=pendingMappers.decrementAndGet();
      if (mappers == 0) {
        if (log.isDebugEnabled())         log.debug("All local mappers have finished execution.");
        if (job.hasCombiner()) {
          if (log.isDebugEnabled())           log.debug("Starting combiner task.");
          GridHadoopTask c=job.createTask(new GridHadoopTaskInfo(comm.localProcessDescriptor().parentNodeId(),GridHadoopTaskType.COMBINE,job.id(),0,0,null));
          reducerExecSvc.submit(new TaskRunnable(taskContext(c.info()),c));
        }
      }
    }
    checkFinished();
  }
 catch (  GridException e) {
    log.warning("Failed to send task finish notification to parent node (will abort process execution).",e);
    shutdown();
    terminate();
  }
}
