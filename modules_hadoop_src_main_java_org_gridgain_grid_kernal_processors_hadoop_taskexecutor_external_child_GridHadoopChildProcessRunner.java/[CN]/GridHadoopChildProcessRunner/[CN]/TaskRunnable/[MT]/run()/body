{
  execStartTs=System.currentTimeMillis();
  ClassLoader old=Thread.currentThread().getContextClassLoader();
  Thread.currentThread().setContextClassLoader(sharedTaskCtx.jobClassLoader());
  ((GridHadoopDefaultJobInfo)job.info()).configuration().setClassLoader(sharedTaskCtx.jobClassLoader());
  GridHadoopTaskState state=GridHadoopTaskState.COMPLETED;
  Throwable err=null;
  try (GridHadoopTaskOutput out=createOutput(info);GridHadoopTaskInput in=createInput(info)){
    GridHadoopTaskContext ctx=new GridHadoopTaskContext(job,in,out);
    GridHadoopTask task=job.createTask(info);
    task.run(ctx);
  }
 catch (  Throwable e) {
    state=GridHadoopTaskState.FAILED;
    err=e;
  }
 finally {
    execEndTs=System.currentTimeMillis();
    onTaskFinished(this,state,err);
    Thread.currentThread().setContextClassLoader(old);
  }
}
