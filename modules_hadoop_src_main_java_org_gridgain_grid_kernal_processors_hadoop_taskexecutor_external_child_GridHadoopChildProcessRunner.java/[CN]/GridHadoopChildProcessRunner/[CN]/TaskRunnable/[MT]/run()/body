{
  GridHadoopTaskState state=GridHadoopTaskState.COMPLETED;
  Throwable err=null;
  try (GridHadoopTaskOutput out=createOutput(task.info());GridHadoopTaskInput in=createInput(task.info())){
    GridHadoopTaskContext ctx=new GridHadoopTaskContext(null,job,in,out);
    task.run(ctx);
  }
 catch (  Throwable e) {
    state=GridHadoopTaskState.FAILED;
    err=e;
  }
 finally {
    onTaskFinished(task.info(),state,err);
  }
}
