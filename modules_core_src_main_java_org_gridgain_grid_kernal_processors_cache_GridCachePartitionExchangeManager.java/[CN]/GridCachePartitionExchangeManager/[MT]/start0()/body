{
  super.start0();
  cctx.gridEvents().addLocalEventListener(discoLsnr,EVT_NODE_JOINED,EVT_NODE_LEFT,EVT_NODE_FAILED);
  cctx.io().addHandler(0,GridDhtPartitionsSingleMessage.class,new MessageHandler<GridDhtPartitionsSingleMessage<K,V>>(){
    @Override public void onMessage(    GridNode node,    GridDhtPartitionsSingleMessage<K,V> msg){
      processSinglePartitionUpdate(node,msg);
    }
  }
);
  cctx.io().addHandler(0,GridDhtPartitionsFullMessage.class,new MessageHandler<GridDhtPartitionsFullMessage<K,V>>(){
    @Override public void onMessage(    GridNode node,    GridDhtPartitionsFullMessage<K,V> msg){
      processFullPartitionUpdate(node,msg);
    }
  }
);
  cctx.io().addHandler(0,GridDhtPartitionsSingleRequest.class,new MessageHandler<GridDhtPartitionsSingleRequest<K,V>>(){
    @Override public void onMessage(    GridNode node,    GridDhtPartitionsSingleRequest<K,V> msg){
      processSinglePartitionRequest(node,msg);
    }
  }
);
}
