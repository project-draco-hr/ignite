{
  if (!enterBusy())   return;
  try {
    if (msg.exchangeId() == null) {
      if (log.isDebugEnabled())       log.debug("Received full partition update [node=" + node.id() + ", msg="+ msg+ ']');
      boolean updated=false;
      for (      GridCacheContext<K,V> cacheCtx : cctx.cacheContexts()) {
        if (!cacheCtx.isLocal()) {
          GridDhtPartitionTopology<K,V> top=cacheCtx.topology();
          GridDhtPartitionFullMap partMap=msg.partitions().get(cacheCtx.cacheId());
          updated|=top.update(null,partMap) != null;
        }
      }
      if (updated)       refreshPartitions();
    }
 else     exchangeFuture(msg.exchangeId(),null).onReceive(node.id(),msg);
  }
  finally {
    leaveBusy();
  }
}
