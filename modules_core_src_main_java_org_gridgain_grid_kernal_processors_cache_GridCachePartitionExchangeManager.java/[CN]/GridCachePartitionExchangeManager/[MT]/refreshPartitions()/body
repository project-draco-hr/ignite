{
  GridNode oldest=CU.oldest(cctx);
  if (log.isDebugEnabled())   log.debug("Refreshing partitions [oldest=" + oldest.id() + ", loc="+ cctx.localNodeId()+ ']');
  Collection<GridNode> rmts=null;
  try {
    if (oldest.id().equals(cctx.localNodeId())) {
      rmts=CU.remoteNodes(cctx);
      if (log.isDebugEnabled())       log.debug("Refreshing partitions from oldest node: " + cctx.localNodeId());
      sendAllPartitions(rmts);
    }
 else {
      if (log.isDebugEnabled())       log.debug("Refreshing local partitions from non-oldest node: " + cctx.localNodeId());
      sendLocalPartitions(oldest,null);
    }
  }
 catch (  GridException e) {
    U.error(log,"Failed to refresh partition map [oldest=" + oldest.id() + ", rmts="+ U.nodeIds(rmts)+ ", loc="+ cctx.localNodeId()+ ']',e);
  }
}
