{
  if (!enterBusy())   return;
  try {
    if (msg.exchangeId() == null) {
      if (log.isDebugEnabled())       log.debug("Received local partition update [nodeId=" + node.id() + ", parts="+ msg+ ']');
      boolean updated=false;
      for (      GridCacheContext<K,V> cacheCtx : cctx.cacheContexts()) {
        if (!cacheCtx.isLocal()) {
          GridDhtPartitionTopology<K,V> top=cacheCtx.topology();
          GridDhtPartitionMap parts=msg.partitions().get(cacheCtx.cacheId());
          if (parts != null)           updated|=top.update(null,parts) != null;
        }
      }
      if (updated)       scheduleResendPartitions();
    }
 else     exchangeFuture(msg.exchangeId(),null).onReceive(node.id(),msg);
  }
  finally {
    leaveBusy();
  }
}
