{
  JobConf cfg=ctx.getJobConf();
  Thread.currentThread().setContextClassLoader(cfg.getClassLoader());
  try {
    cfg.set(HadoopFileSystemsUtils.LOC_FS_WORK_DIR_PROP,dir.getAbsolutePath());
    if (!cfg.getBoolean("fs.file.impl.disable.cache",false))     FileSystem.getLocal(cfg).setWorkingDirectory(new Path(dir.getAbsolutePath()));
  }
  finally {
    Thread.currentThread().setContextClassLoader(null);
  }
}
