{
  stopped=true;
  if (consumer != null)   consumer.shutdown();
  if (executor != null) {
    executor.shutdown();
    try {
      if (!executor.awaitTermination(5000,TimeUnit.MILLISECONDS))       if (log.isDebugEnabled())       log.debug("Timed out waiting for consumer threads to shut down, exiting uncleanly.");
    }
 catch (    InterruptedException e) {
      if (log.isDebugEnabled())       log.debug("Interrupted during shutdown, exiting uncleanly.");
    }
  }
}
