{
  long now=U.currentTimeMillis();
  GridCacheVersion obsoleteVer=null;
  for (int size=pendingEntries.sizex(); size > 0; size--) {
    EntryWrapper e=pendingEntries.firstx();
    if (e == null || e.expireTime > now)     return;
    if (pendingEntries.remove(e)) {
      if (obsoleteVer == null)       obsoleteVer=cctx.versions().next();
      if (log.isTraceEnabled())       log.trace("Trying to remove expired entry from cache: " + e);
      GridCacheEntryEx entry=e.entry;
      boolean touch=false;
      while (true) {
        try {
          if (entry.onTtlExpired(obsoleteVer))           touch=false;
          break;
        }
 catch (        GridCacheEntryRemovedException e0) {
          entry=entry.context().cache().entryEx(entry.key());
          touch=true;
        }
      }
      if (touch)       entry.context().evicts().touch(entry,null);
    }
  }
}
