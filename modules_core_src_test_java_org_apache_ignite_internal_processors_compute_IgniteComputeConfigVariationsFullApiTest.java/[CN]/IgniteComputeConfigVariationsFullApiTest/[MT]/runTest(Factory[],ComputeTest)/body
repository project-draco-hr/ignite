{
  runInAllDataModes(new TestRunnable(){
    @Override public void run() throws Exception {
      for (int i=0; i < factories.length; i++) {
        Factory factory=factories[i];
        info("Running test with jobs model: " + factory.create().getClass().getSimpleName());
        if (i != 0)         beforeTest();
        try {
          test.test(factory,grid(testedNodeIdx));
        }
  finally {
          if (i + 1 != factories.length)           afterTest();
        }
      }
    }
  }
);
}
