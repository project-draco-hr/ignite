{
  IgniteNamedInstance grid=name != null ? grids.get(name) : dfltGrid;
  if (grid != null) {
    IgniteState state=grid.state();
    if (state == STARTED)     grid.stop(cancel);
    boolean fireEvt;
    if (name != null)     fireEvt=grids.remove(name,grid);
 else {
synchronized (dfltGridMux) {
        fireEvt=dfltGrid == grid;
        if (fireEvt)         dfltGrid=null;
      }
    }
    if (state == STARTED) {
      if (fireEvt)       notifyStateChange(grid.getName(),grid.state());
      return true;
    }
 else {
      U.warn(null,"Ignoring stopping grid instance (has not been in STARTED state): [grid=" + name + ", state="+ state+ ']');
      return false;
    }
  }
  U.warn(null,"Ignoring stopping grid instance that was already stopped or never started: " + name);
  return false;
}
