{
  GridConfiguration cfg=super.getConfiguration(gridName);
  GridTcpDiscoverySpi spi=new GridTcpDiscoverySpi();
  spi.setIpFinder(IP_FINDER);
  cfg.setDiscoverySpi(spi);
  cfg.setIncludeProperties();
  cfg.setIncludeEventTypes(EVT_TASK_FAILED,EVT_TASK_FINISHED,EVT_JOB_MAPPED);
  cfg.setRestEnabled(false);
  cfg.setPeerClassLoadingEnabled(true);
  if (useCache) {
    GridCacheConfiguration cc=defaultCacheConfiguration();
    cc.setCacheMode(PARTITIONED);
    cc.setDistributionMode(PARTITIONED_ONLY);
    cc.setWriteSynchronizationMode(FULL_SYNC);
    cc.setStartSize(ENTRY_CNT / GRID_CNT);
    cc.setSwapEnabled(false);
    cc.setBackups(1);
    cc.setStoreValueBytes(true);
    cfg.setCacheSanityCheckEnabled(false);
    cfg.setCacheConfiguration(cc);
  }
 else   cfg.setCacheConfiguration();
  return cfg;
}
