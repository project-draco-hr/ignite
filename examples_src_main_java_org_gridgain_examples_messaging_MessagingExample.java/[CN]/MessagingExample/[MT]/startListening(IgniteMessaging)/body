{
  msg.remoteListen(TOPIC.ORDERED,new IgniteBiPredicate<UUID,String>(){
    @IgniteInstanceResource private Ignite g;
    @Override public boolean apply(    UUID nodeId,    String msg){
      System.out.println("Received ordered message [msg=" + msg + ", fromNodeId="+ nodeId+ ']');
      try {
        g.message(g.cluster().forNodeId(nodeId)).send(TOPIC.ORDERED,msg);
      }
 catch (      GridException e) {
        e.printStackTrace();
      }
      return true;
    }
  }
);
  msg.remoteListen(TOPIC.UNORDERED,new IgniteBiPredicate<UUID,String>(){
    @IgniteInstanceResource private Ignite g;
    @Override public boolean apply(    UUID nodeId,    String msg){
      System.out.println("Received unordered message [msg=" + msg + ", fromNodeId="+ nodeId+ ']');
      try {
        g.message(g.cluster().forNodeId(nodeId)).send(TOPIC.UNORDERED,msg);
      }
 catch (      GridException e) {
        e.printStackTrace();
      }
      return true;
    }
  }
);
}
