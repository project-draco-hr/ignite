{
  CacheQuery<List<?>> qry=((IgniteKernal)grid(0)).getCache(null).context().queries().createSqlFieldsQuery("select age from Person",false);
  Collection<IgniteBiTuple<Integer,Integer>> res=qry.execute(new AverageRemoteReducer()).get();
  assertEquals("Average",33,F.reduce(res,new AverageLocalReducer()).intValue());
}
