{
  SqlFieldsQuery qry=new SqlFieldsQuery("select age from Person");
  Collection<List<?>> res=grid(0).cache(null).query(qry).getAll();
  IgniteBiTuple<Integer,Integer> redRes=F.reduce(res,new AverageRemoteReducer());
  assertEquals("Average",33,F.reduce(Collections.singleton(redRes),new AverageLocalReducer()).intValue());
}
