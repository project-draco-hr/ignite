{
  UUID affinityKey=primaryKeyForCache(grid(0));
  final IgniteCache<CacheAffinityKey<String>,String> cache=grid(0).jcache(null);
  try (IgniteTx ignored=grid(0).transactions().txStartAffinity(null,affinityKey,concurrency,READ_COMMITTED,0,1)){
    cache.put(new CacheAffinityKey<>("key1",UUID.randomUUID()),"val1");
    fail("Exception should be thrown");
  }
 catch (  CacheException ignored) {
  }
  assertNull(grid(0).transactions().tx());
}
