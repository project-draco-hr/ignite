{
  ensureOpen();
  GridLuceneFile file=newRAMFile();
  GridLuceneFile existing=fileMap.remove(name);
  if (existing != null) {
    sizeInBytes.addAndGet(-existing.getSizeInBytes());
    existing.delete();
  }
  fileMap.put(name,file);
  return new GridLuceneOutputStream(file);
}
