{
  while (true) {
    int cur=get();
    if (p.apply(cur)) {
      if (compareAndSet(cur,update))       return true;
    }
 else     return false;
  }
}
