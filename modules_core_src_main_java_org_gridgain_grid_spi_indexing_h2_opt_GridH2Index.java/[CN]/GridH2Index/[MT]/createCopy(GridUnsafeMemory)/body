{
  IndexColumn[] cols=getIndexColumns();
  if (!getIndexType().isUnique())   cols=Arrays.copyOf(cols,cols.length - 1);
  GridH2Index idx=new GridH2Index(getName(),(GridH2Table)getTable(),getIndexType().isUnique(),keyCol,valCol,memory,cols);
  Thread thread=Thread.currentThread();
  long i=0;
  for (  GridH2Row row : tree.values()) {
    if (++i % 1000 == 0 && thread.isInterrupted())     throw new InterruptedException();
    idx.tree.put(row,row);
  }
  return idx;
}
