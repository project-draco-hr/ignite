{
  if (!F.eq(ctx.gridName(),req.gridName()))   throw new GridException("Failed to perform handshake because actual Grid name differs from expected " + "[expected=" + req.gridName() + ", actual="+ ctx.gridName()+ ']');
  if (!F.eq(ggfs.name(),req.ggfsName()))   throw new GridException("Failed to perform handshake because actual GGFS name differs from expected " + "[expected=" + req.ggfsName() + ", actual="+ ggfs.name()+ ']');
  GridGgfsControlResponse res=new GridGgfsControlResponse();
  ggfs.clientLogDirectory(req.logDirectory());
  GridGgfsHandshakeResponse handshake=new GridGgfsHandshakeResponse(ggfs.name(),ggfs.proxyPaths(),ggfs.groupBlockSize(),ggfs.globalSampling());
  res.handshake(handshake);
  return res;
}
