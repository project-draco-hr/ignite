{
  SSLEngineResult res;
  do {
    res=sslEngine.unwrap(inNetBuf,appBuf);
    if (log.isDebugEnabled())     log.debug("Unwrapped raw data [status=" + res.getStatus() + ", handshakeStatus="+ res.getHandshakeStatus()+ ", ses="+ ses+ ']');
  }
 while (res.getStatus() == Status.OK && (handshakeFinished && res.getHandshakeStatus() == NOT_HANDSHAKING || res.getHandshakeStatus() == NEED_UNWRAP));
  return res;
}
