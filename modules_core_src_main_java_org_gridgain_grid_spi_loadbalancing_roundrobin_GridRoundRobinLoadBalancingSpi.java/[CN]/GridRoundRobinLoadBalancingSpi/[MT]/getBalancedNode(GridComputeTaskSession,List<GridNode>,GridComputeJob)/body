{
  A.notNull(ses,"ses",top,"top");
  if (isPerTask) {
    GridRoundRobinPerTaskLoadBalancer taskBalancer=perTaskBalancers.get(ses.getId());
    if (taskBalancer == null)     perTaskBalancers.put(ses.getId(),taskBalancer=new GridRoundRobinPerTaskLoadBalancer());
    return taskBalancer.getBalancedNode(top);
  }
  return balancer.getBalancedNode(top);
}
