{
  IgniteConfiguration cfg=super.getConfiguration(gridName);
  GridTcpDiscoverySpi discoSpi=new GridTcpDiscoverySpi();
  discoSpi.setIpFinder(ipFinder);
  cfg.setDiscoverySpi(discoSpi);
  cfg.setLocalHost("127.0.0.1");
  if (flag)   cfg.setMarshaller(new IgniteJdkMarshaller());
 else   cfg.setMarshaller(sameMarsh ? new IgniteJdkMarshaller() : new GridOptimizedMarshaller());
  flag=!flag;
  return cfg;
}
