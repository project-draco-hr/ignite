{
  final AtomicBoolean finished=new AtomicBoolean();
  IgniteAtomicLong atomic=ignite(0).atomicLong("TestAtomic",0,true);
  IgniteInternalFuture<Object> fut=GridTestUtils.runAsync(new Callable<Object>(){
    @Override public Object call() throws Exception {
      while (!finished.get()) {
        stopGrid(3);
        U.sleep(300);
        startGrid(3);
      }
      return null;
    }
  }
);
  int keysCnt=keysCount();
  try {
    for (int i=0; i < keysCnt; i++)     atomic.incrementAndGet();
    finished.set(true);
    fut.get();
  }
  finally {
    finished.set(true);
  }
}
