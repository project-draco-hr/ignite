{
  GridCacheMode cacheMode=cctx.config().getCacheMode();
switch (cacheMode) {
case LOCAL:
    if (prj != null)     U.warn(log,"Ignoring query projection because it's executed over LOCAL cache " + "(only local node will be queried): " + this);
  return Collections.singletonList(cctx.localNode());
case REPLICATED:
if (prj != null || !incBackups) return nodes(cctx,prj);
GridCacheDistributionMode mode=cctx.config().getDistributionMode();
return mode == PARTITIONED_ONLY || mode == NEAR_PARTITIONED ? Collections.singletonList(cctx.localNode()) : Collections.singletonList(F.rand(nodes(cctx,null)));
case PARTITIONED:
return nodes(cctx,prj);
default :
throw new IllegalStateException("Unknown cache distribution mode: " + cacheMode);
}
}
