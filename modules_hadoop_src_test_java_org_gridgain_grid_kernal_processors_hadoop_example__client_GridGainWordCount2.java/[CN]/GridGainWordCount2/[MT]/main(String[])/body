{
  try {
    Grid grid=G.start(gridConfiguration());
    GridGgfs ggfs=grid.ggfs("ggfs");
    ggfs.mkdirs(new GridGgfsPath("/input"));
    try (BufferedWriter bw=new BufferedWriter(new OutputStreamWriter(ggfs.create(new GridGgfsPath("/input/test.file"),true)))){
      bw.write("Hello, world!");
    }
     Job job=getJob("/input","/output");
    job.waitForCompletion(true);
    job.getCluster().close();
    for (    GridGgfsPath path : ggfs.listPaths(new GridGgfsPath("/output"))) {
      System.out.println(path);
      try (BufferedReader br=new BufferedReader(new InputStreamReader(ggfs.open(path)))){
        String line=br.readLine();
        while (line != null) {
          System.out.println(line);
          line=br.readLine();
        }
      }
       System.out.println("");
    }
  }
  finally {
    G.stopAll(true);
  }
}
