{
  super.prepareMarshal(ctx);
  if (ownedVals != null) {
    ownedValKeys=ownedVals.keySet();
    ownedValVals=ownedVals.values();
    for (    IgniteTxKey key : ownedVals.keySet()) {
      GridCacheContext cacheCtx=ctx.cacheContext(key.cacheId());
      OwnedValue value=ownedVals.get(key);
      key.prepareMarshal(cacheCtx);
      value.prepareMarshal(cacheCtx.cacheObjectContext());
    }
  }
  if (retValBytes == null && retVal != null)   retValBytes=ctx.marshaller().marshal(retVal);
  if (filterFailedKeys != null) {
    for (    IgniteTxKey key : filterFailedKeys) {
      GridCacheContext cctx=ctx.cacheContext(key.cacheId());
      key.prepareMarshal(cctx);
    }
  }
}
