{
  GridGgfsPath curPath=parentPath == null ? new GridGgfsPath() : new GridGgfsPath(parentPath,desc.fileName);
  if (desc.isFile) {
    deleteFile(curPath,desc,true);
    return true;
  }
 else {
    if (recursive) {
      meta.softDelete(desc.parentId,desc.fileName,desc.fileId);
      return true;
    }
 else {
      Map<String,GridGgfsListingEntry> infoMap=meta.directoryListing(desc.fileId);
      if (F.isEmpty(infoMap)) {
        deleteFile(curPath,desc,true);
        return true;
      }
 else       throw new GridGgfsDirectoryNotEmptyException("Failed to remove directory (directory is not empty " + "and recursive flag is not set)");
    }
  }
}
