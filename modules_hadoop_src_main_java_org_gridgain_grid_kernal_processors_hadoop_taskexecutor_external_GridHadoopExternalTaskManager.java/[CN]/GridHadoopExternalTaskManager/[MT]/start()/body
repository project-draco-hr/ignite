{
  initJavaCommand();
  comm=new GridHadoopExternalCommunication(ctx.localNodeId(),UUID.randomUUID(),ctx.kernalContext().config().getMarshaller(),log,ctx.kernalContext().config().getSystemExecutorService(),ctx.kernalContext().gridName());
  comm.setListener(new MessageListener());
  comm.start();
  nodeDesc=comm.localProcessDescriptor();
  ctx.kernalContext().ports().registerPort(nodeDesc.tcpPort(),GridPortProtocol.TCP,GridHadoopExternalTaskManager.class);
  if (nodeDesc.sharedMemoryPort() != -1)   ctx.kernalContext().ports().registerPort(nodeDesc.sharedMemoryPort(),GridPortProtocol.TCP,GridHadoopExternalTaskManager.class);
}
