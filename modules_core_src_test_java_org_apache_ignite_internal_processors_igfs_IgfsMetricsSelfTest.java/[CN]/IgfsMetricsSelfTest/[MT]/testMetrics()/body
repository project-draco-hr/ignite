{
  IgniteFileSystem fs=igfsPrimary[0];
  assertNotNull(fs);
  IgfsMetrics m=fs.metrics();
  assertNotNull(m);
  assertEquals(0,m.directoriesCount());
  assertEquals(0,m.filesCount());
  assertEquals(0,m.filesOpenedForRead());
  assertEquals(0,m.filesOpenedForWrite());
  fs.mkdirs(new IgfsPath("/dir1"));
  m=fs.metrics();
  assertNotNull(m);
  assertEquals(1,m.directoriesCount());
  assertEquals(0,m.filesCount());
  assertEquals(0,m.filesOpenedForRead());
  assertEquals(0,m.filesOpenedForWrite());
  fs.mkdirs(new IgfsPath("/dir1/dir2/dir3"));
  fs.mkdirs(new IgfsPath("/dir4"));
  m=fs.metrics();
  assertNotNull(m);
  assertEquals(4,m.directoriesCount());
  assertEquals(0,m.filesCount());
  assertEquals(0,m.filesOpenedForRead());
  assertEquals(0,m.filesOpenedForWrite());
  IgfsOutputStream out1=fs.create(new IgfsPath("/dir1/file1"),false);
  IgfsOutputStream out2=fs.create(new IgfsPath("/dir1/file2"),false);
  IgfsOutputStream out3=fs.create(new IgfsPath("/dir1/dir2/file"),false);
  m=fs.metrics();
  assertNotNull(m);
  assertEquals(4,m.directoriesCount());
  assertEquals(3,m.filesCount());
  assertEquals(0,m.filesOpenedForRead());
  assertEquals(3,m.filesOpenedForWrite());
  out1.write(new byte[10]);
  out2.write(new byte[20]);
  out3.write(new byte[30]);
  out1.close();
  m=fs.metrics();
  assertNotNull(m);
  assertEquals(4,m.directoriesCount());
  assertEquals(3,m.filesCount());
  assertEquals(0,m.filesOpenedForRead());
  assertEquals(2,m.filesOpenedForWrite());
  out2.close();
  out3.close();
  m=fs.metrics();
  assertNotNull(m);
  assertEquals(4,m.directoriesCount());
  assertEquals(3,m.filesCount());
  assertEquals(0,m.filesOpenedForRead());
  assertEquals(0,m.filesOpenedForWrite());
  IgfsOutputStream out=fs.append(new IgfsPath("/dir1/file1"),false);
  out.write(new byte[20]);
  m=fs.metrics();
  assertNotNull(m);
  assertEquals(4,m.directoriesCount());
  assertEquals(3,m.filesCount());
  assertEquals(0,m.filesOpenedForRead());
  assertEquals(1,m.filesOpenedForWrite());
  out.write(new byte[20]);
  out.close();
  m=fs.metrics();
  assertNotNull(m);
  assertEquals(4,m.directoriesCount());
  assertEquals(3,m.filesCount());
  assertEquals(0,m.filesOpenedForRead());
  assertEquals(0,m.filesOpenedForWrite());
  IgfsInputStream in1=fs.open(new IgfsPath("/dir1/file1"));
  IgfsInputStream in2=fs.open(new IgfsPath("/dir1/file2"));
  m=fs.metrics();
  assertNotNull(m);
  assertEquals(4,m.directoriesCount());
  assertEquals(3,m.filesCount());
  assertEquals(2,m.filesOpenedForRead());
  assertEquals(0,m.filesOpenedForWrite());
  in1.close();
  in2.close();
  m=fs.metrics();
  assertNotNull(m);
  assertEquals(4,m.directoriesCount());
  assertEquals(3,m.filesCount());
  assertEquals(0,m.filesOpenedForRead());
  assertEquals(0,m.filesOpenedForWrite());
  fs.delete(new IgfsPath("/dir1/file1"),false);
  fs.delete(new IgfsPath("/dir1/dir2"),true);
  m=fs.metrics();
  assertNotNull(m);
  assertEquals(2,m.directoriesCount());
  assertEquals(1,m.filesCount());
  assertEquals(0,m.filesOpenedForRead());
  assertEquals(0,m.filesOpenedForWrite());
  fs.format();
  m=fs.metrics();
  assertNotNull(m);
  assertEquals(0,m.directoriesCount());
  assertEquals(0,m.filesCount());
  assertEquals(0,m.filesOpenedForRead());
  assertEquals(0,m.filesOpenedForWrite());
}
