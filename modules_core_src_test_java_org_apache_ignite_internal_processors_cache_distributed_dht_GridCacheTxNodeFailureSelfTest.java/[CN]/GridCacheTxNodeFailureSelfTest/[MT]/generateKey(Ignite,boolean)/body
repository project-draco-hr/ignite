{
  Affinity<Object> aff=ignite.affinity(null);
  for (int key=0; ; key++) {
    if (backup) {
      if (!aff.isBackup(ignite(0).cluster().localNode(),key))       continue;
    }
 else {
      if (aff.isPrimaryOrBackup(ignite(0).cluster().localNode(),key))       continue;
    }
    if (aff.isPrimary(ignite(1).cluster().localNode(),key))     return key;
  }
}
