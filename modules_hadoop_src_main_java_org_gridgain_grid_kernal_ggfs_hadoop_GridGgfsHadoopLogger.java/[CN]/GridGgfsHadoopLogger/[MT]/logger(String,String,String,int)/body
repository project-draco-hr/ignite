{
  if (endpoint == null)   endpoint="";
  logLock.readLock().lock();
  try {
    GridGgfsHadoopLogger log=loggers.get(endpoint);
    if (log == null) {
      log=new GridGgfsHadoopLogger(endpoint,ggfsName,dir,batchSize);
      GridGgfsHadoopLogger log0=loggers.putIfAbsent(endpoint,log);
      if (log0 != null)       log=log0;
    }
    log.useCnt.incrementAndGet();
    return log;
  }
  finally {
    logLock.readLock().unlock();
  }
}
