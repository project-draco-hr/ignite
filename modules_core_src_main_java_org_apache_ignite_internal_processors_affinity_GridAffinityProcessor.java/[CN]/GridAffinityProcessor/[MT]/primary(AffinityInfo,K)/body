{
  int part=partition(null,key,aff);
  Collection<ClusterNode> nodes=aff.assignment.get(part);
  if (F.isEmpty(nodes))   throw new IgniteCheckedException("Failed to get affinity nodes [aff=" + aff + ", key="+ key+ ']');
  return nodes.iterator().next();
}
