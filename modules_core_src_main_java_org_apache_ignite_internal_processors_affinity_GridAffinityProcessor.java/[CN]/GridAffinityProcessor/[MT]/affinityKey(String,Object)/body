{
  if (key == null)   return null;
  AffinityInfo affInfo=affinityCache(cacheName,ctx.discovery().topologyVersionEx());
  if (affInfo == null || affInfo.mapper == null)   return null;
  if (key instanceof CacheObject)   key=((CacheObject)key).value(affInfo.cacheObjCtx,false);
  return affInfo.mapper.affinityKey(key);
}
