{
  super.start();
  GridHadoopConfiguration cfg=ctx.config().getHadoopConfiguration();
  if (ctx.isDaemon() || cfg == null)   return;
  cfg=new GridHadoopConfiguration(cfg);
  initializeDefaults(cfg);
  validate(cfg);
  hctx=new GridHadoopContext(ctx,cfg,new GridHadoopJobTracker(),new GridHadoopEmbeddedTaskExecutor(),new GridHadoopExternalTaskExecutor(),new GridHadoopShuffler());
  for (  GridHadoopComponent c : hctx.components())   c.start(hctx);
  hadoop=new GridHadoopImpl(this);
  id=ctx.localNodeId();
}
