{
  final boolean locExec=destId == null || destId.equals(ctx.localNodeId()) || replicatedCacheAvailable(cacheName);
  if (locExec) {
    GridCacheProjection<?,?> prj=localCache(cacheName).forSubjectId(clientId).flagsOn(flags);
    if (keepPortable)     prj=prj.keepPortable();
    return op.apply((GridCacheProjection<Object,Object>)prj,ctx).chain(resultWrapper((GridCacheProjection<Object,Object>)prj,key));
  }
 else {
    GridProjection prj=ctx.grid().forPredicate(F.nodeForNodeId(destId));
    GridCompute comp=ctx.grid().compute(prj).withNoFailover().enableAsync();
    comp.call(new FlaggedCacheOperationCallable(clientId,cacheName,flags,op,key,keepPortable));
    return comp.future();
  }
}
