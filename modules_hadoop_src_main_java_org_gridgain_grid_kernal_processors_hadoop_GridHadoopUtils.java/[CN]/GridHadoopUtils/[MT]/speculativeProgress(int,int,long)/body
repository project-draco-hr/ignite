{
  float doubleRatio=(float)maxConcurrentTasks / totalTasks;
  U.debug("Double ratio: " + doubleRatio);
  long doubleInterval=((long)(DOUBLE_INTERVAL_DELTA * doubleRatio) + MIN_DOUBLE_INTERVAL);
  doubleInterval=doubleInterval - doubleInterval % STEP_SPAN;
  U.debug("Double interval: " + doubleInterval);
  long fullDoubles=dur / doubleInterval;
  U.debug("Big updates: " + fullDoubles);
  long partialUpdates=(dur - fullDoubles * doubleInterval) / STEP_SPAN;
  U.debug("Small updates: " + partialUpdates);
  float power2=(float)Math.pow(0.5,fullDoubles);
  float progress=1 - power2 + power2 / 2 * partialUpdates * STEP_SPAN / doubleInterval;
  U.debug("Single progress: " + progress);
  return progress;
}
