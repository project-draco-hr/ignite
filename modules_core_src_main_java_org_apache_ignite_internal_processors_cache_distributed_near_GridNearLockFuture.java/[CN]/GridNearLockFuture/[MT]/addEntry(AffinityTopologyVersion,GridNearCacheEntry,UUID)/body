{
  if (timedOut)   return null;
  GridCacheMvccCandidate c=entry.addNearLocal(dhtNodeId,threadId,lockVer,topVer,timeout,!inTx(),inTx(),implicitSingleTx());
  if (inTx()) {
    IgniteTxEntry txEntry=tx.entry(entry.txKey());
    txEntry.cached(entry);
  }
synchronized (mux) {
    entries.add(entry);
  }
  if (c == null && timeout < 0) {
    if (log.isDebugEnabled())     log.debug("Failed to acquire lock with negative timeout: " + entry);
    onFailed(false);
    return null;
  }
  if (timedOut) {
    entry.removeLock(lockVer);
    return null;
  }
  return c;
}
