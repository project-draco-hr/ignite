{
  checkInternal(key);
  if (isSystemInvalidate())   return null;
  GridDhtCacheEntry<K,V> cached=cctx.dht().entryExx(key,topologyVersion());
  GridCacheTxEntry<K,V> txEntry=new GridCacheTxEntry<>(cctx,this,op,val,0L,-1L,cached,drVer);
  txEntry.keyBytes(keyBytes);
  txEntry.valueBytes(valBytes);
  txEntry.transformClosures(clos);
  writeMap.put(key,txEntry);
  return txEntry;
}
