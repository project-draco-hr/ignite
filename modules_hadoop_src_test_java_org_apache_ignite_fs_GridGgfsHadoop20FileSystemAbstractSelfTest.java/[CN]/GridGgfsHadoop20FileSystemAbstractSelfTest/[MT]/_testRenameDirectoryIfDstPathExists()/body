{
  Path fsHome=new Path(primaryFsUri);
  Path srcDir=new Path(fsHome,"/tmp/");
  Path dstDir=new Path(fsHome,"/tmpNew/");
  FSDataOutputStream os=fs.create(new Path(srcDir,"file1"),EnumSet.noneOf(CreateFlag.class),Options.CreateOpts.perms(FsPermission.getDefault()));
  os.close();
  os=fs.create(new Path(dstDir,"file2"),EnumSet.noneOf(CreateFlag.class),Options.CreateOpts.perms(FsPermission.getDefault()));
  os.close();
  fs.rename(srcDir,dstDir);
  assertPathExists(fs,dstDir);
  assertPathExists(fs,new Path(fsHome,"/tmpNew/tmp"));
  assertPathExists(fs,new Path(fsHome,"/tmpNew/tmp/file1"));
}
