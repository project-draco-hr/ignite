{
  GridHadoopTaskInfo taskInfo=new GridHadoopTaskInfo(null,GridHadoopTaskType.MAP,gridJob.id(),0,0,fileBlock);
  GridHadoopTestTaskContext mapCtx=new GridHadoopTestTaskContext(taskInfo,gridJob);
  mapCtx.run();
  taskInfo=new GridHadoopTaskInfo(null,GridHadoopTaskType.COMBINE,gridJob.id(),0,0,null);
  GridHadoopTestTaskContext combineCtx=new GridHadoopTestTaskContext(taskInfo,gridJob);
  combineCtx.makeTreeOfWritables(mapCtx.mockOutput());
  combineCtx.run();
  return combineCtx;
}
