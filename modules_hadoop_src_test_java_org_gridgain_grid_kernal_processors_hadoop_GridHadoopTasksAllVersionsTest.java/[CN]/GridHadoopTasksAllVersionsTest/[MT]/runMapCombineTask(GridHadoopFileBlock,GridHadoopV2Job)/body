{
  GridHadoopTaskInfo taskInfo=new GridHadoopTaskInfo(null,GridHadoopTaskType.MAP,gridJob.id(),0,0,fileBlock);
  GridHadoopTestTaskContext mapCtx=new GridHadoopTestTaskContext(taskInfo,gridJob,log);
  createAndExecuteTask(gridJob,taskInfo,mapCtx);
  taskInfo=new GridHadoopTaskInfo(null,GridHadoopTaskType.COMBINE,gridJob.id(),0,0,null);
  GridHadoopTestTaskContext combineCtx=new GridHadoopTestTaskContext(taskInfo,gridJob,log);
  combineCtx.makeTreeOfWritables(mapCtx.mockOutput());
  createAndExecuteTask(gridJob,taskInfo,combineCtx);
  return combineCtx;
}
