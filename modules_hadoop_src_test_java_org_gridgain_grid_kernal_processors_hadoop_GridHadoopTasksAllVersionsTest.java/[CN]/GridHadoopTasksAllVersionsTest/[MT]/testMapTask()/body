{
  GridGgfsPath inDir=new GridGgfsPath(PATH_INPUT);
  ggfs.mkdirs(inDir);
  GridGgfsPath inFile=new GridGgfsPath(inDir,GridHadoopWordCount2.class.getSimpleName() + "-input");
  URI inFileUri=URI.create(ggfsScheme() + inFile.toString());
  try (PrintWriter pw=new PrintWriter(ggfs.create(inFile,true))){
    pw.println("hello0 world0");
    pw.println("world1 hello1");
  }
   GridHadoopFileBlock fileBlock1=new GridHadoopFileBlock(HOSTS,inFileUri,0,ggfs.info(inFile).length() - 1);
  try (PrintWriter pw=new PrintWriter(ggfs.append(inFile,false))){
    pw.println("hello2 world2");
    pw.println("world3 hello3");
  }
   GridHadoopFileBlock fileBlock2=new GridHadoopFileBlock(HOSTS,inFileUri,fileBlock1.length(),ggfs.info(inFile).length() - fileBlock1.length());
  GridHadoopJob gridJob=getHadoopJob(ggfsScheme() + inFile.toString(),ggfsScheme() + PATH_OUTPUT);
  GridHadoopTaskInfo taskInfo=new GridHadoopTaskInfo(null,GridHadoopTaskType.MAP,gridJob.id(),0,0,fileBlock1);
  GridHadoopTestTaskContext ctx=new GridHadoopTestTaskContext(taskInfo,gridJob);
  ctx.mockOutput().clear();
  executeTask(gridJob,taskInfo,ctx);
  assertEquals("hello0,1; world0,1; world1,1; hello1,1",Joiner.on("; ").join(ctx.mockOutput()));
  ctx.mockOutput().clear();
  taskInfo=new GridHadoopTaskInfo(null,GridHadoopTaskType.MAP,gridJob.id(),0,0,fileBlock2);
  executeTask(gridJob,taskInfo,ctx);
  assertEquals("hello2,1; world2,1; world3,1; hello3,1",Joiner.on("; ").join(ctx.mockOutput()));
}
