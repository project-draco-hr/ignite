{
  try {
    return ctx.affinity().localNode(key) ? dht().peekEx(key) : near().peekEx(key);
  }
 catch (  GridDhtInvalidPartitionException ignore) {
    return near().peekEx(key);
  }
}
