{
  Class<?> partClsOld=jobConf().getClass("mapred.partitioner.class",null);
  if (partClsOld != null)   return new GridHadoopV1Partitioner(jobConf().getPartitionerClass(),jobConf());
  try {
    return new GridHadoopV2Partitioner(jobCtx.getPartitionerClass(),jobConf());
  }
 catch (  ClassNotFoundException e) {
    throw new IgniteCheckedException(e);
  }
}
