{
  log.debug("Offers resources: {} ",offers.size());
  for (  Protos.Offer offer : offers) {
    Protos.TaskID taskId;
    Protos.TaskInfo task;
    IgniteTask igniteTask;
synchronized (mux) {
      igniteTask=checkOffer(offer);
      if (igniteTask == null) {
        schedulerDriver.declineOffer(offer.getId());
        continue;
      }
      taskId=Protos.TaskID.newBuilder().setValue(Integer.toString(taskIdGenerator.incrementAndGet())).build();
      log.info("Launching task: {}",igniteTask);
      task=createTask(offer,igniteTask,taskId);
    }
    try {
      schedulerDriver.launchTasks(Collections.singletonList(offer.getId()),Collections.singletonList(task),Protos.Filters.newBuilder().setRefuseSeconds(1).build());
    }
 catch (    Exception e) {
      log.error("Failed launch task. Task id: {}. Task info: {}",taskId,task);
    }
synchronized (mux) {
      tasks.put(taskId.getValue(),igniteTask);
    }
  }
}
