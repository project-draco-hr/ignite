{
  GridSecurityPermission op=null;
  String name=null;
switch (req.command()) {
case CACHE_GET:
case CACHE_GET_ALL:
    op=GridSecurityPermission.CACHE_READ;
  name=((GridRestCacheRequest)req).cacheName();
break;
case CACHE_PUT:
case CACHE_ADD:
case CACHE_PUT_ALL:
case CACHE_REPLACE:
case CACHE_INCREMENT:
case CACHE_DECREMENT:
case CACHE_CAS:
case CACHE_APPEND:
case CACHE_PREPEND:
op=GridSecurityPermission.CACHE_PUT;
name=((GridRestCacheRequest)req).cacheName();
break;
case CACHE_REMOVE:
case CACHE_REMOVE_ALL:
op=GridSecurityPermission.CACHE_REMOVE;
name=((GridRestCacheRequest)req).cacheName();
break;
case EXE:
case RESULT:
op=GridSecurityPermission.TASK_EXECUTE;
name=((GridRestTaskRequest)req).taskName();
break;
case VERSION:
case LOG:
case NOOP:
case QUIT:
case CACHE_METRICS:
case TOPOLOGY:
case NODE:
return;
}
if (op != null) ctx.auth().authorize(name,op,securityCtx);
}
