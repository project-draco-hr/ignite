{
  UUID clientId=req.getClientId();
  byte[] clientIdBytes=clientId != null ? U.uuidToBytes(clientId) : EMPTY_ID;
  byte[] sesTok=req.getSessionToken();
  if (sesTok != null && ctx.secureSession().validate(REMOTE_CLIENT,clientIdBytes,sesTok,null) != null)   return;
  if (!ctx.auth().authenticate(REMOTE_CLIENT,clientIdBytes,req.getCredentials()))   if (req.getCredentials() == null)   throw new GridException("Failed to authenticate remote client (secure session SPI not set?): " + req);
 else   throw new GridException("Failed to authenticate remote client (invalid credentials?): " + req);
}
