{
switch (taskCtx.taskInfo().type()) {
case MAP:
    if (needCombinerMap) {
      if (combinerMap == null)       combinerMap=get(job.info(),SHUFFLE_COMBINER_NO_SORTING,false) ? new GridHadoopConcurrentHashMultimap(job,mem,get(job.info(),COMBINER_HASHMAP_SIZE,8 * 1024)) : new GridHadoopSkipList(job,mem,taskCtx.sortComparator());
      return combinerMap.startAdding(taskCtx);
    }
case COMBINE:
  return new PartitionedOutput(taskCtx);
default :
throw new IllegalStateException("Illegal type: " + taskCtx.taskInfo().type());
}
}
