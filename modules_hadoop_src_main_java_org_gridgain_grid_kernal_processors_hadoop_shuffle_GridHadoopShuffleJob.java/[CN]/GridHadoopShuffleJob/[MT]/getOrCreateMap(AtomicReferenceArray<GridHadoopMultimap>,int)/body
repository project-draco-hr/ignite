{
  GridHadoopMultimap map=maps.get(idx);
  if (map == null) {
    map=get(job.info(),SHUFFLE_REDUCER_NO_SORTING,false) ? new GridHadoopConcurrentHashMultimap(job,mem,get(job.info(),PARTITION_HASHMAP_SIZE,8 * 1024)) : new GridHadoopSkipList(job,mem,job.sortComparator());
    if (!maps.compareAndSet(idx,null,map)) {
      map.close();
      return maps.get(idx);
    }
  }
  return map;
}
