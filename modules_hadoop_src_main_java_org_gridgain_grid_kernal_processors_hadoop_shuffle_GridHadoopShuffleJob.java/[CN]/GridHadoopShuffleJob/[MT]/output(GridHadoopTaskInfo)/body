{
switch (taskInfo.type()) {
case MAP:
    if (job.hasCombiner())     return new MapOutput(combinerMap.startAdding());
case COMBINE:
  return new PartitionedOutput();
default :
throw new IllegalStateException("Illegal type: " + taskInfo.type());
}
}
