{
  int part=0;
  if (partitioner != null) {
    part=partitioner.partition(key,val,adders.length);
    if (part < 0 || part >= adders.length)     throw new GridException("Invalid partition: " + part);
  }
  GridHadoopTaskOutput out=adders[part];
  if (out == null)   adders[part]=out=getOrCreateMap(maps,part).startAdding(taskCtx);
  out.write(key,val);
}
