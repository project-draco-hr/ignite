{
  int part=0;
  if (partitioner != null) {
    part=partitioner.partition(key,val,adders.length);
    if (part < 0 || part >= adders.length)     throw new GridException("Invalid partition: " + part);
  }
  GridHadoopMultimap.Adder adder=adders[part];
  if (adder == null)   adders[part]=adder=getOrCreateMap(maps,part).startAdding();
  adder.add(key,val);
}
