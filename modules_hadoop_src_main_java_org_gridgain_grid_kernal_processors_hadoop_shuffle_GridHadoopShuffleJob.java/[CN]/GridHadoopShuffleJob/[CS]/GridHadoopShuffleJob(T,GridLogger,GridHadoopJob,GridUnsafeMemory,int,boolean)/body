{
  this.locReduceAddr=locReduceAddr;
  this.job=job;
  this.mem=mem;
  this.log=log;
  partitioner=reducers > 1 ? job.partitioner() : null;
  maps=new AtomicReferenceArray<>(reducers);
  msgs=new GridHadoopShuffleMessage[reducers];
  if (job.hasCombiner() && hasLocMappers)   combinerMap=new GridHadoopHashMultimap(job,mem,get(job,COMBINER_HASHMAP_SIZE,8 * 1024));
}
