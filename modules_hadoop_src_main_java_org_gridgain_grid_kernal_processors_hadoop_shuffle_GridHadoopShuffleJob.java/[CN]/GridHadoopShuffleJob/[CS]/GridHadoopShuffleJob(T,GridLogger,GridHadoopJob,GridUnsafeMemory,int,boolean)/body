{
  this.locReduceAddr=locReduceAddr;
  this.job=job;
  this.mem=mem;
  this.log=log;
  partitioner=reducers > 1 ? job.partitioner() : null;
  maps=new AtomicReferenceArray<>(reducers);
  msgs=new GridHadoopShuffleMessage[reducers];
  if (job.hasCombiner() && hasLocMappers)   combinerMap=get(job,SHUFFLE_COMBINER_NO_SORTING,false) ? new GridHadoopConcurrentHashMultimap(job,mem,get(job,COMBINER_HASHMAP_SIZE,8 * 1024)) : new GridHadoopSkipList(job,mem,job.sortComparator());
}
