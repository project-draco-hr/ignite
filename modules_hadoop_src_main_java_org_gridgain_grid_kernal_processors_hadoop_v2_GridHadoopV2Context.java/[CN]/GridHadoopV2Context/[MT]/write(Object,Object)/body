{
  if (isCancelled)   throw new GridHadoopTaskCancelledException("Task cancelled.");
  if (writer != null)   writer.write(key,val);
 else {
    try {
      output.write(key,val);
    }
 catch (    GridException e) {
      throw new IOException(e);
    }
  }
}
