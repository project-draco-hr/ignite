{
  for (  Integer key : keys) {
    boolean res=locks[key].tryLock();
    if (res) {
      try {
        c.apply(key,key);
      }
  finally {
        locks[key].unlock();
      }
    }
 else     fail("Failed to acquire lock for key: " + key);
  }
}
