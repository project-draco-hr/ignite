{
  if (log.isDebugEnabled())   log.debug("Processing near atomic update response [nodeId=" + nodeId + ", res="+ res+ ']');
  res.nodeId(ctx.localNodeId());
  GridNearAtomicAbstractUpdateFuture fut=(GridNearAtomicAbstractUpdateFuture)ctx.mvcc().atomicFuture(res.futureVersion());
  if (fut != null) {
    if (fut instanceof GridNearAtomicSingleUpdateFuture)     ((GridNearAtomicSingleUpdateFuture)fut).onResult(nodeId,res,false);
 else     ((GridNearAtomicUpdateFuture)fut).onResult(nodeId,res,false);
  }
 else   U.warn(log,"Failed to find near update future for update response (will ignore) " + "[nodeId=" + nodeId + ", res="+ res+ ']');
}
