{
  GridCacheAffinityFunction affFunc=cacheCtx.config().getAffinity();
  if (!U.hasAnnotation(affFunc,GridCacheCentralizedAffinityFunction.class))   return true;
  Collection<ClusterNode> affNodes=CU.affinityNodes(cacheCtx,exchId.topologyVersion());
  return !exchId.nodeId().equals(cctx.localNodeId()) || (affNodes.size() == 1 && affNodes.contains(cctx.localNode()));
}
