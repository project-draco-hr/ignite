{
  if (meta == null)   writer.writeBoolean(false);
 else {
    writer.writeBoolean(true);
    Map<String,Integer> fields=((BinaryTypeImpl)meta).metadata().fieldsMap();
    writer.writeInt(typeId);
    writer.writeString(meta.typeName());
    writer.writeString(meta.affinityKeyFieldName());
    writer.writeMap(fields);
    writer.writeBoolean(meta.isEnum());
  }
}
