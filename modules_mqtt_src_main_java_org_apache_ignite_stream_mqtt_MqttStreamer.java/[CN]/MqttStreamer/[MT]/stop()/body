{
  if (stopped)   throw new IgniteException("Attempted to stop an already stopped MQTT Streamer");
  connectionRetrier.stop();
  try {
    if (disconnectForcibly) {
      if (disconnectQuiesceTimeout == null && disconnectForciblyTimeout == null)       client.disconnectForcibly();
 else       if (disconnectForciblyTimeout != null && disconnectQuiesceTimeout == null)       client.disconnectForcibly(disconnectForciblyTimeout);
 else       client.disconnectForcibly(disconnectQuiesceTimeout,disconnectForciblyTimeout);
    }
 else {
      if (disconnectQuiesceTimeout == null)       client.disconnect();
 else       client.disconnect(disconnectQuiesceTimeout);
    }
    client.close();
    connected=false;
    stopped=true;
  }
 catch (  Throwable t) {
    throw new IgniteException("Exception while stopping MqttStreamer",t);
  }
}
