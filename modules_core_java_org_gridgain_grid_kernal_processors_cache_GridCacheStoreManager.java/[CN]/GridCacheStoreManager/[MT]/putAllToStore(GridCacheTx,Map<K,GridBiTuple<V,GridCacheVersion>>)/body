{
  if (F.isEmpty(map))   return true;
  if (map.size() == 1) {
    Map.Entry<K,GridBiTuple<V,GridCacheVersion>> e=map.entrySet().iterator().next();
    return putToStore(tx,e.getKey(),e.getValue().get1(),e.getValue().get2());
  }
 else {
    if (store != null) {
      if (log.isDebugEnabled())       log.debug("Storing values in cache store [map=" + map + ']');
      store.putAll(tx,locStore ? map : F.viewReadOnly(map,new C1<GridBiTuple<V,GridCacheVersion>,Object>(){
        @Override public Object apply(        GridBiTuple<V,GridCacheVersion> t){
          return t.get1();
        }
      }
));
      if (log.isDebugEnabled())       log.debug("Stored value in cache store [map=" + map + ']');
      return true;
    }
    return false;
  }
}
