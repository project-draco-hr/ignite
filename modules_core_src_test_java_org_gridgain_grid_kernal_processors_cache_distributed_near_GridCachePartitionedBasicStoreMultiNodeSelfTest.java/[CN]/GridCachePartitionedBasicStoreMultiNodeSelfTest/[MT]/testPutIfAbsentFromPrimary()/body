{
  GridCache<Integer,String> cache=cache(0);
  int key=0;
  while (true) {
    boolean found=false;
    for (    ClusterNode n : grid(0).nodes()) {
      if (cache.affinity().isPrimary(n,key)) {
        found=true;
        break;
      }
    }
    if (found)     break;
  }
  assertNull(cache.putIfAbsent(key,"val"));
  assertEquals(1,store.getLoadCount());
  assertEquals(1,store.getPutCount());
  Collection<GridCacheTx> txs=store.transactions();
  assertEquals(1,txs.size());
}
