{
  A.ensure(batchSize >= 0,"Batch size cannot be negative: " + batchSize);
  try {
    GridBiTuple<Long,Long> t=(GridBiTuple<Long,Long>)cache.transformCompute(queueKey,new ClearClosure(id));
    if (t == null)     return;
    checkRemoved(t.get1());
    removeKeys(t.get1(),t.get2(),batchSize);
  }
 catch (  GridException e) {
    throw new GridRuntimeException(e);
  }
}
