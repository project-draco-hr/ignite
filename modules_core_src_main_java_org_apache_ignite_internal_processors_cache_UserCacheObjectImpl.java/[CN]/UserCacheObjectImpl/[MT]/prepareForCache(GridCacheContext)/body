{
  if (val instanceof byte[]) {
    byte[] byteArr=(byte[])val;
    return new CacheObjectImpl(Arrays.copyOf(byteArr,byteArr.length),null);
  }
 else {
    try {
      if (valBytes == null)       valBytes=CU.marshal(ctx.shared(),val);
      return new CacheObjectImpl(null,valBytes);
    }
 catch (    IgniteCheckedException e) {
      throw new IgniteException("Failed to marshal object: " + val,e);
    }
  }
}
