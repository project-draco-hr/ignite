{
  if (!F.eq(ctx.gridName(),req.gridName()))   throw new IgniteCheckedException("Failed to perform handshake because actual Grid name differs from expected " + "[expected=" + req.gridName() + ", actual="+ ctx.gridName()+ ']');
  if (!F.eq(igfs.name(),req.igfsName()))   throw new IgniteCheckedException("Failed to perform handshake because actual IGFS name differs from expected " + "[expected=" + req.igfsName() + ", actual="+ igfs.name()+ ']');
  IgfsControlResponse res=new IgfsControlResponse();
  igfs.clientLogDirectory(req.logDirectory());
  IgfsHandshakeResponse handshake=new IgfsHandshakeResponse(igfs.name(),igfs.proxyPaths(),igfs.groupBlockSize(),igfs.globalSampling());
  res.handshake(handshake);
  return res;
}
