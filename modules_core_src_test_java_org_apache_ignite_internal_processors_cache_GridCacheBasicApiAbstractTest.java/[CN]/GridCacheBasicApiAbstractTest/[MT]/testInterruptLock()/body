{
  final IgniteCache<Integer,String> cache=ignite.jcache(null);
  cache.lock(1).lock();
  final AtomicBoolean isOk=new AtomicBoolean(false);
  Thread t=new Thread(new Runnable(){
    @Override public void run(){
      assertFalse(cache.isLocalLocked(1,true));
      cache.lock(1).lock();
      try {
        assertTrue(cache.isLocalLocked(1,true));
      }
  finally {
        cache.lock(1).unlock();
      }
      assertTrue(Thread.currentThread().isInterrupted());
      isOk.set(true);
    }
  }
);
  t.start();
  Thread.sleep(100);
  t.interrupt();
  cache.lock(1).unlock();
  t.join();
  assertTrue(isOk.get());
}
