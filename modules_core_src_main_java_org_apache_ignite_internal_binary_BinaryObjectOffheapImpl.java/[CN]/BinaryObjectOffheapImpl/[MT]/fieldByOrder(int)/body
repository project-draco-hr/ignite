{
  Object val;
  int schemaOffset=BinaryPrimitives.readInt(ptr,start + GridBinaryMarshaller.SCHEMA_OR_RAW_OFF_POS);
  short flags=BinaryPrimitives.readShort(ptr,start + GridBinaryMarshaller.FLAGS_POS);
  int fieldIdLen=BinaryUtils.isCompactFooter(flags) ? 0 : BinaryUtils.FIELD_ID_LEN;
  int fieldOffsetLen=BinaryUtils.fieldOffsetLength(flags);
  int fieldOffsetPos=start + schemaOffset + order * (fieldIdLen + fieldOffsetLen) + fieldIdLen;
  int fieldPos;
  if (fieldOffsetLen == BinaryUtils.OFFSET_1)   fieldPos=start + ((int)BinaryPrimitives.readByte(ptr,fieldOffsetPos) & 0xFF);
 else   if (fieldOffsetLen == BinaryUtils.OFFSET_2)   fieldPos=start + ((int)BinaryPrimitives.readShort(ptr,fieldOffsetPos) & 0xFFFF);
 else   fieldPos=start + BinaryPrimitives.readInt(ptr,fieldOffsetPos);
  byte hdr=BinaryPrimitives.readByte(ptr,fieldPos);
switch (hdr) {
case GridBinaryMarshaller.INT:
    val=BinaryPrimitives.readInt(ptr,fieldPos + 1);
  break;
case GridBinaryMarshaller.LONG:
val=BinaryPrimitives.readLong(ptr,fieldPos + 1);
break;
case GridBinaryMarshaller.BOOLEAN:
val=BinaryPrimitives.readBoolean(ptr,fieldPos + 1);
break;
case GridBinaryMarshaller.SHORT:
val=BinaryPrimitives.readShort(ptr,fieldPos + 1);
break;
case GridBinaryMarshaller.BYTE:
val=BinaryPrimitives.readByte(ptr,fieldPos + 1);
break;
case GridBinaryMarshaller.CHAR:
val=BinaryPrimitives.readChar(ptr,fieldPos + 1);
break;
case GridBinaryMarshaller.FLOAT:
val=BinaryPrimitives.readFloat(ptr,fieldPos + 1);
break;
case GridBinaryMarshaller.DOUBLE:
val=BinaryPrimitives.readDouble(ptr,fieldPos + 1);
break;
case GridBinaryMarshaller.STRING:
{
int dataLen=BinaryPrimitives.readInt(ptr,fieldPos + 1);
byte[] data=BinaryPrimitives.readByteArray(ptr,fieldPos + 5,dataLen);
val=new String(data,UTF_8);
break;
}
case GridBinaryMarshaller.DATE:
{
long time=BinaryPrimitives.readLong(ptr,fieldPos + 1);
val=new Date(time);
break;
}
case GridBinaryMarshaller.TIMESTAMP:
{
long time=BinaryPrimitives.readLong(ptr,fieldPos + 1);
int nanos=BinaryPrimitives.readInt(ptr,fieldPos + 1 + 8);
Timestamp ts=new Timestamp(time);
ts.setNanos(ts.getNanos() + nanos);
val=ts;
break;
}
case GridBinaryMarshaller.UUID:
{
long most=BinaryPrimitives.readLong(ptr,fieldPos + 1);
long least=BinaryPrimitives.readLong(ptr,fieldPos + 1 + 8);
val=new UUID(most,least);
break;
}
case GridBinaryMarshaller.DECIMAL:
{
int scale=BinaryPrimitives.readInt(ptr,fieldPos + 1);
int dataLen=BinaryPrimitives.readInt(ptr,fieldPos + 5);
byte[] data=BinaryPrimitives.readByteArray(ptr,fieldPos + 9,dataLen);
BigInteger intVal=new BigInteger(data);
if (scale < 0) {
scale&=0x7FFFFFFF;
intVal=intVal.negate();
}
val=new BigDecimal(intVal,scale);
break;
}
case GridBinaryMarshaller.NULL:
val=null;
break;
default :
BinaryOffheapInputStream stream=new BinaryOffheapInputStream(ptr,size,false);
stream.position(fieldPos);
val=BinaryUtils.unmarshal(stream,ctx,null);
break;
}
return (F)val;
}
