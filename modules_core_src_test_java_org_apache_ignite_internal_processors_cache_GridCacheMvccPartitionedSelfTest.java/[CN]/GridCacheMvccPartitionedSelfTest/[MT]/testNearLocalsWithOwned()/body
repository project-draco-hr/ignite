{
  GridCacheAdapter<String,String> cache=grid.internalCache();
  GridCacheTestEntryEx<String,String> entry=new GridCacheTestEntryEx<>(cache.context(),"1");
  UUID node1=UUID.randomUUID();
  GridCacheVersion ver1=version(1);
  GridCacheVersion ver2=version(2);
  GridCacheMvccCandidate<String> c1=entry.addRemote(node1,1,ver1,0,false,true);
  GridCacheMvccCandidate<String> c2=entry.addNearLocal(node1,1,ver2,0,true);
  Collection<GridCacheMvccCandidate<String>> rmtCands=entry.remoteMvccSnapshot();
  Collection<GridCacheMvccCandidate<String>> nearLocCands=entry.localCandidates();
  assertEquals(1,nearLocCands.size());
  assertEquals(ver2,nearLocCands.iterator().next().version());
  assertEquals(1,rmtCands.size());
  assertEquals(ver1,rmtCands.iterator().next().version());
  entry.orderOwned(ver1,ver2);
  entry.readyNearLocal(ver2,ver2,empty(),empty(),empty());
  checkRemote(c1,ver1,false,false);
  assertFalse(c1.owner());
  checkLocalOwner(c2,ver2,false);
  assertNotNull(entry.anyOwner());
  assertEquals(ver2,entry.anyOwner().version());
}
