{
  A.notNull(name,"name");
  if (create) {
    A.notNull(cfg,"cfg");
    if (cap <= 0)     cap=Integer.MAX_VALUE;
  }
  GridCacheAdapter cache=cacheForCollection(cfg);
  return cache.context().dataStructures().queue(name,cap,create && cfg.isCollocated(),create);
}
