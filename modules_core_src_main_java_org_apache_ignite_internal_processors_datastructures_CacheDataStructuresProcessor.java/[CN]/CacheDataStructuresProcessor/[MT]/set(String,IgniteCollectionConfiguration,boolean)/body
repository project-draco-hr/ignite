{
  A.notNull(name,"name");
  if (create) {
    A.notNull(cfg,"cfg");
    if (ctx.cache().publicCache(cfg.getCacheName()) == null)     throw new IgniteCheckedException("Cache for collection is not configured: " + cfg.getCacheName());
  }
  DataStructureInfo dsInfo=new DataStructureInfo(name,DataStructureType.SET,create ? new CollectionInfo(cfg.getCacheName(),cfg.isCollocated()) : null);
  return getCollection(new CX1<GridCacheContext,IgniteSet<T>>(){
    @Override public IgniteSet<T> applyx(    GridCacheContext cctx) throws IgniteCheckedException {
      return cctx.dataStructures().set(name,create ? cfg.isCollocated() : false,create);
    }
  }
,dsInfo,create);
}
