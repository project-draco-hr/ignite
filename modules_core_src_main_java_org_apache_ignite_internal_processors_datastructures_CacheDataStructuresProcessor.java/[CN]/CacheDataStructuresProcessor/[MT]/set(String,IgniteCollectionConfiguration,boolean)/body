{
  A.notNull(name,"name");
  if (create)   A.notNull(cfg,"cfg");
  GridCacheAdapter cache=cacheForCollection(cfg);
  final GridCacheContext cctx=cache.context();
  final boolean colloc=create && (cctx.cache().configuration().getCacheMode() != PARTITIONED || cfg.isCollocated());
  if (cctx.atomic())   return set0(cctx,name,colloc,create);
  return CU.outTx(new Callable<IgniteSet<T>>(){
    @Nullable @Override public IgniteSet<T> call() throws Exception {
      return set0(cctx,name,colloc,create);
    }
  }
,cctx);
}
