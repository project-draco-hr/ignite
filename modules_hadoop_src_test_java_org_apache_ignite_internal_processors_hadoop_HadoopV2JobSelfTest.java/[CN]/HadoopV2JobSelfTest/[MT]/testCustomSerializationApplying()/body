{
  JobConf cfg=new JobConf();
  cfg.setMapOutputKeyClass(IntWritable.class);
  cfg.setMapOutputValueClass(Text.class);
  cfg.set(CommonConfigurationKeys.IO_SERIALIZATIONS_KEY,CustomSerialization.class.getName());
  HadoopJob job=new HadoopV2Job(new HadoopJobId(UUID.randomUUID(),1),createJobInfo(cfg),log);
  HadoopTaskContext taskCtx=job.getTaskContext(new HadoopTaskInfo(HadoopTaskType.MAP,null,0,0,null));
  HadoopSerialization ser=taskCtx.keySerialization();
  assertEquals(HadoopSerializationWrapper.class.getName(),ser.getClass().getName());
  DataInput in=new DataInputStream(new ByteArrayInputStream(new byte[0]));
  assertEquals(TEST_SERIALIZED_VALUE,ser.read(in,null).toString());
  ser=taskCtx.valueSerialization();
  assertEquals(HadoopSerializationWrapper.class.getName(),ser.getClass().getName());
  assertEquals(TEST_SERIALIZED_VALUE,ser.read(in,null).toString());
}
