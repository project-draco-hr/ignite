{
  IgniteConfiguration cfg=super.getConfiguration(gridName);
  if (cfg.isClientMode() != null && cfg.isClientMode()) {
    TcpDiscoveryVmIpFinder clientFinder=new TcpDiscoveryVmIpFinder();
    Collection<String> addrs=new ArrayList<>(ipFinder.getRegisteredAddresses().size());
    for (    InetSocketAddress sockAddr : ipFinder.getRegisteredAddresses())     addrs.add(sockAddr.getHostString() + ":" + sockAddr.getPort());
    clientFinder.setAddresses(addrs);
    TcpClientDiscoverySpi discoverySpi=new TcpClientDiscoverySpi();
    discoverySpi.setIpFinder(clientFinder);
    cfg.setDiscoverySpi(discoverySpi);
  }
  cfg.setLocalHost("127.0.0.1");
  return cfg;
}
