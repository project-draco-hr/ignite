{
  Ignite cln=grid(serverCount());
  assertTrue(cln.cluster().localNode().isClient());
  final Ignite srv=clientRouter(cln);
  final IgniteCache<Integer,Person> clnCache=cln.getOrCreateCache(QUERY_CACHE);
  final IgniteCache<Integer,Person> srvCache=srv.getOrCreateCache(QUERY_CACHE);
  clnCache.put(1,new Person(1,"name1","surname1"));
  clnCache.put(2,new Person(2,"name2","surname2"));
  clnCache.put(3,new Person(3,"name3","surname3"));
  final SqlQuery<Integer,Person> qry=new SqlQuery<>(Person.class,"_key <> 0");
  qry.setPageSize(1);
  QueryCursor<Cache.Entry<Integer,Person>> cur=clnCache.query(qry);
  reconnectClientNode(cln,srv,new Runnable(){
    @Override public void run(){
      srvCache.put(4,new Person(4,"name4","surname4"));
      try {
        clnCache.query(qry);
        fail();
      }
 catch (      CacheException e) {
        check(e);
      }
    }
  }
);
  List<Cache.Entry<Integer,Person>> res=cur.getAll();
  assertNotNull(res);
  assertEquals(4,res.size());
}
