{
  UUID primaryNodeId=this.primaryNodeId;
  if (primaryNodeId == null)   return false;
  if (cctx.discovery().node(primaryNodeId) == null) {
    this.primaryNodeId=null;
    return false;
  }
  GridNode primary=topVer > 0 ? cctx.affinity().primary(key(),topVer) : cctx.affinity().primary(key());
  if (primary != null && primary.id().equals(primaryNodeId))   return true;
  this.primaryNodeId=null;
  return false;
}
