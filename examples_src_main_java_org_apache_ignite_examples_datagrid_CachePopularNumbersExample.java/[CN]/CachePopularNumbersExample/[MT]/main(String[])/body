{
  Timer popularNumbersQryTimer=new Timer("numbers-query-worker");
  try (Ignite ignite=Ignition.start("examples/config/example-compute.xml")){
    System.out.println();
    System.out.println(">>> Cache popular numbers example started.");
    CacheConfiguration<Integer,Long> cfg=new CacheConfiguration<>();
    cfg.setCacheMode(CacheMode.PARTITIONED);
    cfg.setName(CACHE_NAME);
    try (IgniteCache<Integer,Long> cache=ignite.createCache(cfg)){
      ClusterGroup prj=ignite.cluster().forCacheNodes(CACHE_NAME);
      if (prj.nodes().isEmpty()) {
        System.out.println("Ignite does not have cache configured: " + CACHE_NAME);
        return;
      }
      TimerTask task=scheduleQuery(ignite,popularNumbersQryTimer,POPULAR_NUMBERS_CNT);
      streamData(ignite);
      task.run();
      popularNumbersQryTimer.cancel();
    }
   }
 }
