{
  GridAffinityProcessor aff=ctx.affinity();
  List<ClusterNode> res=null;
  if (!allowOverwrite())   res=aff.mapKeyToPrimaryAndBackups(cacheName,key);
 else {
    ClusterNode node=aff.mapKeyToNode(cacheName,key);
    if (node != null)     res=Collections.singletonList(node);
  }
  if (F.isEmpty(res))   throw new ClusterTopologyServerNotFoundException("Failed to find server node for cache (all affinity " + "nodes have left the grid or cache was stopped): " + cacheName);
  return res;
}
