{
  IgniteCacheProxy<KeyCacheObject,CacheObject> proxy=(IgniteCacheProxy<KeyCacheObject,CacheObject>)cache;
  GridCacheAdapter<KeyCacheObject,CacheObject> internalCache=proxy.context().cache();
  if (internalCache.isNear())   internalCache=internalCache.context().near().dht();
  GridCacheContext cctx=internalCache.context();
  long topVer=cctx.affinity().affinityTopologyVersion();
  GridCacheVersion ver=cctx.versions().next(topVer);
  for (  Map.Entry<KeyCacheObject,CacheObject> e : entries) {
    try {
      e.getKey().finishUnmarshal(cctx.cacheObjectContext(),cctx.deploy().globalLoader());
      GridCacheEntryEx entry=internalCache.entryEx(e.getKey(),topVer);
      entry.unswap(true,false);
      entry.initialValue(e.getValue(),ver,CU.TTL_ETERNAL,CU.EXPIRE_TIME_ETERNAL,false,topVer,GridDrType.DR_LOAD);
      cctx.evicts().touch(entry,topVer);
    }
 catch (    GridDhtInvalidPartitionException|GridCacheEntryRemovedException ignored) {
    }
catch (    IgniteCheckedException ex) {
      IgniteLogger log=cache.unwrap(Ignite.class).log();
      U.error(log,"Failed to set initial value for cache entry: " + e,ex);
    }
  }
}
