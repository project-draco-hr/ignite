{
  GridDhtFuture<Object> fut=cctx.dht().dhtPreloader().request(keys.keySet(),topVer);
  if (fut != null) {
    if (!F.isEmpty(fut.invalidPartitions())) {
      if (retries == null)       retries=new HashSet<>();
      retries.addAll(fut.invalidPartitions());
    }
    add(new GridEmbeddedFuture<>(new IgniteBiClosure<Object,Exception,Collection<GridCacheEntryInfo>>(){
      @Override public Collection<GridCacheEntryInfo> apply(      Object o,      Exception e){
        if (e != null) {
          if (log.isDebugEnabled())           log.debug("Failed to request keys from preloader [keys=" + keys + ", err="+ e+ ']');
          onDone(e);
        }
 else         map0(keys);
        return Collections.emptyList();
      }
    }
,fut));
  }
 else   map0(keys);
}
