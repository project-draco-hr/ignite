{
  IgniteCache<Integer,String> cache=jcache(0);
  String val=Integer.toString(key);
  cache.put(key,val);
  assertEquals(val,dhtPeek(0,key));
  assertEquals(val,dhtPeek(1,key));
  assertNull(near(0).peekEx(key));
  assertNull(near(1).peekEx(key));
  if (transactional()) {
    try (Transaction tx=grid(0).transactions().txStart(PESSIMISTIC,REPEATABLE_READ)){
      assertEquals(val,cache.get(key));
      tx.commit();
    }
   }
 else   assertEquals(val,cache.get(key));
  assertEquals(val,dhtPeek(0,key));
  assertEquals(val,dhtPeek(1,key));
  assertNull(near(0).peekEx(key));
  assertNull(near(1).peekEx(key));
}
