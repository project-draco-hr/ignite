{
  if (log.isDebugEnabled())   log.debug("Start collecting database metadata [drvJar=" + jdbcDriverJarPath + ", drvCls="+ jdbcDriverCls+ ", jdbcUrl="+ jdbcUrl+ "]");
  try (Connection conn=connect(jdbcDriverJarPath,jdbcDriverCls,jdbcUrl,jdbcInfo)){
    Collection<DbTable> metadata=DbMetadataReader.getInstance().metadata(conn,schemas,tblsOnly);
    if (log.isDebugEnabled())     log.debug("Finished collection of metadata [jdbcUrl=" + jdbcUrl + ", count="+ metadata.size()+ "]");
    return metadata;
  }
 catch (  Throwable e) {
    log.error("Failed to collect metadata",e);
    throw new SQLException("Failed to collect metadata",e);
  }
}
