{
  long dur=System.currentTimeMillis() - ts;
  info(">>> Stopping test: " + getName() + " in "+ dur+ " ms <<<");
  TestCounters cntrs=getTestCounters();
  if (isDebug())   info("Test counters [numOfTests=" + cntrs.getNumberOfTests() + ", started="+ cntrs.getStarted()+ ", stopped="+ cntrs.getStopped()+ ']');
  afterTest();
  if (isLastTest()) {
    info(">>> Stopping test class: " + getClass().getSimpleName() + " <<<");
    TestCounters counters=getTestCounters();
    GridTestUtils.stopThreads(log);
    getTestResources().stopThreads();
    counters.setReset(true);
    afterTestsStopped();
    if (startGrid)     G.stop(getTestGridName(),true);
    tests.remove(getClass());
    GridClassLoaderCache.clear();
    GridOptimizedMarshaller.clearCache();
  }
  Thread.currentThread().setContextClassLoader(clsLdr);
  clsLdr=null;
}
