{
  if (wrapper == null)   throw new GridException("Failed to find query future (query has been expired).");
  if (pageSize <= 0)   pageSize=GridCacheQuery.DFLT_PAGE_SIZE;
  GridCacheQueryFuture<?> fut=wrapper.future();
  Collection<Object> col=new ArrayList<>(pageSize);
  int cnt=0;
  GridCacheRestResponse res=new GridCacheRestResponse();
  GridCacheClientQueryResult qryRes=new GridCacheClientQueryResult();
  while (cnt < pageSize) {
    Object obj=fut.next();
    if (obj == null) {
      qryRes.last(true);
      locMap.remove(new QueryExecutionKey(queryId),wrapper);
      break;
    }
    col.add(obj);
  }
  qryRes.items(col);
  qryRes.queryId(queryId);
  qryRes.nodeId(locNodeId);
  res.setResponse(qryRes);
  return res;
}
