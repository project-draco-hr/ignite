{
  WindowHolder tup=ref.get();
  AtomicInteger size=tup.size();
  while (true) {
    int curSize=size.get();
    if (curSize > maxSize) {
      if (size.compareAndSet(curSize,curSize - 1)) {
        E evt=pollInternal(tup.collection(),tup.set());
        if (evt != null)         return evt;
 else {
          size.incrementAndGet();
          return null;
        }
      }
    }
 else     return null;
  }
}
