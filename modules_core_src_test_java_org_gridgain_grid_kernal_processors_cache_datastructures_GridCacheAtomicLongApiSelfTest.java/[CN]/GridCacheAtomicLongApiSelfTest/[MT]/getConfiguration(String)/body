{
  GridConfiguration cfg=super.getConfiguration(gridName);
  cfg.setLocalHost("127.0.0.1");
  GridTcpDiscoverySpi spi=new GridTcpDiscoverySpi();
  spi.setIpFinder(ipFinder);
  cfg.setDiscoverySpi(spi);
  GridCacheConfiguration repCacheCfg=defaultCacheConfiguration();
  repCacheCfg.setName("replicated");
  repCacheCfg.setCacheMode(REPLICATED);
  repCacheCfg.setPreloadMode(SYNC);
  repCacheCfg.setWriteSynchronizationMode(FULL_SYNC);
  repCacheCfg.setEvictionPolicy(null);
  repCacheCfg.setAtomicityMode(TRANSACTIONAL);
  repCacheCfg.setDistributionMode(NEAR_PARTITIONED);
  GridCacheConfiguration partCacheCfg=defaultCacheConfiguration();
  partCacheCfg.setName("partitioned");
  partCacheCfg.setCacheMode(PARTITIONED);
  partCacheCfg.setBackups(1);
  partCacheCfg.setPreloadMode(SYNC);
  partCacheCfg.setWriteSynchronizationMode(FULL_SYNC);
  partCacheCfg.setEvictionPolicy(null);
  partCacheCfg.setNearEvictionPolicy(null);
  partCacheCfg.setAtomicityMode(TRANSACTIONAL);
  partCacheCfg.setDistributionMode(NEAR_PARTITIONED);
  GridCacheConfiguration locCacheCfg=defaultCacheConfiguration();
  locCacheCfg.setName("local");
  locCacheCfg.setCacheMode(LOCAL);
  locCacheCfg.setWriteSynchronizationMode(FULL_SYNC);
  locCacheCfg.setEvictionPolicy(null);
  locCacheCfg.setAtomicityMode(TRANSACTIONAL);
  locCacheCfg.setDistributionMode(NEAR_PARTITIONED);
  cfg.setCacheConfiguration(repCacheCfg,partCacheCfg,locCacheCfg);
  return cfg;
}
