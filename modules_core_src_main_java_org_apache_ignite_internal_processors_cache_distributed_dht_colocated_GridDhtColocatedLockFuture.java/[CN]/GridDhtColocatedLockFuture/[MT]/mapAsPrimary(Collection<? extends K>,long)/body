{
  Collection<K> distributedKeys=new ArrayList<>(keys.size());
  for (  K key : keys) {
    if (!cctx.affinity().primary(cctx.localNode(),key,topVer)) {
      for (      K k : keys)       cctx.mvcc().removeExplicitLock(threadId,k,lockVer);
      return false;
    }
    addLocalKey(key,topVer,distributedKeys);
    if (isDone())     return true;
  }
  trackable=false;
  if (tx != null)   tx.colocatedLocallyMapped(true);
  if (!distributedKeys.isEmpty()) {
    if (tx != null) {
      for (      K key : distributedKeys)       tx.addKeyMapping(cctx.txKey(key),cctx.localNode());
    }
    lockLocally(distributedKeys,topVer,null);
  }
  return true;
}
