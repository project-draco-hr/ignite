{
  GridDiscoveryTopologySnapshot snapshot=tx != null ? tx.topologySnapshot() : cctx.mvcc().lastExplicitLockTopologySnapshot(threadId);
  if (snapshot != null) {
    topSnapshot.compareAndSet(null,snapshot);
    map(keys);
    markInitialized();
    return;
  }
  mapOnTopology();
}
