{
  JobConf jobConf=new JobConf(getConf(),GridHadoopParallelCount.class);
  jobConf.setJobName("count-chars");
  FileInputFormat.setInputPaths(jobConf,in);
  jobConf.setMapperClass(GridHadoopTextLineMapper.class);
  jobConf.setCombinerClass(GridHadoopTextLineReducer.class);
  jobConf.setReducerClass(GridHadoopTextLineReducer.class);
  FileOutputFormat.setOutputPath(jobConf,new Path(out));
  jobConf.setOutputFormat(TextOutputFormat.class);
  jobConf.setOutputKeyClass(Text.class);
  jobConf.setOutputValueClass(LongWritable.class);
  return client.submitJob(jobConf);
}
