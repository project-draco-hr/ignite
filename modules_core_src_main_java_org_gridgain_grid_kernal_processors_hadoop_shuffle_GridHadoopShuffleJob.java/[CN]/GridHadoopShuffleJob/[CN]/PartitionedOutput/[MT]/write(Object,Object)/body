{
  int part=partitioner.partition(key,val,adders.length);
  if (part < 0 || part >= adders.length)   throw new IllegalStateException("Invalid partition: " + part);
  adders[part].add(key,val);
}
