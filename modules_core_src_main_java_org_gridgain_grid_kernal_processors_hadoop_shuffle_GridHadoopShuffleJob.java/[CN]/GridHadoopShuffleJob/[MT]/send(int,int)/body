{
  GridHadoopShuffleMessage msg=msgs[idx];
  sentMsgs.putIfAbsent(msg.id(),F.t(msg,new GridFutureAdapter<>(ctx.kernalContext())));
  doSend(reduceNodes[idx],msg);
  msgs[idx]=newBufMinSize == 0 ? null : new GridHadoopShuffleMessage(job.id(),idx,Math.max(4 * 1024,newBufMinSize));
}
