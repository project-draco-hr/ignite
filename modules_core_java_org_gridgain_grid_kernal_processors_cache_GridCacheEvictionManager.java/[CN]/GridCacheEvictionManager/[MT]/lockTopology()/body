{
  if (cctx.isReplicated())   return cctx.discovery().topologyVersion();
 else   if (!cctx.isNear()) {
    cctx.dht().topology().readLock();
    return cctx.dht().topology().topologyVersion();
  }
  return 0;
}
