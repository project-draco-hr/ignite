{
  if (cctx.isReplicated())   return cctx.discovery().topologyVersion();
 else   if (cctx.isDht() || cctx.isColocated()) {
    cctx.dht().topology().readLock();
    return cctx.dht().topology().topologyVersion();
  }
  return 0;
}
