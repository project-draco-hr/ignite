{
  if (log.isDebugEnabled())   log.debug("DHT preloader onKernalStop callback.");
  cctx.events().removeListener(discoLsnr);
  busyLock.writeLock().lock();
  for (  GridDhtPartitionsExchangeFuture<K,V> f : exchFuts.values())   f.onDone(new GridInterruptedException("Grid is stopping: " + cctx.gridName()));
  if (supplyPool != null)   supplyPool.stop();
  if (demandPool != null)   demandPool.stop();
  ResendTimeoutObject resendTimeoutObj=pendingResend.getAndSet(null);
  if (resendTimeoutObj != null)   cctx.time().removeTimeoutObject(resendTimeoutObj);
  top=null;
  exchFuts=null;
}
