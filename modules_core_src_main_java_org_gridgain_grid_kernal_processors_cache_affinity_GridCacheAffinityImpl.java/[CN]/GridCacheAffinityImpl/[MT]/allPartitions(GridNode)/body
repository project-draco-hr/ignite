{
  A.notNull(n,"p");
  Collection<Integer> parts=new HashSet<>();
  long topVer=cctx.discovery().topologyVersion();
  for (int partsCnt=partitions(), part=0; part < partsCnt; part++) {
    for (    GridNode affNode : cctx.affinity().nodes(part,topVer)) {
      if (n.id().equals(affNode.id())) {
        parts.add(part);
        break;
      }
    }
  }
  return U.toIntArray(parts);
}
