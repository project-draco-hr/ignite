{
  A.notNull(n,"n");
  Collection<Integer> parts=new HashSet<>();
  long topVer=cctx.discovery().topologyVersion();
  for (int partsCnt=partitions(), part=0; part < partsCnt; part++) {
    if (n.id().equals(F.first(cctx.affinity().nodes(part,topVer)).id()))     parts.add(part);
  }
  return U.toIntArray(parts);
}
