{
  boolean swapEnabled=cctx.swap().swapEnabled();
  if (!swapEnabled && !cctx.isOffHeapEnabled())   return null;
synchronized (this) {
    if (isStartVersion() && ((flags & IS_UNSWAPPED_MASK) == 0)) {
      GridCacheSwapEntry e;
      if (cctx.offheapTiered()) {
        e=cctx.swap().readOffheapPointer(this);
        if (e != null) {
          if (e.offheapPointer() > 0) {
            offHeapPointer(e.offheapPointer());
            if (needVal) {
              CacheObject val=cctx.fromOffheap(offHeapPointer(),false);
              e.value(val);
            }
          }
 else           offHeapPointer(0);
        }
      }
 else       e=detached() ? cctx.swap().read(this,true,true,true) : cctx.swap().readAndRemove(this);
      if (log.isDebugEnabled())       log.debug("Read swap entry [swapEntry=" + e + ", cacheEntry="+ this+ ']');
      flags|=IS_UNSWAPPED_MASK;
      if (e != null) {
        long delta=e.expireTime() == 0 ? 0 : e.expireTime() - U.currentTimeMillis();
        if (delta >= 0) {
          CacheObject val=e.value();
          val=cctx.kernalContext().cacheObjects().prepareForCache(val,cctx);
          update(val,e.expireTime(),e.ttl(),e.version());
          if (cctx.offheapTiered() && e.offheapPointer() > 0)           offHeapPointer(e.offheapPointer());
          return val;
        }
 else         clearIndex(e.value());
      }
    }
  }
  return null;
}
