{
  GridHadoopV1OutputCollector collector=new GridHadoopV1OutputCollector(jobConf,taskCtx,directWrite,fileName,attempt){
    /** 
 * {@inheritDoc} 
 */
    @Override public void collect(    Object key,    Object val) throws IOException {
      if (cancelled)       throw new GridHadoopTaskCancelledException("Task cancelled.");
      super.collect(key,val);
    }
  }
;
  collector.setup();
  return collector;
}
