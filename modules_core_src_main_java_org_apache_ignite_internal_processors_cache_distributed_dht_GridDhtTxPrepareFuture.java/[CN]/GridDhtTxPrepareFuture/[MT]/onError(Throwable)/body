{
  if (err.compareAndSet(null,t)) {
    tx.setRollbackOnly();
    try {
      GridNearTxPrepareResponse<K,V> res=new GridNearTxPrepareResponse<>(tx.nearXidVersion(),tx.nearFutureId(),nearMiniId,tx.xidVersion(),Collections.<Integer>emptySet(),ret,t);
      sendPrepareResponse(res);
    }
 catch (    IgniteCheckedException ignore) {
      tx.rollbackAsync();
    }
    onComplete();
  }
}
