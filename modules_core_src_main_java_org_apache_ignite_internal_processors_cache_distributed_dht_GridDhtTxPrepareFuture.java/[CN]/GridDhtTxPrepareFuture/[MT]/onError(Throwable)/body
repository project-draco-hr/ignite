{
  if (err.compareAndSet(null,t)) {
    tx.setRollbackOnly();
    if (!tx.nearNodeId().equals(cctx.localNodeId())) {
      GridCacheMessage<K,V> res=new GridNearTxPrepareResponse<>(tx.nearXidVersion(),tx.nearFutureId(),nearMiniId,tx.xidVersion(),Collections.<Integer>emptySet(),t);
      try {
        cctx.io().send(tx.nearNodeId(),res,tx.ioPolicy());
      }
 catch (      IgniteCheckedException e) {
        U.error(log,"Failed to send reply to originating near node (will rollback): " + tx.nearNodeId(),e);
        tx.rollbackAsync();
      }
    }
    onComplete();
  }
}
