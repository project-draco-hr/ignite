{
  if (checkLocks()) {
    if (!MAPPED_UPD.compareAndSet(this,0,1))     return false;
    if (forceKeysFut == null || (forceKeysFut.isDone() && forceKeysFut.error() == null))     prepare0();
 else {
      forceKeysFut.listen(new CI1<IgniteInternalFuture<?>>(){
        @Override public void apply(        IgniteInternalFuture<?> f){
          try {
            f.get();
            prepare0();
          }
 catch (          IgniteCheckedException e) {
            onError(e);
          }
 finally {
            cctx.txContextReset();
          }
        }
      }
);
    }
    return true;
  }
  return false;
}
