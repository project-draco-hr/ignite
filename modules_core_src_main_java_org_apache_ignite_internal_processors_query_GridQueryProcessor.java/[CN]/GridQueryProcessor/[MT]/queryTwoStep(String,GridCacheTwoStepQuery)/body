{
  checkxEnabled();
  if (!busyLock.enterBusy())   throw new IllegalStateException("Failed to execute query (grid is stopping).");
  try {
    GridCacheContext<Object,Object> cacheCtx=ctx.cache().internalCache(space).context();
    return idx.queryTwoStep(cacheCtx,qry,cacheCtx.keepPortable());
  }
  finally {
    busyLock.leaveBusy();
  }
}
