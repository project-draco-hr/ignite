{
  String propName;
  Class<?> propCls;
  if (_VAL.equals(pathStr)) {
    propName=_VAL;
    propCls=valCls;
  }
 else {
    ClassProperty prop=buildClassProperty(keyCls,valCls,pathStr,resType,aliases,coCtx);
    d.addProperty(prop,false);
    propName=prop.name();
    propCls=prop.type();
  }
  if (idxType != null) {
    if (idxName == null)     idxName=propName + "_idx";
    if (idxOrder == 0)     d.addIndex(idxName,isGeometryClass(propCls) ? GEO_SPATIAL : SORTED);
    if (idxType == IndexType.TEXT)     d.addFieldToTextIndex(propName);
 else     d.addFieldToIndex(idxName,propName,idxOrder,idxType == IndexType.DESC);
  }
}
