{
  long start=U.currentTimeMillis();
  try {
    ResultSet rs=executeSqlQuery(conn,sql,params);
    long time=U.currentTimeMillis() - start;
    if (time > longQryExecTimeout) {
      String msg="Query execution is too long (" + time + " ms): "+ sql;
      String longMsg=msg;
      if (longQryExplain) {
        ResultSet plan=executeSqlQuery(conn,"EXPLAIN " + sql,params);
        if (plan == null)         longMsg="Failed to explain plan because required table does not exist: " + sql;
 else {
          plan.next();
          longMsg="Query execution is too long [time=" + time + " ms, sql='"+ sql+ '\''+ ", plan="+ U.nl()+ plan.getString(1)+ U.nl()+ ", parameters="+ params+ "]";
        }
      }
      LT.warn(log,null,longMsg,msg);
    }
    return rs;
  }
 catch (  SQLException e) {
    onSqlException();
    throw new GridSpiException(e);
  }
}
