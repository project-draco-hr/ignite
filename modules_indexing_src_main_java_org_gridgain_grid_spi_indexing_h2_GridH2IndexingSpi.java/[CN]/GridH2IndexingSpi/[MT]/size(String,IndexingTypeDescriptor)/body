{
  TableDescriptor tbl=tableDescriptor(spaceName,type);
  if (tbl == null)   return -1;
  IgniteSpiCloseableIterator<List<IndexingEntity<?>>> iter=queryFields(spaceName,"SELECT COUNT(*) FROM " + tbl.fullTableName(),null,null).iterator();
  if (!iter.hasNext())   throw new IllegalStateException();
  return ((IndexingEntityAdapter<Number>)iter.next().get(0)).value().longValue();
}
