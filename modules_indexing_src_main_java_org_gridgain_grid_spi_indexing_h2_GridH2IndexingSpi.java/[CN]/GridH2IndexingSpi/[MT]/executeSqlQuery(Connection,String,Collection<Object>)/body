{
  PreparedStatement stmt;
  try {
    stmt=conn.prepareStatement(sql);
  }
 catch (  SQLException e) {
    if (e.getErrorCode() == ErrorCode.TABLE_OR_VIEW_NOT_FOUND_1)     return null;
    throw new IgniteSpiException("Failed to parse SQL query: " + sql,e);
  }
switch (commandType(stmt)) {
case CommandInterface.SELECT:
case CommandInterface.CALL:
case CommandInterface.EXPLAIN:
case CommandInterface.ANALYZE:
    break;
default :
  throw new IgniteSpiException("Failed to execute non-query SQL statement: " + sql);
}
bindParameters(stmt,params);
try {
return stmt.executeQuery();
}
 catch (SQLException e) {
throw new IgniteSpiException("Failed to execute SQL query.",e);
}
}
