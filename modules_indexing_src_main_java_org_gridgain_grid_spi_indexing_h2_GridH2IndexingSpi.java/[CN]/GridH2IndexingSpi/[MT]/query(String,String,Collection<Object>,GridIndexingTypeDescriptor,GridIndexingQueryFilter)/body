{
  final TableDescriptor tbl=tableDescriptor(spaceName,type);
  if (tbl == null)   return new GridEmptyCloseableIterator<>();
  return new KeyValIterator(executeQueryWithCache(new T3<>(tbl.fullTableName(),qry,params),new COX<QueryResult>(){
    @Override public QueryResult applyx() throws GridSpiException {
      setFilters(filters);
      localSpi.set(GridH2IndexingSpi.this);
      try {
        T2<PreparedStatement,ResultSet> t=executeQuery(qry,params,tbl);
        QueryResult qryRes=new QueryResult();
        if (t != null)         qryRes.data=fetchResult(t);
        return qryRes;
      }
  finally {
        setFilters(null);
        localSpi.remove();
      }
    }
  }
).data);
}
