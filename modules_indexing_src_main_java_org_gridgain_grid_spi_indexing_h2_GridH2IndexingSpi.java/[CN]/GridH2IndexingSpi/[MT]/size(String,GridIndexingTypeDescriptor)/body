{
  TableDescriptor tbl=tableDescriptor(spaceName,type);
  if (tbl == null)   return -1;
  GridSpiCloseableIterator<List<GridIndexingEntity<?>>> iter=queryFields(spaceName,"SELECT COUNT(*) FROM " + tbl.fullTableName(),null).iterator();
  if (!iter.hasNext())   throw new IllegalStateException();
  return ((Number)iter.next().get(0)).longValue();
}
