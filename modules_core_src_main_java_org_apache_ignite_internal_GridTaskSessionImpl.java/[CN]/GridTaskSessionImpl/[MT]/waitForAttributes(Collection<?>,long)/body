{
  A.notNull(keys,"keys");
  checkFullSupport();
  if (keys.isEmpty())   return Collections.emptyMap();
  if (timeout == 0)   timeout=Long.MAX_VALUE;
  long now=U.currentTimeMillis();
  long end=now + timeout < 0 ? Long.MAX_VALUE : now + timeout;
  if (end > endTime)   end=endTime;
synchronized (mux) {
    while (!closed && (attrs == null || !attrs.keySet().containsAll(keys)) && now < end) {
      mux.wait(end - now);
      now=U.currentTimeMillis();
    }
    if (closed)     throw new InterruptedException("Session was closed: " + this);
    Map<Object,Object> retVal=new HashMap<>(keys.size(),1.0f);
    if (attrs != null)     for (    Object key : keys)     retVal.put(key,attrs.get(key));
    return retVal;
  }
}
