{
  P2<CacheAffinityKey<String>,Person> p=new P2<CacheAffinityKey<String>,Person>(){
    @Override public boolean apply(    CacheAffinityKey<String> key,    Person val){
      return val.orgId == 1;
    }
  }
;
  CacheProjection<CacheAffinityKey<String>,Person> cachePrj=grid(0).<CacheAffinityKey<String>,Person>cache(null).projection(p);
  CacheQuery<List<?>> qry=cachePrj.queries().createSqlFieldsQuery("select age from Person");
  Collection<IgniteBiTuple<Integer,Integer>> res=qry.execute(new AverageRemoteReducer()).get();
  assertEquals("Average",30,F.reduce(res,new AverageLocalReducer()).intValue());
}
