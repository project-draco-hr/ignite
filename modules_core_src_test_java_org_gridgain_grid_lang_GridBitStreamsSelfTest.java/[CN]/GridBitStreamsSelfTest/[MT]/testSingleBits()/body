{
  GridBitByteArrayOutputStream out=new GridBitByteArrayOutputStream();
  Random rnd=new Random();
  byte[] testData=new byte[8192];
  rnd.nextBytes(testData);
  for (  byte aTestData : testData) {
    for (int b=0; b < 8; b++)     out.writeBit(((aTestData >>> b) & 0x01) == 1);
  }
  assertEquals(testData.length,out.bytesLength());
  assertEquals(testData.length * 8,out.bitsLength());
  byte[] bytes=out.toArray();
  assertEquals(testData.length,bytes.length);
  for (int i=0; i < testData.length; i++)   assertEquals("Mismatch in position: " + i,testData[i],bytes[i]);
}
