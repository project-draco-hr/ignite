{
  JavaSparkContext sc=new JavaSparkContext("local[*]","test");
  try {
    JavaIgniteContext<String,String> ic=new JavaIgniteContext<>(sc,new IgniteConfigProvider());
    ic.fromCache(PARTITIONED_CACHE_NAME).savePairs(sc.parallelize(F.range(0,KEYS_CNT),2).mapToPair(TO_PAIR_F));
    Ignite ignite=Ignition.ignite("grid-0");
    IgniteCache<String,String> cache=ignite.cache(PARTITIONED_CACHE_NAME);
    for (int i=0; i < KEYS_CNT; i++) {
      String val=cache.get(String.valueOf(i));
      assertNotNull("Value was not put to cache for key: " + i,val);
      assertEquals("Invalid value stored for key: " + i,"val" + i,val);
    }
  }
  finally {
    sc.stop();
  }
}
