{
  try {
    checkRemoved();
    try (GridCloseableIterator<T> iter=iteratorEx()){
      Collection<GridCacheSetItemKey> rmvKeys=new ArrayList<>(BATCH_SIZE);
      for (      T val : iter) {
        rmvKeys.add(itemKey(val));
        if (rmvKeys.size() == BATCH_SIZE) {
          retryRemoveAll(rmvKeys);
          rmvKeys.clear();
        }
      }
      if (!rmvKeys.isEmpty())       retryRemoveAll(rmvKeys);
    }
   }
 catch (  GridException e) {
    throw new GridRuntimeException(e);
  }
}
