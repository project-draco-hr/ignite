{
  if (ctx.isDaemon())   return;
  HadoopConfiguration cfg=ctx.config().getHadoopConfiguration();
  if (cfg == null)   cfg=new HadoopConfiguration();
 else   cfg=new HadoopConfiguration(cfg);
  initializeDefaults(cfg);
  hctx=new HadoopContext(ctx,cfg,new HadoopJobTracker(),new HadoopEmbeddedTaskExecutor(),new HadoopShuffle());
  for (  HadoopComponent c : hctx.components())   c.start(hctx);
  hadoop=new HadoopImpl(this);
  ctx.addNodeAttribute(HadoopAttributes.NAME,new HadoopAttributes(cfg));
}
