{
  if (ctx.isDaemon())   return;
  HadoopConfiguration cfg=ctx.config().getHadoopConfiguration();
  if (cfg == null)   cfg=new HadoopConfiguration();
 else   cfg=new HadoopConfiguration(cfg);
  initializeDefaults(cfg);
  validate(cfg);
  if (hadoopHome() != null)   U.quietAndInfo(log,"HADOOP_HOME is set to " + hadoopHome());
  boolean ok=false;
  try {
    hadoopUrls();
    ok=true;
  }
 catch (  IgniteCheckedException e) {
    U.quietAndWarn(log,e.getMessage());
  }
  if (ok) {
    hctx=new HadoopContext(ctx,cfg,new HadoopJobTracker(),cfg.isExternalExecution() ? new HadoopExternalTaskExecutor() : new HadoopEmbeddedTaskExecutor(),new HadoopShuffle());
    for (    HadoopComponent c : hctx.components())     c.start(hctx);
    hadoop=new HadoopImpl(this);
  }
}
