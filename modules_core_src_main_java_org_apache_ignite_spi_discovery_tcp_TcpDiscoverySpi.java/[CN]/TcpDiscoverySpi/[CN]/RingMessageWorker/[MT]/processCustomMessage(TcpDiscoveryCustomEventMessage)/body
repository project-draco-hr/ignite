{
  if (isLocalNodeCoordinator()) {
    if (msg.verified()) {
      stats.onRingMessageReceived(msg);
      addMessage(new TcpDiscoveryDiscardMessage(getLocalNodeId(),msg.id()));
      return;
    }
    msg.verify(getLocalNodeId());
    msg.topologyVersion(ring.topologyVersion());
  }
  if (msg.verified()) {
    DiscoverySpiListener lsnr=TcpDiscoverySpi.this.lsnr;
    TcpDiscoverySpiState spiState=spiStateCopy();
    if (lsnr != null && (spiState == CONNECTED || spiState == DISCONNECTING))     lsnr.onDiscovery(DiscoveryCustomEvent.EVT_DISCOVERY_CUSTOM_EVT,msg.topologyVersion(),ring.node(msg.creatorNodeId()),null,null,msg.message());
  }
  if (ring.hasRemoteNodes())   sendMessageAcrossRing(msg);
}
