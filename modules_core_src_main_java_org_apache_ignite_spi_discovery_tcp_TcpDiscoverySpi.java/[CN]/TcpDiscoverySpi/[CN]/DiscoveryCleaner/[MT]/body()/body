{
  if (log.isDebugEnabled())   log.debug("Tcp discovery cleaner has been started.");
  while (!isInterrupted()) {
    Thread.sleep(ipFinderCleanFreq);
    for (    DiscoveryDeploymentClassLoader ldr : p2pLdrs.values()) {
      if (ring.node(ldr.nodeId()) == null) {
        ldr.onNodeLeft();
        p2pLdrs.remove(ldr.nodeId(),ldr);
      }
 else       ldr.closeConnectionIfNotUsed();
    }
    if (!isLocalNodeCoordinator())     continue;
    if (spiStateCopy() != CONNECTED) {
      if (log.isDebugEnabled())       log.debug("Stopping IP finder cleaner (SPI is not connected to topology).");
      return;
    }
    if (ipFinder.isShared())     cleanIpFinder();
  }
}
