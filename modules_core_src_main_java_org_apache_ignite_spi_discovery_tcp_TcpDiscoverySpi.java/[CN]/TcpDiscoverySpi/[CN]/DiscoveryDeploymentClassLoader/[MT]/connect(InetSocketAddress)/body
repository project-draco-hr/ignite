{
  TcpDiscoveryHandshakeRequest req=new TcpDiscoveryHandshakeRequest(getLocalNodeId());
  for (int i=0; i < reconCnt; i++) {
    Socket sock=null;
    long tstamp=U.currentTimeMillis();
    try {
      sock=openSocket(addr);
      writeToSocket(sock,req);
      TcpDiscoveryHandshakeResponse res=readMessage(sock,null,netTimeout);
      if (!res.creatorNodeId().equals(nodeId))       return null;
      stats.onClientSocketInitialized(U.currentTimeMillis() - tstamp);
      return sock;
    }
 catch (    IOException|IgniteCheckedException e) {
      U.closeQuiet(sock);
    }
  }
  return null;
}
