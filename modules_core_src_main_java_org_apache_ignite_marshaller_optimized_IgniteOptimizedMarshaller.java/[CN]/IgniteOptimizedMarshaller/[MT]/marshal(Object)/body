{
  IgniteOptimizedObjectOutputStream objOut=null;
  try {
    objOut=IgniteOptimizedObjectStreamRegistry.out();
    objOut.requireSerializable(requireSer);
    objOut.writeObject(obj);
    return objOut.out().array();
  }
 catch (  IOException e) {
    throw new IgniteCheckedException("Failed to serialize object: " + obj,e);
  }
 finally {
    IgniteOptimizedObjectStreamRegistry.closeOut(objOut);
  }
}
