{
  int part=aff.affFunc.partition(aff.mapper.affinityKey(key));
  Collection<ClusterNode> nodes=aff.assignment.get(part);
  if (F.isEmpty(nodes))   throw new GridException("Failed to get affinity nodes [aff=" + aff + ", key="+ key+ ']');
  return nodes.iterator().next();
}
