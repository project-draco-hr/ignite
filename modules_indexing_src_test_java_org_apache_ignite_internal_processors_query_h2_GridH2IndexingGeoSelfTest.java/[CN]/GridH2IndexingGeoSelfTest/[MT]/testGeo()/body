{
  Cache<Integer,EnemyCamp> cache=grid(0).cache(null);
  WKTReader r=new WKTReader();
  cache.put(0,new EnemyCamp(r.read("POINT(25 75)"),"A"));
  cache.put(1,new EnemyCamp(r.read("POINT(70 70)"),"B"));
  cache.put(2,new EnemyCamp(r.read("POINT(70 30)"),"C"));
  cache.put(3,new EnemyCamp(r.read("POINT(75 25)"),"D"));
  CacheQuery<Map.Entry<Integer,EnemyCamp>> qry=cache.queries().createSqlQuery(EnemyCamp.class,"coords && ?");
  Collection<Map.Entry<Integer,EnemyCamp>> res=qry.execute(r.read("POLYGON((5 70, 5 80, 30 80, 30 70, 5 70))")).get();
  checkPoints(res,"A");
  res=qry.execute(r.read("POLYGON((10 5, 10 35, 70 30, 75 25, 10 5))")).get();
  checkPoints(res,"C","D");
  cache.put(1,new EnemyCamp(r.read("POINT(20 75)"),"B"));
  res=qry.execute(r.read("POLYGON((5 70, 5 80, 30 80, 30 70, 5 70))")).get();
  checkPoints(res,"A","B");
  cache.put(1,new EnemyCamp(r.read("POINT(30 30)"),"B"));
  res=qry.execute(r.read("POLYGON((10 5, 10 35, 70 30, 75 25, 10 5))")).get();
  checkPoints(res,"B","C","D");
  cache.remove(1);
  res=qry.execute(r.read("POLYGON((5 70, 5 80, 30 80, 30 70, 5 70))")).get();
  checkPoints(res,"A");
  res=qry.execute(r.read("POLYGON((10 5, 10 35, 70 30, 75 25, 10 5))")).get();
  checkPoints(res,"C","D");
  assertTrue(F.first(cache.queries().createSqlFieldsQuery("explain select * from EnemyCamp " + "where coords && 'POINT(25 75)'").execute().get()).get(0).toString().contains("coords_idx"));
}
