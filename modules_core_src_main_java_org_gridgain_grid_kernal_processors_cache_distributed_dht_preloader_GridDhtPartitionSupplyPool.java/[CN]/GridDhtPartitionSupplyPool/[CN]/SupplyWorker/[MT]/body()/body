{
  while (!isCancelled()) {
    DemandMessage<K,V> msg=poll(queue,this);
    if (msg == null)     continue;
    GridNode node=cctx.discovery().node(msg.senderId());
    if (node == null) {
      if (log.isDebugEnabled())       log.debug("Received message from non-existing node (will ignore): " + msg);
      continue;
    }
    processMessage(msg,node);
  }
}
