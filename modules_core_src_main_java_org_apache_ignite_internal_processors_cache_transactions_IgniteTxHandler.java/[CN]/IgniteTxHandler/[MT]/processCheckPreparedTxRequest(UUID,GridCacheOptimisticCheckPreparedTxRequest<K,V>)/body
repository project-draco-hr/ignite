{
  if (log.isDebugEnabled())   log.debug("Processing check prepared transaction requests [nodeId=" + nodeId + ", req="+ req+ ']');
  boolean prepared=ctx.tm().txsPreparedOrCommitted(req.nearXidVersion(),req.transactions());
  GridCacheOptimisticCheckPreparedTxResponse<K,V> res=new GridCacheOptimisticCheckPreparedTxResponse<>(req.version(),req.futureId(),req.miniId(),prepared);
  try {
    if (log.isDebugEnabled())     log.debug("Sending check prepared transaction response [nodeId=" + nodeId + ", res="+ res+ ']');
    ctx.io().send(nodeId,res,req.system() ? UTILITY_CACHE_POOL : SYSTEM_POOL);
  }
 catch (  ClusterTopologyCheckedException ignored) {
    if (log.isDebugEnabled())     log.debug("Failed to send check prepared transaction response (did node leave grid?) [nodeId=" + nodeId + ", res="+ res+ ']');
  }
catch (  IgniteCheckedException e) {
    U.error(log,"Failed to send response to node [nodeId=" + nodeId + ", res="+ res+ ']',e);
  }
}
