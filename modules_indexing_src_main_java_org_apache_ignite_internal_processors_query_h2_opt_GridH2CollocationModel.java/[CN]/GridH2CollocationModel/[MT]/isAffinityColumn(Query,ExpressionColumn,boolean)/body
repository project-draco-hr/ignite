{
  if (qry.isUnion()) {
    SelectUnion union=(SelectUnion)qry;
    return isAffinityColumn(union.getLeft(),expCol,validate) && isAffinityColumn(union.getRight(),expCol,validate);
  }
  Expression exp=qry.getExpressions().get(expCol.getColumn().getColumnId()).getNonAliasExpression();
  if (exp instanceof ExpressionColumn) {
    expCol=(ExpressionColumn)exp;
    return isAffinityColumn(expCol.getTableFilter(),expCol,validate);
  }
  return false;
}
