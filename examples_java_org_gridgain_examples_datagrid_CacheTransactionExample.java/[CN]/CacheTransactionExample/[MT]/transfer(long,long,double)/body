{
  if (fromId == toId)   return;
  GridCacheProjection<Long,Account> cache=GridGain.grid().<Long,Account>cache(CACHE_NAME).flagsOn(CLONE);
  try (GridCacheTx tx=cache.txStart(PESSIMISTIC,REPEATABLE_READ)){
    Account fromAcct;
    Account toAcct;
    if (fromId < toId) {
      fromAcct=cache.get(fromId);
      toAcct=cache.get(toId);
    }
 else {
      toAcct=cache.get(toId);
      fromAcct=cache.get(fromId);
    }
    fromAcct.update(-amount);
    toAcct.update(amount);
    cache.putx(fromId,fromAcct);
    cache.putx(toId,toAcct);
    tx.commit();
  }
   System.out.println();
  System.out.println(">>> Transferred amount: $" + amount);
}
