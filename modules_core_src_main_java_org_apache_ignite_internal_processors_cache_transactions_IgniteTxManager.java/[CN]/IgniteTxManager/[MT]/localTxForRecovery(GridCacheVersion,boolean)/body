{
  IgniteInternalTx tx=idMap.get(nearXidVer);
  if (tx == null) {
    for (    IgniteInternalTx txEx : idMap.values()) {
      if (nearXidVer.equals(txEx.nearXidVersion())) {
        if (!markFinalizing || !txEx.markFinalizing(RECOVERY_WAIT))         tx=txEx;
      }
    }
  }
  if (tx != null && tx.local())   return tx;
  return null;
}
