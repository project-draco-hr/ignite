{
  GridCompoundFuture<IgniteInternalTx,Boolean> res=new GridCompoundFuture<>(context().kernalContext(),new IgniteReducer<IgniteInternalTx,Boolean>(){
    @Override public boolean collect(    IgniteInternalTx e){
      return true;
    }
    @Override public Boolean reduce(){
      return true;
    }
  }
);
  for (  IgniteInternalTx<K,V> tx : txs()) {
    if (tx.concurrency() == PESSIMISTIC) {
      if (tx.topologyVersion() > 0 && tx.topologyVersion() < topVer)       res.add(tx.finishFuture());
    }
 else     if (tx.concurrency() == OPTIMISTIC) {
      TransactionState state=tx.state();
      long txTopVer=tx.topologyVersion();
      if ((state == PREPARING || state == PREPARED || state == COMMITTING) && txTopVer > 0 && txTopVer < topVer) {
        res.add(tx.finishFuture());
      }
    }
  }
  res.markInitialized();
  return res;
}
