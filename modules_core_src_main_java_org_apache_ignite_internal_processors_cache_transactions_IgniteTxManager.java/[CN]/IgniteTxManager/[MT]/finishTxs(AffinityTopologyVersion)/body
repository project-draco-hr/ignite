{
  GridCompoundFuture<IgniteInternalTx,Boolean> res=new GridCompoundFuture<>(new IgniteReducer<IgniteInternalTx,Boolean>(){
    @Override public boolean collect(    IgniteInternalTx e){
      return true;
    }
    @Override public Boolean reduce(){
      return true;
    }
  }
);
  for (  IgniteInternalTx tx : txs()) {
    if (tx.concurrency() == PESSIMISTIC) {
      if (tx.topologyVersion().compareTo(AffinityTopologyVersion.ZERO) > 0 && tx.topologyVersion().compareTo(topVer) < 0)       res.add(tx.finishFuture());
    }
 else     if (tx.concurrency() == OPTIMISTIC) {
      TransactionState state=tx.state();
      AffinityTopologyVersion txTopVer=tx.topologyVersion();
      if ((state == PREPARING || state == PREPARED || state == COMMITTING) && txTopVer.compareTo(AffinityTopologyVersion.ZERO) > 0 && txTopVer.compareTo(topVer) < 0) {
        res.add(tx.finishFuture());
      }
    }
  }
  res.markInitialized();
  return res;
}
