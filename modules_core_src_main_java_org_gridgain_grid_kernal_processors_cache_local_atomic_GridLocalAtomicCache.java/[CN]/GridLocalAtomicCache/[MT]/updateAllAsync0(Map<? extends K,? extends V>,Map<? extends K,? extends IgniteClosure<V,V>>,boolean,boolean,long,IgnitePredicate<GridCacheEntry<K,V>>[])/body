{
  final GridCacheOperation op=transformMap != null ? TRANSFORM : UPDATE;
  final Collection<? extends K> keys=map != null ? map.keySet() : transformMap != null ? transformMap.keySet() : null;
  final Collection<?> vals=map != null ? map.values() : transformMap != null ? transformMap.values() : null;
  final boolean storeEnabled=ctx.isStoreEnabled();
  final ExpiryPolicy expiry=expiryPerCall();
  return asyncOp(new Callable<Object>(){
    @Override public Object call() throws Exception {
      return updateAllInternal(op,keys,vals,expiry,retval,rawRetval,filter,storeEnabled);
    }
  }
);
}
