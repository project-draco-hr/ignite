{
  if (arr != null) {
    if (it == null) {
      writeInt(arr.length);
      if (!lastFinished)       return;
      it=arrayIterator(arr);
    }
    Type itemType=type(itemCls);
    while (it.hasNext() || cur != NULL) {
      if (cur == NULL) {
        cur=it.next();
        if (cur != null && itemType == Type.MSG)         cur=((MessageAdapter)cur).clone();
      }
      write(itemType,cur);
      if (!lastFinished)       return;
      cur=NULL;
    }
    it=null;
  }
 else   writeInt(-1);
}
