{
  for (  GridCache<Integer,String> cache : caches) {
    Iterable<Integer> keys=primaryKeysForCache(cache,100);
    info("Values [cache=" + caches.indexOf(cache) + ", size="+ F.size(keys.iterator())+ ", keys="+ keys+ "]");
    for (    Integer key : keys)     map.put(key,"val" + key);
  }
  Collection<GridCache<Integer,String>> emptyCaches=new ArrayList<>(caches);
  for (  GridCache<Integer,String> cache : caches) {
    info("Reloading cache: " + caches.indexOf(cache));
    if (!nearEnabled()) {
      for (      GridCache<Integer,String> eCache : emptyCaches)       assertEquals("Non-null values found in cache [cache=" + caches.indexOf(eCache) + ", size="+ eCache.size()+ ", size="+ eCache.size()+ ", entrySetSize="+ eCache.entrySet().size()+ "]",0,eCache.size());
    }
    cache.reloadAll(map.keySet());
    for (    Integer key : map.keySet()) {
      GridCacheEntry entry=cache.entry(key);
      if (entry.primary() || entry.backup() || nearEnabled())       assertEquals(map.get(key),cache.peek(key));
 else       assertNull(cache.peek(key));
    }
    emptyCaches.remove(cache);
  }
}
