{
  IgniteCache<Integer,Value> cache=grid().createCache("test-cache");
  try {
    for (int i=0; i < 50; i++)     cache.put(i,new Value("str" + i,i * 100));
    IgniteCache<Integer,BinaryObject> binaryCache=cache.withKeepBinary();
    IgniteClosure<Cache.Entry<Integer,BinaryObject>,Integer> transformer=new IgniteClosure<Cache.Entry<Integer,BinaryObject>,Integer>(){
      @Override public Integer apply(      Cache.Entry<Integer,BinaryObject> e){
        return e.getValue().field("idx");
      }
    }
;
    List<Integer> res=binaryCache.query(new ScanQuery<Integer,BinaryObject>(),transformer).getAll();
    assertEquals(50,res.size());
    Collections.sort(res);
    for (int i=0; i < 50; i++)     assertEquals(i * 100,res.get(i).intValue());
  }
  finally {
    cache.destroy();
  }
}
