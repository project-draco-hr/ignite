{
  lock.lock();
  try {
    cancelled=true;
    if (curBatch != null)     curBatch.finish();
    if (nextBatch != null)     nextBatch.finish();
    cond.signalAll();
  }
  finally {
    lock.unlock();
  }
}
