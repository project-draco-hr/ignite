{
  try {
    awaitPartitionMapExchange();
    doTestDeadlock(2,false,true,true,transformer);
    doTestDeadlock(2,false,false,false,transformer);
    doTestDeadlock(2,false,false,true,transformer);
    doTestDeadlock(3,false,true,true,transformer);
    doTestDeadlock(3,false,false,false,transformer);
    doTestDeadlock(3,false,false,true,transformer);
    doTestDeadlock(4,false,true,true,transformer);
    doTestDeadlock(4,false,false,false,transformer);
    doTestDeadlock(4,false,false,true,transformer);
  }
 catch (  Exception e) {
    U.error(log,"Unexpected exception: ",e);
    fail();
  }
 finally {
    if (cache != null)     cache.destroy();
  }
}
