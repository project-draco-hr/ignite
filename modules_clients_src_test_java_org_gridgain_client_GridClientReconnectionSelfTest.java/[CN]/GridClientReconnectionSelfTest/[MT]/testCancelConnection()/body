{
  for (int i=0; i < 5; i++) {
    final CountDownLatch returnLatch=new CountDownLatch(1);
    Thread testThread=new Thread("client-interruption-test-thread"){
      @Override public void run(){
        try {
          client("ya.ru");
        }
 catch (        Exception e) {
          assertTrue("Thrown exception doesn't have an expected cause: " + ExceptionUtils.getStackTrace(e),X.hasCause(e,GridClientConnectionResetException.class) || "Client startup was interrupted.".equals(e.getMessage()));
        }
 finally {
          returnLatch.countDown();
        }
      }
    }
;
    testThread.start();
    Thread.sleep(i * 1500);
    testThread.interrupt();
    if (i == 0)     assertTrue(returnLatch.await(2,TimeUnit.SECONDS));
 else     assertTrue(returnLatch.await(100,TimeUnit.MILLISECONDS));
  }
}
