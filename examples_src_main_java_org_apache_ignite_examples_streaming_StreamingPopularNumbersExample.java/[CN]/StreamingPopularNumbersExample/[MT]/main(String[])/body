{
  Timer popularNumbersQryTimer=new Timer("numbers-query-worker");
  final Ignite ignite=Ignition.start("examples/config/example-streamer.xml");
  System.out.println();
  System.out.println(">>> Streaming popular numbers example started.");
  try {
    TimerTask task=scheduleQuery(ignite,popularNumbersQryTimer);
    streamData(ignite);
    task.run();
    popularNumbersQryTimer.cancel();
    ignite.compute().broadcast(new Runnable(){
      @Override public void run(){
        if (!ExamplesUtils.hasStreamer(ignite,"popular-numbers"))         System.err.println("Default streamer not found (is example-streamer.xml " + "configuration used on all nodes?)");
 else {
          IgniteStreamer streamer=ignite.streamer("popular-numbers");
          System.out.println("Clearing number counters from streamer.");
          streamer.reset();
        }
      }
    }
);
  }
  finally {
    Ignition.stop(true);
  }
}
