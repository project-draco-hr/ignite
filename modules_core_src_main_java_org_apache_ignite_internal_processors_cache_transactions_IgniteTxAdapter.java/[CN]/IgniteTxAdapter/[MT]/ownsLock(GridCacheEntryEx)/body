{
  GridCacheContext<?,?> cacheCtx=entry.context();
  IgniteTxEntry txEntry=entry(entry.txKey());
  GridCacheVersion explicit=txEntry == null ? null : txEntry.explicitVersion();
  return local() && !cacheCtx.isDht() ? entry.lockedByThread(threadId()) || (explicit != null && entry.lockedBy(explicit)) : !entry.hasLockCandidate(xidVersion()) || entry.lockedBy(xidVersion());
}
