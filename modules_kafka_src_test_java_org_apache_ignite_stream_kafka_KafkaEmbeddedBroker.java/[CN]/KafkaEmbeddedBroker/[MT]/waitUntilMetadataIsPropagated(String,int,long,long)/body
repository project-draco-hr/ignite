{
  int attempt=1;
  final long startTime=System.currentTimeMillis();
  while (true) {
    if (isMetadataPropagated(topic,partition))     return;
    final long duration=System.currentTimeMillis() - startTime;
    if (duration < timeout)     Thread.sleep(interval);
 else     throw new TimeoutException("metadata propagate timed out, attempt=" + attempt);
    attempt++;
  }
}
