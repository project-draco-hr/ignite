{
  rmtNodes.clear();
synchronized (mux) {
    spiState=LEFT;
  }
  Socket sock=sockRdr.sock;
  if (!fail) {
    try {
      GridTcpDiscoveryNodeLeftMessage msg=new GridTcpDiscoveryNodeLeftMessage(locNodeId);
      msg.client(true);
      writeToSocket(sock,msg);
    }
 catch (    IOException|GridException e) {
      if (log.isDebugEnabled())       U.error(log,"Failed to send node left message (will stop anyway) [sock=" + sock + ']',e);
    }
  }
  closeConnection();
  U.interrupt(sockTimeoutWorker);
  U.join(sockTimeoutWorker,log);
  if (log.isDebugEnabled())   log.debug(stopInfo());
}
