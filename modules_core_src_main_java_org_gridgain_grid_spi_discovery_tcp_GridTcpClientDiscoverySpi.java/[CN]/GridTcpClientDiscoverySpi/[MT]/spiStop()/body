{
  rmtNodes.clear();
  U.interrupt(disconnectHnd);
  U.join(disconnectHnd,log);
  Socket sock0=sock;
  if (sock0 != null) {
    try {
      GridTcpDiscoveryNodeLeftMessage msg=new GridTcpDiscoveryNodeLeftMessage(locNodeId);
      msg.client(true);
      writeToSocket(sock0,msg);
    }
 catch (    IOException|GridException e) {
      if (log.isDebugEnabled())       U.error(log,"Failed to send node left message (will stop anyway) [sock=" + sock0 + ']',e);
    }
    U.closeQuiet(sock);
  }
  U.interrupt(hbSender);
  U.join(hbSender,log);
  U.interrupt(sockRdr);
  U.join(sockRdr,log);
  U.interrupt(sockTimeoutWorker);
  U.join(sockTimeoutWorker,log);
  if (log.isDebugEnabled())   log.debug(stopInfo());
}
