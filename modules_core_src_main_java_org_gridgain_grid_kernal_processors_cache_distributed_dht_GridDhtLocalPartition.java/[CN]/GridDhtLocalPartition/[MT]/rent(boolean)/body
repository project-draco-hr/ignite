{
  while (true) {
    int reservations=state.getStamp();
    GridDhtPartitionState s=state.getReference();
    if (s == RENTING || s == EVICTED)     return rent;
    if (state.compareAndSet(s,RENTING,reservations,reservations)) {
      if (log.isDebugEnabled())       log.debug("Moved partition to RENTING state: " + this);
      tryEvictAsync(updateSeq);
      break;
    }
  }
  return rent;
}
