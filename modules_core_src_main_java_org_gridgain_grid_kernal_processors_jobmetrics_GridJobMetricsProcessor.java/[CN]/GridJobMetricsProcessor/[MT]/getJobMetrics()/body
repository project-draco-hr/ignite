{
  long now=U.currentTimeMillis();
  SnapshotReducer rdc=new SnapshotReducer();
  InternalMetrics im=metrics;
  for (  SnapshotsQueue q : im.snapshotsQueues)   q.reduce(rdc,now);
  GridJobMetrics m=rdc.reduce();
  m.setCurrentIdleTime(im.curIdleTime);
  m.setTotalIdleTime(im.totalIdleTime);
  return m;
}
