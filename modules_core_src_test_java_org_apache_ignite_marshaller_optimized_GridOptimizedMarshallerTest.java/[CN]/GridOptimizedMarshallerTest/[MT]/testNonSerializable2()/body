{
  GridOptimizedMarshaller marsh=new GridOptimizedMarshaller();
  marsh.setRequireSerializable(false);
  GridTcpDiscoveryIpFinderAdapter ipFinder=new GridTcpDiscoveryIpFinderAdapter(){
    @Override public Collection<InetSocketAddress> getRegisteredAddresses(){
      return null;
    }
    @Override public void registerAddresses(    Collection<InetSocketAddress> addrs){
    }
    @Override public void unregisterAddresses(    Collection<InetSocketAddress> addrs){
    }
  }
;
  ipFinder.setShared(false);
  byte[] bytes=marsh.marshal(ipFinder);
  ipFinder=marsh.unmarshal(bytes,null);
  assertFalse(ipFinder.isShared());
}
