{
  Object obj=new SomeSerializable(null);
  ((Map)U.staticField(IgniteOptimizedMarshallerUtils.class,"CLS_DESC_CACHE")).clear();
  IgniteOptimizedClassResolver.userClasses(null,null);
  IgniteMarshaller marsh=new IgniteOptimizedMarshaller();
  int size1=marsh.marshal(obj).length;
  ((Map)U.staticField(IgniteOptimizedMarshallerUtils.class,"CLS_DESC_CACHE")).clear();
  IgniteOptimizedClassResolver.userClasses(null,null);
  IgniteOptimizedMarshaller marshPreregistered=new IgniteOptimizedMarshaller();
  marshPreregistered.setClassNames(Arrays.asList(SomeSerializable.class.getName()));
  int size2=marshPreregistered.marshal(obj).length;
  assertTrue(size1 > size2);
}
