{
  try {
    Ignite ignite=startGridsMultiThreaded(2);
    String taskClsName="org.gridgain.grid.tests.p2p.GridSingleSplitTestTask";
    String jobClsName="org.gridgain.grid.tests.p2p.GridSingleSplitTestTask$GridSingleSplitTestJob";
    ClassLoader ldr=getExternalClassLoader();
    Class<? extends ComputeTask<?,?>> taskCls=(Class<? extends ComputeTask<?,?>>)ldr.loadClass(taskClsName);
    Class<? extends ComputeTask<?,?>> jobCls=(Class<? extends ComputeTask<?,?>>)ldr.loadClass(jobClsName);
    ignite.compute().localDeployTask(taskCls,ldr);
    ignite.compute().execute(taskClsName,2);
    ConcurrentMap<Class<?>,IgniteOptimizedClassDescriptor> cache=U.staticField(IgniteOptimizedMarshallerUtils.class,"CLS_DESC_CACHE");
    assertTrue(cache.containsKey(jobCls));
    ignite.compute().undeployTask(taskClsName);
    Thread.sleep(1000);
    assertFalse(cache.containsKey(jobCls));
  }
  finally {
    stopAllGrids();
  }
}
