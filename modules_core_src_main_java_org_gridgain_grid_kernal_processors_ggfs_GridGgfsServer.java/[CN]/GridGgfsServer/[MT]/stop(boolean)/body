{
  if (srvEndpoint == null)   return;
  U.cancel(acceptWorker);
  U.join(acceptWorker,log);
  try {
    hnd.stop();
  }
 catch (  IgniteCheckedException e) {
    U.error(log,"Failed to stop GGFS server handler (will close client connections anyway).",e);
  }
  for (  ClientWorker worker : clientWorkers)   U.cancel(worker);
  U.join(clientWorkers,log);
  if (srvEndpoint.getPort() >= 0)   ggfsCtx.kernalContext().ports().deregisterPort(srvEndpoint.getPort(),TCP,srvEndpoint.getClass());
  try {
    ggfsCtx.kernalContext().resource().cleanupGeneric(srvEndpoint);
  }
 catch (  IgniteCheckedException e) {
    U.error(log,"Failed to cleanup server endpoint.",e);
  }
}
