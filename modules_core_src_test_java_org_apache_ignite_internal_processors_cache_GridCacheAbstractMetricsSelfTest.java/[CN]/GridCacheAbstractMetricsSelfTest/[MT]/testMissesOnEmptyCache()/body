{
  GridCache<Integer,Integer> cache=grid(0).cache(null);
  if (cache.configuration().getCacheMode() == CacheMode.REPLICATED)   return;
  Integer key=null;
  for (int i=0; i < 1000; i++) {
    if (cache.affinity().isPrimary(grid(0).localNode(),i)) {
      key=i;
      break;
    }
  }
  assertNotNull(key);
  cache.get(key);
  assertEquals("Expected 1 read",1,cache.metrics().reads());
  assertEquals("Expected 1 miss",1,cache.metrics().misses());
  cache.put(key,key);
  cache.get(key);
  assertEquals("Expected 1 write",1,cache.metrics().writes());
  assertEquals("Expected 3 reads",3,cache.metrics().reads());
  assertEquals("Expected 2 misses",2,cache.metrics().misses());
  assertEquals("Expected 1 hit",1,cache.metrics().hits());
}
