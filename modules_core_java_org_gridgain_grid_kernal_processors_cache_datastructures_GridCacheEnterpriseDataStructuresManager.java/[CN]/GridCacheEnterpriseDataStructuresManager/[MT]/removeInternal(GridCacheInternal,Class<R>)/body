{
  return CU.outTx(new Callable<Boolean>(){
    @Override public Boolean call() throws Exception {
      GridCacheTx tx=CU.txStartInternal(cctx,dsView,PESSIMISTIC,REPEATABLE_READ);
      try {
        R val=cast(dsView.get(key),cls);
        if (val != null) {
          dsView.removex(key);
          tx.commit();
        }
 else         tx.setRollbackOnly();
        return val != null;
      }
 catch (      Error|Exception e) {
        U.error(log,"Failed to remove data structure: " + key,e);
        throw e;
      }
 finally {
        tx.end();
      }
    }
  }
,cctx);
}
