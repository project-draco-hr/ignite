{
  while (!isCancelled()) {
    GridCacheInternal key=queueDelCands.poll(1000,TimeUnit.MILLISECONDS);
    if (key != null) {
      try {
        GridCacheTx tx=CU.txStartInternal(cctx,dsView,PESSIMISTIC,REPEATABLE_READ);
        try {
          GridCacheQueueHeader hdr=cast(dsView.get(key),GridCacheQueueHeader.class);
          GridCacheQueueEx queue=cast(dsMap.get(key),GridCacheQueueEx.class);
          if (hdr == null && queue != null) {
            queue.onRemoved();
            dsMap.remove(key);
          }
          tx.commit();
        }
  finally {
          tx.end();
        }
      }
 catch (      Exception e) {
        U.warn(log,"Failed to check queue for existence: " + e);
      }
    }
  }
}
