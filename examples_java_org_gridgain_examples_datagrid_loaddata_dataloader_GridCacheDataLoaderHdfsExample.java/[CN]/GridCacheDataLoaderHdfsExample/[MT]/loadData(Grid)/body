{
  final GridDataLoader<UUID,Person> ldr=grid.dataLoader(CACHE_NAME);
  ldr.perNodeBufferSize(2);
  ldr.isolated(true);
  System.out.println(">>>");
  System.out.println(">>> Using data loader for cache: " + ldr.cacheName());
  System.out.println(">>>");
  FileSystem fs=null;
  try {
    exec=Executors.newFixedThreadPool(HDFS_WORKERS_CNT);
    Configuration cfg=new Configuration();
    fs=FileSystem.get(cfg);
    Path path=path(fs);
    if (!fs.exists(path))     return;
    Queue<Future<?>> futs=new LinkedList<>();
    walk(fs,path,ldr,futs);
    for (Future<?> f=futs.poll(); f != null; f=futs.poll())     f.get();
    ldr.close(false);
  }
  finally {
    closeQuiet(fs);
    exec.shutdownNow();
    exec.awaitTermination(2000,MILLISECONDS);
  }
}
