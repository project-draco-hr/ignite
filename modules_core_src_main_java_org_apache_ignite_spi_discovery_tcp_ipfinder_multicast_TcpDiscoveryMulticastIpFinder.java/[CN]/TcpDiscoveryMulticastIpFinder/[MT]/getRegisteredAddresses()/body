{
  if (mcastAddr != null && reqItfs != null) {
    Collection<InetSocketAddress> ret;
    if (reqItfs.size() > 1)     ret=requestAddresses(reqItfs);
 else {
      T2<Collection<InetSocketAddress>,Boolean> res=requestAddresses(mcastAddr,F.first(reqItfs));
      ret=res.get1();
      mcastErr|=res.get2();
    }
    if (ret.isEmpty()) {
      if (mcastErr && firstReq) {
        if (getRegisteredAddresses().isEmpty()) {
          InetSocketAddress addr=new InetSocketAddress("localhost",TcpDiscoverySpi.DFLT_PORT);
          U.quietAndWarn(log,"TcpDiscoveryMulticastIpFinder failed to initialize multicast, " + "will use default address: " + addr);
          registerAddresses(Collections.singleton(addr));
        }
 else         U.quietAndWarn(log,"TcpDiscoveryMulticastIpFinder failed to initialize multicast, " + "will use pre-configured addresses.");
      }
    }
 else     registerAddresses(ret);
    firstReq=false;
  }
  return super.getRegisteredAddresses();
}
