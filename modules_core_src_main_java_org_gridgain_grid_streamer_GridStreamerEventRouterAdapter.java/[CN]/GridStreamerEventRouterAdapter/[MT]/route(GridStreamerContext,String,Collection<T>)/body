{
  if (evts.size() == 1) {
    ClusterNode route=route(ctx,stageName,F.first(evts));
    if (route == null)     return null;
    return Collections.singletonMap(route,evts);
  }
  Map<ClusterNode,Collection<T>> map=new GridLeanMap<>();
  for (  T e : evts) {
    ClusterNode n=route(ctx,stageName,e);
    if (n == null)     return null;
    Collection<T> mapped=map.get(n);
    if (mapped == null)     map.put(n,mapped=new ArrayList<>());
    mapped.add(e);
  }
  return map;
}
