{
  Byte flag=PLAIN_CLASS_TO_FLAG.get(val.getClass());
  if (flag == null)   throw new IllegalArgumentException("Can't write object with type: " + val.getClass());
switch (flag) {
case BYTE:
    writer.writeByte(flag);
  writer.writeByte((Byte)val);
break;
case SHORT:
writer.writeByte(flag);
writer.writeShort((Short)val);
break;
case INT:
writer.writeByte(flag);
writer.writeInt((Integer)val);
break;
case LONG:
writer.writeByte(flag);
writer.writeLong((Long)val);
break;
case FLOAT:
writer.writeByte(flag);
writer.writeFloat((Float)val);
break;
case DOUBLE:
writer.writeByte(flag);
writer.writeDouble((Double)val);
break;
case CHAR:
writer.writeByte(flag);
writer.writeChar((Character)val);
break;
case BOOLEAN:
writer.writeByte(flag);
writer.writeBoolean((Boolean)val);
break;
case DECIMAL:
writer.doWriteDecimal((BigDecimal)val);
break;
case STRING:
writer.doWriteString((String)val);
break;
case UUID:
writer.doWriteUuid((UUID)val);
break;
case DATE:
writer.doWriteDate((Date)val);
break;
case TIMESTAMP:
writer.doWriteTimestamp((Timestamp)val);
break;
case BYTE_ARR:
writer.doWriteByteArray((byte[])val);
break;
case SHORT_ARR:
writer.doWriteShortArray((short[])val);
break;
case INT_ARR:
writer.doWriteIntArray((int[])val);
break;
case LONG_ARR:
writer.doWriteLongArray((long[])val);
break;
case FLOAT_ARR:
writer.doWriteFloatArray((float[])val);
break;
case DOUBLE_ARR:
writer.doWriteDoubleArray((double[])val);
break;
case CHAR_ARR:
writer.doWriteCharArray((char[])val);
break;
case BOOLEAN_ARR:
writer.doWriteBooleanArray((boolean[])val);
break;
case DECIMAL_ARR:
writer.doWriteDecimalArray((BigDecimal[])val);
break;
case STRING_ARR:
writer.doWriteStringArray((String[])val);
break;
case UUID_ARR:
writer.doWriteUuidArray((UUID[])val);
break;
case DATE_ARR:
writer.doWriteDateArray((Date[])val);
break;
case TIMESTAMP_ARR:
writer.doWriteTimestampArray((Timestamp[])val);
break;
default :
throw new IllegalArgumentException("Can't write object with type: " + val.getClass());
}
}
