{
  InetAddress locHost=InetAddress.getByName("127.0.0.1");
  try (GridTcpForwarder tcpForward1=new GridTcpForwarder(locHost,extPort1,locHost,locPort1);GridTcpForwarder tcpForward2=new GridTcpForwarder(locHost,extPort2,locHost,locPort2);GridTcpForwarder tcpForward3=new GridTcpForwarder(locHost,commExtPort1,locHost,commLocPort1);GridTcpForwarder tcpForward4=new GridTcpForwarder(locHost,commExtPort2,locHost,commLocPort2);Grid g1=startGrid(0);Grid g2=startGrid(1)){
    assertEquals(2,grid(0).nodes().size());
    assertEquals(2,grid(1).nodes().size());
    Collection<Integer> t=g1.compute().broadcast(new Callable<Integer>(){
      @Override public Integer call() throws Exception {
        return 13;
      }
    }
).get();
    assertEquals(F.asList(13,13),t);
  }
 }
