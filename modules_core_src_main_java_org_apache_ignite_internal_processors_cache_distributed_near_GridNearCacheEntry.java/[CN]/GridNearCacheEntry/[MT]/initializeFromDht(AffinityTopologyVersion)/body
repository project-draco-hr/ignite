{
  while (true) {
    GridDhtCacheEntry entry=cctx.near().dht().peekExx(key);
    if (entry != null) {
      GridCacheEntryInfo e=entry.info();
      if (e != null) {
        GridCacheVersion enqueueVer=null;
        try {
synchronized (this) {
            checkObsolete();
            if (isNew() || !valid(topVer)) {
              update(e.value(),e.expireTime(),e.ttl(),e.isNew() ? ver : e.version(),true);
              if (cctx.deferredDelete() && !isNew() && !isInternal()) {
                boolean deleted=val == null;
                if (deleted != deletedUnlocked()) {
                  deletedUnlocked(deleted);
                  if (deleted)                   enqueueVer=e.version();
                }
              }
              ClusterNode primaryNode=cctx.affinity().primary(key,topVer);
              if (primaryNode == null)               this.topVer=-1L;
 else               recordNodeId(primaryNode.id(),topVer);
              dhtVer=e.isNew() || e.isDeleted() ? null : e.version();
              return true;
            }
            return false;
          }
        }
  finally {
          if (enqueueVer != null)           cctx.onDeferredDelete(this,enqueueVer);
        }
      }
    }
 else     return false;
  }
}
