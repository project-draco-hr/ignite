{
  try (final IgniteDataLoader<K,V> ldr=ctx.kernalContext().<K,V>dataLoad().dataLoader(ctx.namex(),false)){
    ldr.updater(new SkipStoreUpdater<K,V>());
    final Collection<Map.Entry<K,V>> col=new ArrayList<>(ldr.perNodeBufferSize());
    ctx.store().loadAllFromStore(null,keys,new CIX2<K,V>(){
      @Override public void applyx(      K key,      V val) throws IgniteCheckedException {
        if (ctx.portableEnabled()) {
          key=(K)ctx.marshalToPortable(key);
          val=(V)ctx.marshalToPortable(val);
        }
        col.add(new GridMapEntry<>(key,val));
        if (col.size() == ldr.perNodeBufferSize()) {
          ldr.addData(col);
          col.clear();
        }
      }
    }
);
    if (!col.isEmpty())     ldr.addData(col);
  }
 }
