{
  A.notNull(key,"key");
  if (keyCheck)   validateCacheKey(key);
  ctx.checkSecurity(GridSecurityPermission.CACHE_READ);
  GridCacheEntryEx<K,V> e=peekEx(key);
  try {
    if (e != null) {
      GridTuple<V> peek=e.peek0(failFast,mode,filter,ctx.tm().localTxx());
      if (peek != null)       return F.t(ctx.cloneOnFlag(peek.get()));
    }
    GridCacheTxEx<K,V> tx=ctx.tm().localTx();
    if (tx != null) {
      GridTuple<V> peek=tx.peek(failFast,key,filter);
      if (peek != null)       return F.t(ctx.cloneOnFlag(peek.get()));
    }
    return null;
  }
 catch (  GridCacheEntryRemovedException ignore) {
    if (log.isDebugEnabled())     log.debug("Got removed entry during 'peek': " + e);
    return null;
  }
catch (  GridException ex) {
    throw new GridRuntimeException(ex);
  }
}
