{
  long start=System.currentTimeMillis();
  ClassLoader old=GridHadoopJobClassLoadingContext.prepareClassLoader(ctxs.get(job.id()),job.info());
  try (GridHadoopTaskOutput out=createOutput(info);GridHadoopTaskInput in=createInput(info)){
    GridHadoopTaskContext taskCtx=new GridHadoopTaskContext(job,in,out);
    GridHadoopTask task=job.createTask(info);
    if (log.isDebugEnabled())     log.debug("Running task: " + task);
    task.run(taskCtx);
  }
 catch (  Exception e) {
    U.error(log,"Failed to execute task: " + info,e);
    throw e;
  }
 finally {
    Thread.currentThread().setContextClassLoader(old);
    long end=System.currentTimeMillis();
    if (log.isDebugEnabled())     log.debug("Finished task execution [jobId=" + job.id() + ", taskInfo="+ info+ ", "+ "execTime="+ (end - start)+ ']');
  }
}
