{
  if (nearEnabled())   assertEquals("Invalid key size: " + jcache().localSize(ALL),keys.size(),jcache().localSize(ALL));
 else {
    for (int i=0; i < gridCount(); i++) {
      executeOnLocalOrRemoteJvm(i,new TestIgniteIdxRunnable(){
        @Override public void run(        int idx) throws Exception {
          GridCacheContext<String,Integer> ctx=context(idx);
          int size=0;
          for (          String key : keys)           if (ctx.affinity().localNode(key,ctx.discovery().topologyVersionEx()))           size++;
          assertEquals("Incorrect key size on cache #" + idx,size,jcache(idx).localSize(ALL));
        }
      }
);
    }
  }
}
