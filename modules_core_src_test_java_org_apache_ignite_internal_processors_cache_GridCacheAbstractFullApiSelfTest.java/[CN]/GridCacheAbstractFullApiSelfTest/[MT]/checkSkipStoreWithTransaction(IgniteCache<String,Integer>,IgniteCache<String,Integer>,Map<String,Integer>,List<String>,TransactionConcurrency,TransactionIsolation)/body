{
  cache.removeAll();
  assertTrue(cache.size(CachePeekMode.ALL) == 0);
  assertTrue(cacheSkipStore.size(CachePeekMode.ALL) == 0);
  assertTrue(map.size() == 0);
  IgniteTransactions txs=grid(0).transactions();
  Transaction tx=txs.txStart(txConcurrency,txIsolation);
  for (int i=0; i < keys.size(); i++)   cacheSkipStore.put(keys.get(i),i);
  for (  String key : keys) {
    assertNotNull(cacheSkipStore.get(key));
    assertNotNull(cache.get(key));
    assertFalse(map.containsKey(key));
  }
  tx.commit();
  tx=txs.txStart(txConcurrency,txIsolation);
  cacheSkipStore.putAll(data);
  for (  String key : keys) {
    assertNotNull(cacheSkipStore.get(key));
    assertNotNull(cache.get(key));
    assertFalse(map.containsKey(key));
  }
  tx.commit();
}
