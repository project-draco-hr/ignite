{
  GridCacheProjectionEx<String,Integer> c=(GridCacheProjectionEx<String,Integer>)cache();
  final int cnt=10;
  for (int i=0; i < cnt; i++)   assertNull(c.putIfAbsent("k" + i,i));
  for (int i=0; i < cnt; i++) {
    boolean wrong=i % 2 == 0;
    String key="k" + i;
    GridCacheReturn<Integer> res=c.replacex(key,wrong ? i + 1 : i,-1);
    assertTrue(wrong != res.success());
    if (wrong)     assertEquals(c.get(key),res.value());
  }
  for (int i=0; i < cnt; i++) {
    boolean success=i % 2 != 0;
    String key="k" + i;
    GridCacheReturn<Integer> res=c.removex(key,-1);
    assertTrue(success == res.success());
    if (!success)     assertEquals(c.get(key),res.value());
  }
}
