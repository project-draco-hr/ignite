{
  cache().putx("key1",100);
  IgniteTx tx=txEnabled() ? cache().txStart(concurrency,isolation) : null;
  try {
    assertEquals((Integer)100,cache().put("key1",101,F.<Entry<String,Integer>>alwaysTrue()));
    assertEquals((Integer)101,cache().get("key1"));
    cache().put("key1",102,F.<Entry<String,Integer>>alwaysFalse());
    assertEquals((Integer)101,cache().get("key1"));
    if (tx != null)     tx.commit();
  }
  finally {
    if (tx != null)     tx.close();
  }
  boolean passed=false;
  for (int i=0; i < gridCount(); i++)   passed|=containsKey(cache(i),"key1");
  assert passed;
  assertEquals((Integer)101,cache().get("key1"));
}
