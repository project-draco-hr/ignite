{
  PortableMarshaller marsh=new PortableMarshaller();
  BinaryTypeConfiguration customType1=new BinaryTypeConfiguration(Value.class.getName());
  customType1.setIdMapper(new BinaryTypeIdMapper(){
    @Override public int typeId(    String clsName){
      return 300;
    }
    @Override public int fieldId(    int typeId,    String fieldName){
      return 0;
    }
  }
);
  BinaryTypeConfiguration customType2=new BinaryTypeConfiguration("org.gridgain.NonExistentClass1");
  customType2.setIdMapper(new BinaryTypeIdMapper(){
    @Override public int typeId(    String clsName){
      return 400;
    }
    @Override public int fieldId(    int typeId,    String fieldName){
      return 0;
    }
  }
);
  BinaryTypeConfiguration customType3=new BinaryTypeConfiguration("NonExistentClass2");
  customType3.setIdMapper(new BinaryTypeIdMapper(){
    @Override public int typeId(    String clsName){
      return 500;
    }
    @Override public int fieldId(    int typeId,    String fieldName){
      return 0;
    }
  }
);
  BinaryTypeConfiguration customType4=new BinaryTypeConfiguration("NonExistentClass5");
  customType4.setIdMapper(new BinaryTypeIdMapper(){
    @Override public int typeId(    String clsName){
      return 0;
    }
    @Override public int fieldId(    int typeId,    String fieldName){
      return 0;
    }
  }
);
  marsh.setTypeConfigurations(Arrays.asList(new BinaryTypeConfiguration(Key.class.getName()),new BinaryTypeConfiguration("org.gridgain.NonExistentClass3"),new BinaryTypeConfiguration("NonExistentClass4"),customType1,customType2,customType3,customType4));
  PortableContext ctx=initPortableContext(marsh);
  assertEquals("notconfiguredclass".hashCode(),ctx.typeId("NotConfiguredClass"));
  assertEquals("key".hashCode(),ctx.typeId("Key"));
  assertEquals("nonexistentclass3".hashCode(),ctx.typeId("NonExistentClass3"));
  assertEquals("nonexistentclass4".hashCode(),ctx.typeId("NonExistentClass4"));
  assertEquals(300,ctx.typeId(getClass().getSimpleName() + "$Value"));
  assertEquals(400,ctx.typeId("NonExistentClass1"));
  assertEquals(500,ctx.typeId("NonExistentClass2"));
  assertEquals("nonexistentclass5".hashCode(),ctx.typeId("NonExistentClass5"));
}
