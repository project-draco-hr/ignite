{
  init();
  if (log.isDebugEnabled())   log.debug("Store put [key=" + key + ", val="+ val+ ", tx="+ tx+ ']');
  if (val == null) {
    remove(tx,key);
    return;
  }
  Session ses=session(tx);
  try {
    GridCacheHibernateBlobStoreEntry entry=new GridCacheHibernateBlobStoreEntry(toBytes(key),toBytes(val));
    ses.saveOrUpdate(entry);
  }
 catch (  HibernateException e) {
    rollback(ses,tx);
    throw new GridException("Failed to put value to cache store [key=" + key + ", val"+ val+ "]",e);
  }
 finally {
    end(ses,tx);
  }
}
