{
  long remaining=limit - position;
  checkClosed();
  if (len > remaining)   throw new EOFException("End of stream reached before data was fully read.");
  readStart();
  try {
    int read=this.buf.flatten(buf,position,off,len);
    total+=read;
    if (read != len) {
      int readAmt=len - read;
      delegate.hadoop().readData(delegate,position + read,readAmt,buf,off + read,readAmt).get();
      total+=readAmt;
    }
    if (clientLog.isLogEnabled())     clientLog.logRandomRead(logStreamId,position,len);
  }
 catch (  GridException e) {
    throw GridGgfsHadoopUtils.cast(e);
  }
 finally {
    readEnd();
  }
}
