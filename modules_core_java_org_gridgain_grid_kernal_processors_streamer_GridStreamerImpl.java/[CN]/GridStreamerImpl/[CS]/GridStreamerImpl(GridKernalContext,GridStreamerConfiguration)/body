{
  this.ctx=ctx;
  log=ctx.log(GridStreamerImpl.class);
  atLeastOnce=c.isAtLeastOnce();
  name=c.getName();
  router=c.getRouter();
  this.c=c;
  if (atLeastOnce) {
    if (c.getMaximumConcurrentSessions() > 0)     sem=new Semaphore(c.getMaximumConcurrentSessions());
  }
  topic=name == null ? TOPIC_STREAM : TOPIC_STREAM.topic(name);
  lock=new GridSpinReadWriteLock();
  stageFuts=new ConcurrentHashMap8<>();
  batchFuts=new ConcurrentHashMap8<>();
  streamerCtx=new GridStreamerContextImpl(ctx,c,this);
}
