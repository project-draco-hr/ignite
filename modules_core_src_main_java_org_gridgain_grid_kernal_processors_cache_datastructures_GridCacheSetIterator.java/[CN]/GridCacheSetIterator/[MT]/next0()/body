{
  try {
    while (it == null || !it.hasNext()) {
      if (nodes.isEmpty())       return null;
      GridCacheSetDataResponse res=resQueue.take();
      if (res.last())       nodes.remove(res.nodeId());
 else       sendIteratorRequest(req,Collections.singleton(res.nodeId()));
      it=res.data().iterator();
    }
    return it.next();
  }
 catch (  Exception e) {
    throw new GridRuntimeException(e);
  }
}
