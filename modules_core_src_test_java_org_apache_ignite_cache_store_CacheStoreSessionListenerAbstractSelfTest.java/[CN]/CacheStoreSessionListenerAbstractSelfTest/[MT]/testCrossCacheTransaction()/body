{
  CacheConfiguration<Integer,Integer> cfg1=cacheConfiguration("cache1",CacheAtomicityMode.TRANSACTIONAL);
  CacheConfiguration<Integer,Integer> cfg2=cacheConfiguration("cache2",CacheAtomicityMode.TRANSACTIONAL);
  IgniteCache<Integer,Integer> cache1=ignite(0).createCache(cfg1);
  IgniteCache<Integer,Integer> cache2=ignite(0).createCache(cfg2);
  try (Transaction tx=ignite(0).transactions().txStart()){
    cache1.put(1,1);
    cache2.put(2,2);
    cache1.remove(3);
    cache2.remove(4);
    tx.commit();
  }
  finally {
    cache1.destroy();
    cache2.destroy();
  }
  assertEquals(2,writeCnt.get());
  assertEquals(2,deleteCnt.get());
  assertEquals(3,reuseCnt.get());
}
