{
  GridConfiguration cfg=super.getConfiguration(gridName);
  GridTcpDiscoverySpi discoSpi=new GridTcpDiscoverySpi();
  discoSpi.setIpFinder(IP_FINDER);
  cfg.setDiscoverySpi(discoSpi);
  if (portables) {
    GridPortableConfiguration portableCfg=new GridPortableConfiguration();
    portableCfg.setTypeConfigurations(Arrays.asList(new GridPortableTypeConfiguration(TestObject.class.getName()),new GridPortableTypeConfiguration(TestObjectBad.class.getName())));
    cfg.setPortableConfiguration(portableCfg);
  }
  if (cnt < 4)   cfg.setCacheConfiguration(cacheConfiguration());
  cnt++;
  return cfg;
}
