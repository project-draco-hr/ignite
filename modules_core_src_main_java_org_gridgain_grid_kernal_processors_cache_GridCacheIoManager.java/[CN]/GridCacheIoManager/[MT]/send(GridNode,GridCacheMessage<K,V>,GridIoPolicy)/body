{
  onSend(msg,node.id());
  if (log.isDebugEnabled())   log.debug("Sending cache message [msg=" + msg + ", node="+ U.toShortString(node)+ ']');
  int cnt=0;
  boolean first=true;
  while (cnt <= retryCnt) {
    try {
      cnt++;
      GridCacheMessage<K,V> msg0;
      if (first) {
        msg0=msg;
        first=false;
      }
 else       msg0=(GridCacheMessage<K,V>)msg.clone();
      cctx.gridIO().send(node,TOPIC_CACHE,msg0,plc);
      return;
    }
 catch (    GridException e) {
      if (!cctx.discovery().alive(node.id()) || !cctx.discovery().pingNode(node.id()))       throw new GridTopologyException("Node left grid while sending message to: " + node.id(),e);
      if (cnt == retryCnt)       throw e;
 else       if (log.isDebugEnabled())       log.debug("Failed to send message to node (will retry): " + node.id());
    }
    U.sleep(retryDelay);
  }
  if (log.isDebugEnabled())   log.debug("Sent cache message [msg=" + msg + ", node="+ U.toShortString(node)+ ']');
}
