{
  Snapshot cur;
  while ((cur=topSnap.get()) == null) {
    if (topSnap.compareAndSet(null,cur=new Snapshot(AffinityTopologyVersion.ZERO,new DiscoCache(localNode(),getSpi().getRemoteNodes())))) {
      return cur.discoCache;
    }
  }
  return cur.discoCache;
}
