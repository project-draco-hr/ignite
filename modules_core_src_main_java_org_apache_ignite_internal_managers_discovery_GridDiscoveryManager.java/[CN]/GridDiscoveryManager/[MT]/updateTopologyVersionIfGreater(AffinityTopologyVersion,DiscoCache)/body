{
  while (true) {
    Snapshot cur=topSnap.get();
    if (updated.compareTo(cur.topVer) >= 0) {
      if (topSnap.compareAndSet(cur,new Snapshot(updated,discoCache)))       return true;
    }
 else     return false;
  }
}
