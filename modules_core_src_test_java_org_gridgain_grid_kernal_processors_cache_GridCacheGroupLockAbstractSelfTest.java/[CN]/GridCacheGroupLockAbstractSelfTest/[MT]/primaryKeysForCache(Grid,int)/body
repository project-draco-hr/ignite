{
  Collection<UUID> keys=new LinkedHashSet<>();
  int iters=0;
  do {
    keys.add(primaryKeyForCache(primary));
    iters++;
    if (iters > 10000)     throw new IllegalStateException("Cannot find keys for primary node [nodeId=" + primary.localNode().id() + ", cnt="+ cnt+ ']');
  }
 while (keys.size() < cnt);
  UUID[] res=new UUID[keys.size()];
  return keys.toArray(res);
}
