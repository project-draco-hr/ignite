{
  AffinityTopologyVersion topVer=cctx.mvcc().lastExplicitLockTopologyVersion(Thread.currentThread().getId());
  if (topVer == null && tx != null && tx.system()) {
    IgniteInternalTx tx0=cctx.tm().anyActiveThreadTx(tx);
    if (tx0 != null)     topVer=tx0.topologyVersionSnapshot();
  }
  if (topVer != null) {
    tx.topologyVersion(topVer);
    cctx.mvcc().addFuture(this);
    prepare0(false);
    return;
  }
  prepareOnTopology(false,null);
}
