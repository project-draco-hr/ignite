{
  timer.cancel();
  if (msgWorker.isAlive()) {
    msgWorker.addMessage(SPI_STOP);
    try {
      if (!leaveLatch.await(10000,MILLISECONDS)) {
        System.out.println("leaveLatch Timeout!!!!");
        if (log.isDebugEnabled())         U.error(log,"Failed to left node: timeout [nodeId=" + locNode + ']');
      }
    }
 catch (    InterruptedException ignored) {
    }
  }
  rmtNodes.clear();
  U.interrupt(sockTimeoutWorker);
  U.interrupt(msgWorker);
  U.interrupt(sockWriter);
  U.interrupt(sockReader);
  U.join(msgWorker,log);
  U.join(sockTimeoutWorker,log);
  U.join(sockWriter,log);
  U.join(sockReader,log);
  unregisterMBean();
  if (log.isDebugEnabled())   log.debug(stopInfo());
}
