{
  GridCompoundFuture<Object,Object> res=new GridCompoundFuture<>(cctx.kernalContext());
  res.ignoreChildFailures(ClusterTopologyException.class,GridCachePartialUpdateException.class);
  for (  GridCacheAtomicFuture<K,?> fut : atomicFuts.values()) {
    if (fut.waitForPartitionExchange() && fut.topologyVersion() < topVer)     res.add((IgniteFuture<Object>)fut);
  }
  res.markInitialized();
  return res;
}
