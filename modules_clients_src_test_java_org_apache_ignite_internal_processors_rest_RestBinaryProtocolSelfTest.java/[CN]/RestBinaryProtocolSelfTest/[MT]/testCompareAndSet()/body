{
  assertFalse(client.cacheCompareAndSet(null,"key",null,null));
  IgniteCache<Object,Object> jcache=grid().cache(null);
  jcache.put("key","val");
  assertTrue(client.cacheCompareAndSet(null,"key",null,null));
  assertNull(jcache.get("key"));
  assertFalse(client.cacheCompareAndSet(null,"key",null,"val"));
  jcache.put("key","val");
  assertFalse(client.cacheCompareAndSet(null,"key",null,"wrongVal"));
  assertEquals("val",jcache.get("key"));
  assertTrue(client.cacheCompareAndSet(null,"key",null,"val"));
  assertNull(jcache.get("key"));
  assertTrue(client.cacheCompareAndSet(null,"key","val",null));
  assertEquals("val",jcache.get("key"));
  assertFalse(client.cacheCompareAndSet(null,"key","newVal",null));
  assertEquals("val",jcache.get("key"));
  jcache.remove("key");
  assertFalse(client.cacheCompareAndSet(null,"key","val1","val2"));
  jcache.put("key","val2");
  assertFalse(client.cacheCompareAndSet(null,"key","val1","wrongVal"));
  assertEquals("val2",jcache.get("key"));
  assertTrue(client.cacheCompareAndSet(null,"key","val1","val2"));
  assertEquals("val1",jcache.get("key"));
  jcache.remove("key");
  assertFalse(client.cacheCompareAndSet(CACHE_NAME,"key",null,null));
  IgniteCache<Object,Object> jcacheName=grid().cache(CACHE_NAME);
  jcacheName.put("key","val");
  assertTrue(client.cacheCompareAndSet(CACHE_NAME,"key",null,null));
  assertNull(jcacheName.get("key"));
  assertFalse(client.cacheCompareAndSet(CACHE_NAME,"key",null,"val"));
  jcacheName.put("key","val");
  assertFalse(client.cacheCompareAndSet(CACHE_NAME,"key",null,"wrongVal"));
  assertEquals("val",jcacheName.get("key"));
  assertTrue(client.cacheCompareAndSet(CACHE_NAME,"key",null,"val"));
  assertNull(jcacheName.get("key"));
  assertTrue(client.cacheCompareAndSet(CACHE_NAME,"key","val",null));
  assertEquals("val",jcacheName.get("key"));
  assertFalse(client.cacheCompareAndSet(CACHE_NAME,"key","newVal",null));
  assertEquals("val",jcacheName.get("key"));
  jcacheName.remove("key");
  assertFalse(client.cacheCompareAndSet(CACHE_NAME,"key","val1","val2"));
  jcacheName.put("key","val2");
  assertFalse(client.cacheCompareAndSet(CACHE_NAME,"key","val1","wrongVal"));
  assertEquals("val2",jcacheName.get("key"));
  assertTrue(client.cacheCompareAndSet(CACHE_NAME,"key","val1","val2"));
  assertEquals("val1",jcacheName.get("key"));
  jcacheName.remove("key");
}
