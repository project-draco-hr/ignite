{
  A.notNull(job,"job");
  if (job instanceof GridComputeJobMasterLeaveAware) {
    return new GridMasterLeaveAwareComputeJobAdapter(){
{
        peerDeployLike(U.peerDeployAware(job));
      }
      @Nullable @Override public Object execute(){
        return job.apply(arg);
      }
      @Override public void onMasterNodeLeft(      GridComputeTaskSession ses) throws GridException {
        ((GridComputeJobMasterLeaveAware)job).onMasterNodeLeft(ses);
      }
    }
;
  }
 else {
    return new GridComputeJobAdapter(){
{
        peerDeployLike(U.peerDeployAware(job));
      }
      @Nullable @Override public Object execute(){
        return job.apply(arg);
      }
    }
;
  }
}
