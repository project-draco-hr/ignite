{
  FileSwapSpaceSpi swap=(FileSwapSpaceSpi)ignite(nodeIdx).configuration().getSwapSpaceSpi();
  IgniteSpiCloseableIterator<Integer> it=swap.keyIterator(SPACE_NAME,null);
  assertNotNull(it);
  CacheAffinity aff=ignite(nodeIdx).affinity(null);
  ClusterNode node=ignite(nodeIdx).cluster().localNode();
  List<Integer> primary=new ArrayList<>();
  List<Integer> backups=new ArrayList<>();
  while (it.hasNext()) {
    Integer key=it.next();
    if (aff.isPrimary(node,key))     primary.add(key);
 else {
      assertTrue(aff.isBackup(node,key));
      backups.add(key);
    }
  }
  return new T2<>(primary,backups);
}
