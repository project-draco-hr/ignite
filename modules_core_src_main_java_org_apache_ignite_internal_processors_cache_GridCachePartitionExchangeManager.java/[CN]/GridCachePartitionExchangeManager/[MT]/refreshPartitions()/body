{
  ClusterNode oldest=CU.oldestAliveCacheServerNode(cctx,AffinityTopologyVersion.NONE);
  if (oldest == null) {
    if (log.isDebugEnabled())     log.debug("Skip partitions refresh, there are no server nodes [loc=" + cctx.localNodeId() + ']');
    return;
  }
  if (log.isDebugEnabled())   log.debug("Refreshing partitions [oldest=" + oldest.id() + ", loc="+ cctx.localNodeId()+ ']');
  Collection<ClusterNode> rmts=null;
  try {
    if (oldest.id().equals(cctx.localNodeId())) {
      rmts=CU.remoteNodes(cctx);
      if (log.isDebugEnabled())       log.debug("Refreshing partitions from oldest node: " + cctx.localNodeId());
      sendAllPartitions(rmts);
    }
 else {
      if (log.isDebugEnabled())       log.debug("Refreshing local partitions from non-oldest node: " + cctx.localNodeId());
      sendLocalPartitions(oldest,null);
    }
  }
 catch (  IgniteCheckedException e) {
    U.error(log,"Failed to refresh partition map [oldest=" + oldest.id() + ", rmts="+ U.nodeIds(rmts)+ ", loc="+ cctx.localNodeId()+ ']',e);
  }
}
