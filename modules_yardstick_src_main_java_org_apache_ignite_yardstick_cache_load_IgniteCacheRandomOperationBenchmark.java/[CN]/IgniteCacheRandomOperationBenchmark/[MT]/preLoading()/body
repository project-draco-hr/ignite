{
  if (args.preloadAmount() > args.range())   throw new IllegalArgumentException("Preloading amount (\"-pa\", \"--preloadAmount\") must by less then the" + " range (\"-r\", \"--range\").");
  Thread[] threads=new Thread[availableCaches.size()];
  for (int i=0; i < availableCaches.size(); i++) {
    final String cacheName=availableCaches.get(i).getName();
    threads[i]=new Thread(){
      @Override public void run(){
        try (IgniteDataStreamer dataLdr=ignite().dataStreamer(cacheName)){
          for (int i=0; i < args.preloadAmount() && !isInterrupted(); i++)           dataLdr.addData(createRandomKey(i,cacheName),createRandomValue(i,cacheName));
        }
       }
    }
;
    threads[i].start();
  }
  for (  Thread thread : threads) {
    thread.join();
  }
}
