{
  Path file=new Path("/file1");
  long now=System.currentTimeMillis();
  try (FSDataOutputStream os=fs.create(file,EnumSet.noneOf(CreateFlag.class),Options.CreateOpts.perms(FsPermission.getDefault()))){
    os.write(new byte[1024 * 1024]);
  }
   FileStatus status=fs.getFileStatus(file);
  assertTrue(status.getAccessTime() >= now);
  assertTrue(status.getModificationTime() >= now);
  long accessTime=now - 10 * 60 * 1000;
  long modificationTime=now - 5 * 60 * 1000;
  fs.setTimes(file,modificationTime,accessTime);
  status=fs.getFileStatus(file);
  assertEquals(accessTime,status.getAccessTime());
  assertEquals(modificationTime,status.getModificationTime());
  FileStatus[] files=fs.listStatus(new Path("/"));
  assertEquals(1,files.length);
  assertEquals(file.getName(),files[0].getPath().getName());
  assertEquals(accessTime,files[0].getAccessTime());
  assertEquals(modificationTime,files[0].getModificationTime());
  GridTestUtils.assertThrows(log,new Callable<Object>(){
    @Override public Object call() throws Exception {
      fs.setTimes(new Path("/unknownFile"),0,0);
      return null;
    }
  }
,FileNotFoundException.class,null);
}
