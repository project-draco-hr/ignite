{
  initCap=10;
  map=newMap();
  for (int p=0; p < parts; p++) {
    Map<String,String> kv=new HashMap<>(10);
    for (int i=0; i < 10; i++)     kv.put(string(),string());
    for (    Map.Entry<String,String> e : kv.entrySet()) {
      String key=e.getKey();
      String val=e.getValue();
      map.insert(p,hash(key),key.getBytes(),val.getBytes());
      assertTrue(map.contains(p,hash(key),key.getBytes()));
      assertEquals(val,new String(map.get(p,hash(key),key.getBytes())));
    }
    for (    Map.Entry<String,String> e : kv.entrySet()) {
      String key=e.getKey();
      String val=e.getValue();
      byte[] valBytes=map.get(p,hash(key),key.getBytes());
      assertNotNull(valBytes);
      assertEquals(val,new String(valBytes));
    }
  }
  assertEquals(parts * 10,map.size());
}
