{
  GridNodeLocalMap<String,VisorFutureResultSetHolder<List<?>>> storage=g.nodeLocalMap();
  VisorFutureResultSetHolder<List<?>> t=storage.get(arg.get1());
  if (t == null)   throw new GridInternalException("SQL query results are expired.");
  GridBiTuple<List<Object[]>,List<?>> nextRows=fetchSqlQueryRows(t.future(),t.next(),arg.get2());
  boolean hasMore=nextRows.get2() != null;
  if (hasMore)   storage.put(arg.get1(),new VisorFutureResultSetHolder<>(t.future(),nextRows.get2(),true));
 else   storage.remove(arg.get1());
  return new VisorQueryResult(nextRows.get1(),hasMore);
}
