{
  writeCnt.incrementAndGet();
  checkConnection();
  if (write.get()) {
    Connection conn=connection();
    try {
      String table;
switch (ses.cacheName()) {
case "cache1":
        table="Table1";
      break;
case "cache2":
    if (fail.get())     throw new CacheWriterException("Expected failure.");
  table="Table2";
break;
default :
throw new CacheWriterException("Wring cache: " + ses.cacheName());
}
PreparedStatement stmt=conn.prepareStatement("INSERT INTO " + table + " (key, value) VALUES (?, ?)");
stmt.setInt(1,entry.getKey());
stmt.setInt(2,entry.getValue());
stmt.executeUpdate();
}
 catch (SQLException e) {
throw new CacheWriterException(e);
}
}
}
