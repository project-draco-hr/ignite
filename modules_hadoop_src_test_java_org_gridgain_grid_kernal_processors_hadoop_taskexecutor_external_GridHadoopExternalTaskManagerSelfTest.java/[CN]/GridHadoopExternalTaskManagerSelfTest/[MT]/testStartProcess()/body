{
  try {
    startGrids(1);
    GridHadoopOpProcessor hadoop=(GridHadoopOpProcessor)((GridKernal)grid(0)).context().hadoop();
    GridHadoopExternalTaskManager registry=new GridHadoopExternalTaskManager(hadoop.context());
    registry.start();
    GridHadoopExternalTaskMetadata meta=new GridHadoopExternalTaskMetadata();
    Collection<String> classpath=Arrays.asList(System.getProperty("java.class.path").split(":"));
    meta.classpath(classpath);
    meta.jvmOptions(Arrays.asList("-Xmx1g","-DGRIDGAIN_HOME=" + U.getGridGainHome()));
    System.out.println(">>>>>>>>>>>>>>>>>> Starting process: " + meta);
    GridFuture<GridHadoopProcessDescriptor> fut=registry.startProcess(meta);
    GridHadoopProcessDescriptor proc=fut.get();
    System.out.println(">>>>>>>>> Started process: " + proc);
  }
  finally {
    stopAllGrids();
  }
}
