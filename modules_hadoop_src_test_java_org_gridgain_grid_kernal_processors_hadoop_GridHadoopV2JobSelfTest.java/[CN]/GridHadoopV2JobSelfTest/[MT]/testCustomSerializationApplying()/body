{
  JobConf cfg=new JobConf();
  cfg.setMapOutputKeyClass(IntWritable.class);
  cfg.setMapOutputValueClass(Text.class);
  cfg.set(CommonConfigurationKeys.IO_SERIALIZATIONS_KEY,CustomSerialization.class.getName());
  GridHadoopJob job=new GridHadoopV2Job(new GridHadoopJobId(UUID.randomUUID(),1),new GridHadoopDefaultJobInfo(cfg),log);
  GridHadoopTaskContext taskCtx=job.getTaskContext(new GridHadoopTaskInfo(null,GridHadoopTaskType.MAP,null,0,0,null));
  GridHadoopSerialization ser=taskCtx.keySerialization();
  assertEquals(GridHadoopSerializationWrapper.class,ser.getClass());
  DataInput in=new DataInputStream(new ByteArrayInputStream(new byte[0]));
  assertEquals(TEST_SERIALIZED_VALUE,ser.read(in,null).toString());
  ser=taskCtx.valueSerialization();
  assertEquals(GridHadoopSerializationWrapper.class,ser.getClass());
  assertEquals(TEST_SERIALIZED_VALUE,ser.read(in,null).toString());
}
