{
  A.notNull(r,"job");
  if (r instanceof ComputeJobMasterLeaveAware) {
    return new GridMasterLeaveAwareComputeJobAdapter(){
      @Nullable @Override public Object execute(){
        r.run();
        return null;
      }
      @Override public void onMasterNodeLeft(      ComputeTaskSession ses) throws IgniteCheckedException {
        ((ComputeJobMasterLeaveAware)r).onMasterNodeLeft(ses);
      }
    }
;
  }
 else {
    return new ComputeJobAdapter(){
      @Nullable @Override public Object execute(){
        r.run();
        return null;
      }
    }
;
  }
}
