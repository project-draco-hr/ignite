{
  if (releases == 0)   return true;
  for (; ; ) {
    if (broken)     return true;
    int cur=getState();
    int next=cur + releases;
    if (next < cur)     throw new Error("Maximum permit count exceeded");
    if (compareAndSetGlobalState(cur,next,false))     return true;
  }
}
