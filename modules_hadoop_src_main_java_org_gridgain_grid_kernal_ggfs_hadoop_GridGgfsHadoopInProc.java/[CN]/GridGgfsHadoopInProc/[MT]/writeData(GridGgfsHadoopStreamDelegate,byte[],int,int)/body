{
  try {
    GridGgfsOutputStream stream=delegate.target();
    stream.write(data,off,len);
  }
 catch (  IllegalStateException|IOException e) {
    GridGgfsHadoopStreamEventListener lsnr=lsnrs.get(delegate);
    if (lsnr != null)     lsnr.onError(e.getMessage());
    if (e instanceof IllegalStateException)     throw new IOException("Failed to write data to GGFS stream because Grid is stopping.",e);
 else     throw e;
  }
}
