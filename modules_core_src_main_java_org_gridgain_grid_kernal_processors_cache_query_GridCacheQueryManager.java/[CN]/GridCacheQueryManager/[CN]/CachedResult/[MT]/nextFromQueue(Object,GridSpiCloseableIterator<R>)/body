{
synchronized (recipients) {
    int pos=recipients.get(recipient);
    R res=null;
    try {
      int off=pos - pruned;
      if (off < queue.size)       res=queue.get(off);
 else       if (it.hasNext()) {
        res=it.next();
        queue.add(res);
      }
    }
  finally {
      if (res != null)       pruneQueue(recipient,pos + 1);
    }
    return res;
  }
}
