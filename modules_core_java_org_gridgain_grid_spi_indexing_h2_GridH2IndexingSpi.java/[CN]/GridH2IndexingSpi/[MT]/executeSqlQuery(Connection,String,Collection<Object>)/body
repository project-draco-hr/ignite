{
  PreparedStatement stmt;
  try {
    stmt=conn.prepareStatement(sql);
  }
 catch (  SQLException e) {
    if (e.getErrorCode() == ErrorCode.TABLE_OR_VIEW_NOT_FOUND_1)     return null;
    throw new GridSpiException("Failed to parse query: " + sql,e);
  }
switch (commandType(stmt)) {
case CommandInterface.SELECT:
case CommandInterface.CALL:
case CommandInterface.EXPLAIN:
case CommandInterface.ANALYZE:
    break;
default :
  throw new GridSpiException("Failed to execute non-query SQL statement: " + sql);
}
bindParameters(stmt,params);
return new T2<>(stmt,stmt.executeQuery());
}
