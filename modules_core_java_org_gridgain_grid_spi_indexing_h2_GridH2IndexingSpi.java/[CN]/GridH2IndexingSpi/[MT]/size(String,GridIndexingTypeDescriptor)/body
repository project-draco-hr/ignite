{
  Connection conn=connectionForThread(null);
  TableDescriptor tbl=tableDescriptor(spaceName,type);
  if (tbl == null)   return -1;
  try {
    ResultSet rs=executeSqlQueryWithTimer(conn,"SELECT COUNT(*) FROM " + tbl.fullTableName(),null).get2();
    rs.next();
    return rs.getInt(1);
  }
 catch (  SQLException e) {
    U.rollbackConnection(conn,log);
    onSqlException();
    throw new GridSpiException("Failed to get table size: " + tbl.fullTableName(),e);
  }
}
