{
  this.tbl=tbl;
  ArrayList<Index> idxs=new ArrayList<>();
  idxs.add(new GridH2TreeIndex("_key_PK",tbl,true,GridH2AbstractKeyValueRow.KEY_COL,GridH2AbstractKeyValueRow.VAL_COL,offheap,tbl.indexColumn(0,ASCENDING)));
  if (type().valueClass() == String.class) {
    try {
      luceneIdx=new GridLuceneIndex(marshaller,offheap,spaceName,type,true);
    }
 catch (    GridSpiException e1) {
      throw new GridRuntimeException(e1);
    }
  }
  for (  Map.Entry<String,GridIndexDescriptor> e : type.indexes().entrySet()) {
    String name=e.getKey();
    GridIndexDescriptor idx=e.getValue();
    if (idx.text()) {
      try {
        luceneIdx=new GridLuceneIndex(marshaller,offheap,spaceName,type,true);
      }
 catch (      GridSpiException e1) {
        throw new GridRuntimeException(e1);
      }
    }
 else {
      IndexColumn[] cols=new IndexColumn[idx.fields().size()];
      int i=0;
      for (      String field : idx.fields()) {
        Column col=tbl.getColumn(field.toUpperCase());
        cols[i++]=tbl.indexColumn(col.getColumnId(),idx.descending(field) ? DESCENDING : ASCENDING);
      }
      idxs.add(new GridH2TreeIndex(name,tbl,idx.unique(),GridH2AbstractKeyValueRow.KEY_COL,GridH2AbstractKeyValueRow.VAL_COL,offheap,cols));
    }
  }
  return idxs;
}
