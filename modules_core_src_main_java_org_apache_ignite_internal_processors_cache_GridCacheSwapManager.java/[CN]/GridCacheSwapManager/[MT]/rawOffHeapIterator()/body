{
  if (!offheapEnabled)   return new GridEmptyCloseableIterator<>();
  return new GridCloseableIteratorAdapter<Map.Entry<byte[],byte[]>>(){
    private GridCloseableIterator<IgniteBiTuple<byte[],byte[]>> it=offheap.iterator(spaceName);
    private Map.Entry<byte[],byte[]> cur;
    @Override protected Map.Entry<byte[],byte[]> onNext(){
      return cur=it.next();
    }
    @Override protected boolean onHasNext(){
      return it.hasNext();
    }
    @Override protected void onRemove() throws IgniteCheckedException {
      KeyCacheObject key=cctx.toCacheKeyObject(cur.getKey(),cur.getKey(),false);
      int part=cctx.affinity().partition(key);
      offheap.removex(spaceName,part,key,key.valueBytes(cctx));
    }
    @Override protected void onClose() throws IgniteCheckedException {
      it.close();
    }
  }
;
}
