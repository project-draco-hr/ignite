{
  final GridCacheQueryManager qryMgr=cctx.queries();
  GridCacheSwapEntry entry;
  if (qryMgr != null) {
    entry=readOffheapBeforeRemove(key,keyBytes,part);
    if (entry != null) {
      if (offheap.removex(spaceName,part,key,keyBytes)) {
        if (cctx.config().isStatisticsEnabled())         cctx.cache().metrics0().onOffHeapRemove();
      }
 else       entry=null;
    }
  }
 else {
    byte[] entryBytes=offheap.remove(spaceName,part,key,keyBytes);
    if (entryBytes != null) {
      if (cctx.config().isStatisticsEnabled())       cctx.cache().metrics0().onOffHeapRemove();
      entry=swapEntry(unmarshalSwapEntry(entryBytes));
    }
 else     entry=null;
  }
  return entry;
}
