{
  if (!offheapEnabled && !swapEnabled)   return;
  checkIteratorQueue();
  final GridCacheQueryManager qryMgr=cctx.queries();
  CI1<byte[]> c=qryMgr == null ? null : new CI1<byte[]>(){
    @Override public void apply(    byte[] rmv){
      if (rmv == null)       return;
      try {
        GridCacheSwapEntry entry=swapEntry(unmarshalSwapEntry(rmv));
        if (entry == null)         return;
        qryMgr.onUnswap(key,entry.value(),entry.valueBytes());
      }
 catch (      IgniteCheckedException e) {
        throw new IgniteException(e);
      }
    }
  }
;
  int part=cctx.affinity().partition(key);
  if (offheapEnabled) {
    byte[] val=offheap.remove(spaceName,part,key.value(cctx,false),key.valueBytes(cctx));
    if (val != null) {
      if (c != null)       c.apply(val);
      return;
    }
  }
  if (swapEnabled) {
    swapMgr.remove(spaceName,new SwapKey(key.value(cctx,false),part,key.valueBytes(cctx)),c,cctx.deploy().globalLoader());
  }
}
