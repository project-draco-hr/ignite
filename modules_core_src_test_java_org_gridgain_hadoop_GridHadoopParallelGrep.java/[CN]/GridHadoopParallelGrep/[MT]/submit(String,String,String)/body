{
  JobConf grepJob=new JobConf(getConf(),GridHadoopParallelGrep.class);
  grepJob.setJobName("grep-search");
  FileInputFormat.setInputPaths(grepJob,input);
  grepJob.setMapperClass(RegexMapper.class);
  grepJob.set("mapred.mapper.regex",regex);
  grepJob.setCombinerClass(LongSumReducer.class);
  grepJob.setReducerClass(LongSumReducer.class);
  FileOutputFormat.setOutputPath(grepJob,new Path(output));
  grepJob.setOutputFormat(SequenceFileOutputFormat.class);
  grepJob.setOutputKeyClass(Text.class);
  grepJob.setOutputValueClass(LongWritable.class);
  return client.submitJob(grepJob);
}
