{
  if (args.length < 3) {
    System.out.println("Grep <numJobs> <inDir> <outDir> <regex>");
    ToolRunner.printGenericCommandUsage(System.out);
    return -1;
  }
  JobConf jobConf=new JobConf(getConf());
  client=new JobClient(jobConf);
  int numJobs=Integer.parseInt(args[0]);
  Collection<RunningJob> jobs=new ArrayList<>(numJobs);
  for (int i=0; i < numJobs; i++)   jobs.add(submit(args[1],args[2] + i,args[3]));
  int ret=0;
  for (  RunningJob job : jobs) {
    if (!client.monitorAndPrintJob(jobConf,job)) {
      System.out.println("Job failed: " + job.getID());
      ret=-1;
    }
  }
  return ret;
}
