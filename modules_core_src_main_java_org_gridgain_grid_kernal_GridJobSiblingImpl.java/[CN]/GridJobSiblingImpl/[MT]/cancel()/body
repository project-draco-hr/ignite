{
  GridTaskSessionImpl ses=ctx.session().getSession(sesId);
  if (ses == null) {
    Collection<ClusterNode> nodes=ctx.discovery().remoteNodes();
    if (!nodes.isEmpty())     ctx.io().send(nodes,TOPIC_JOB_CANCEL,new GridJobCancelRequest(sesId,jobId),SYSTEM_POOL);
    ctx.job().cancelJob(sesId,jobId,false);
    return;
  }
  for (  ClusterNode node : ctx.discovery().nodes(ses.getTopology())) {
    if (ctx.localNodeId().equals(node.id()))     ctx.job().cancelJob(ses.getId(),jobId,false);
 else {
      try {
        ctx.io().send(node,TOPIC_JOB_CANCEL,new GridJobCancelRequest(ses.getId(),jobId),SYSTEM_POOL);
      }
 catch (      GridException e) {
        if (ctx.discovery().node(node.id()) != null && ctx.discovery().pingNode(node.id()))         U.error(ctx.log(GridJobSiblingImpl.class),"Failed to send cancel request to node " + "[nodeId=" + node.id() + ", ses="+ ses+ ']',e);
      }
    }
  }
}
