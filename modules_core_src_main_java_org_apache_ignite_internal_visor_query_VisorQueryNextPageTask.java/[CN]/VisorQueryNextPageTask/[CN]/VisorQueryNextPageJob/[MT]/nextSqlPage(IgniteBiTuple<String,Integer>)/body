{
  long start=U.currentTimeMillis();
  ConcurrentMap<String,VisorQueryTask.VisorQueryCursorHolder> storage=ignite.cluster().nodeLocalMap();
  VisorQueryTask.VisorQueryCursorHolder t=storage.get(arg.get1());
  if (t == null)   throw new GridInternalException("SQL query results are expired.");
  VisorQueryCursor cur=t.cursor();
  List<Object[]> nextRows=VisorQueryUtils.fetchSqlQueryRows(cur,arg.get2());
  boolean hasMore=cur.hasNext();
  if (hasMore)   storage.put(arg.get1(),new VisorQueryTask.VisorQueryCursorHolder(t.cursor(),true));
 else   storage.remove(arg.get1());
  return new VisorQueryResult(nextRows,hasMore,U.currentTimeMillis() - start);
}
