{
  long start=U.currentTimeMillis();
  ConcurrentMap<String,VisorQueryCursorHolder<Cache.Entry<Object,Object>>> storage=ignite.cluster().nodeLocalMap();
  VisorQueryCursorHolder<Cache.Entry<Object,Object>> holder=storage.get(arg.get1());
  if (holder == null)   throw new IgniteException("Scan query results are expired.");
  VisorQueryCursor<Cache.Entry<Object,Object>> cur=holder.cursor();
  List<Object[]> rows=VisorQueryUtils.fetchScanQueryRows(cur,arg.get2());
  boolean hasMore=cur.hasNext();
  if (hasMore)   holder.accessed(true);
 else   storage.remove(arg.get1());
  return new VisorQueryResult(rows,hasMore,U.currentTimeMillis() - start);
}
