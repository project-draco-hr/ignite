{
  if (log.isDebugEnabled())   log.debug("Load cache using custom query [cache name= " + em.cacheName + ", key type="+ em.keyType()+ ", query="+ qry+ "]");
  Connection conn=null;
  PreparedStatement stmt=null;
  try {
    conn=openConnection(true);
    stmt=conn.prepareStatement(qry);
    ResultSet rs=stmt.executeQuery();
    ResultSetMetaData meta=rs.getMetaData();
    Map<String,Integer> colIdxs=U.newHashMap(meta.getColumnCount());
    for (int i=1; i <= meta.getColumnCount(); i++)     colIdxs.put(meta.getColumnLabel(i),i);
    while (rs.next()) {
      K1 key=buildObject(em.cacheName,em.keyType(),em.keyColumns(),colIdxs,rs);
      V1 val=buildObject(em.cacheName,em.valueType(),em.valueColumns(),colIdxs,rs);
      clo.apply(key,val);
    }
    return null;
  }
 catch (  SQLException e) {
    throw new CacheLoaderException("Failed to execute custom query for load cache",e);
  }
 finally {
    U.closeQuiet(stmt);
    U.closeQuiet(conn);
  }
}
