{
  String fileName=IGNITE_CONFIGURATION_FILE + cfg.getNodeId();
  if (cfg.getMarshaller() instanceof OptimizedMarshaller) {
    OptimizedMarshaller marsh=(OptimizedMarshaller)cfg.getMarshaller();
    try {
      Field isRequireFiled=marsh.getClass().getDeclaredField("requireSer");
      isRequireFiled.setAccessible(true);
      boolean isRequireSer=isRequireFiled.getBoolean(marsh);
      if (isRequireSer)       throw new UnsupportedOperationException("Unsupported marshaller configuration. " + "readCfgFromFileAndDeleteFile method expect " + OptimizedMarshaller.class.getSimpleName() + "with requireSerializeble flag in 'false'.");
    }
 catch (    NoSuchFieldException|IllegalAccessException e) {
      throw new IgniteException("Failed to check filed of " + OptimizedMarshaller.class.getSimpleName(),e);
    }
  }
 else   throw new UnsupportedOperationException("Unsupported marshaller. " + "readCfgFromFileAndDeleteFile method expect " + OptimizedMarshaller.class.getSimpleName());
  try (OutputStream out=new BufferedOutputStream(new FileOutputStream(fileName))){
    cfg.setMBeanServer(null);
    cfg.setMarshaller(null);
    cfg.setDiscoverySpi(null);
    cfg.setGridLogger(null);
    new XStream().toXML(cfg,out);
  }
   return fileName;
}
