{
  for (int i=0; i < DataMode.values().length; i++) {
    dataMode=DataMode.values()[i];
    if ((getConfiguration().getMarshaller() instanceof JdkMarshaller) && (dataMode == DataMode.PLANE_OBJECT)) {
      info("Skip test for JdkMarshaller & PLANE_OBJECT data mode");
      continue;
    }
    info("Running test in data mode: " + dataMode);
    if (i != 0)     beforeTest();
    try {
      call.run();
    }
  finally {
      if (i + 1 != DataMode.values().length)       afterTest();
    }
  }
}
