{
  for (int i=0; i < DataMode.values().length; i++) {
    dataMode=DataMode.values()[i];
    if (!isCompatible()) {
      info("Skipping test in data mode: " + dataMode);
      continue;
    }
    info("Running test in data mode: " + dataMode);
    if (i != 0)     beforeTest();
    try {
      call.run();
    }
  finally {
      if (i + 1 != DataMode.values().length)       afterTest();
    }
  }
}
