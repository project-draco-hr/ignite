{
  GridHadoopJobMetadata cp=new GridHadoopJobMetadata(meta);
  Collection<GridHadoopFileBlock> blocksCp=new HashSet<>(cp.pendingBlocks());
  blocksCp.removeAll(blocks);
  cp.pendingBlocks(blocksCp);
  cp.failCause(err);
  if (err != null)   cp.phase(PHASE_CANCELLING);
  if (blocksCp.isEmpty()) {
    if (cp.phase() != PHASE_CANCELLING)     cp.phase(PHASE_REDUCE);
  }
  return cp;
}
