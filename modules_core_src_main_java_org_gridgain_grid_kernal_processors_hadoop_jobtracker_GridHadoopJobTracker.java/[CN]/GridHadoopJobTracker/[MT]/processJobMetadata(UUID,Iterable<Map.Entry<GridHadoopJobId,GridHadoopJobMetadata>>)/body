{
  for (  Map.Entry<GridHadoopJobId,GridHadoopJobMetadata> entry : updated) {
    GridHadoopJobId jobId=entry.getKey();
    JobLocalState state=activeJobs.get(jobId);
    if (state == null)     state=F.addIfAbsent(activeJobs,jobId,new JobLocalState());
    GridHadoopJobMetadata meta=entry.getValue();
    GridHadoopJob job=ctx.jobFactory().createJob(jobId,meta.jobInfo());
    Collection<GridHadoopFileBlock> mappers=meta.mapReducePlan().mappers(ctx.localNodeId());
    if (mappers != null) {
      Collection<GridHadoopTask> tasks=new ArrayList<>();
      for (      GridHadoopFileBlock block : mappers) {
        if (state.addMapper(block)) {
          GridHadoopTaskInfo taskInfo=new GridHadoopTaskInfo();
          GridHadoopTask task=job.createTask(taskInfo);
          tasks.add(task);
        }
      }
      ctx.taskExecutor().run(tasks);
    }
  }
}
