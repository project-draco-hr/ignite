{
  GridDhtTxPrepareFuture prepFut=this.prepFut;
  final GridDhtTxFinishFuture fut=new GridDhtTxFinishFuture<>(cctx,this,false);
  cctx.mvcc().addFuture(fut,fut.futureId());
  if (prepFut != null) {
    prepFut.complete();
    prepFut.listen(new CI1<IgniteInternalFuture<?>>(){
      @Override public void apply(      IgniteInternalFuture<?> f){
        finishRollback(f,fut);
      }
    }
);
  }
 else   finishRollback(null,fut);
  return fut;
}
