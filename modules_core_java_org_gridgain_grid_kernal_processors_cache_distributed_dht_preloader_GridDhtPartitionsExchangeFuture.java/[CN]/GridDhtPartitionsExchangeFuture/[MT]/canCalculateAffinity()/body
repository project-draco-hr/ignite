{
  GridCacheAffinityFunction affFunc=cctx.config().getAffinity();
  if (!U.hasAnnotation(affFunc,GridCacheCentralizedAffinityFunction.class))   return true;
  Collection<GridNode> affNodes=CU.affinityNodes(cctx,exchId.topologyVersion());
  return !exchId.nodeId().equals(cctx.localNodeId()) || (affNodes.size() == 1 && affNodes.contains(cctx.localNode()));
}
