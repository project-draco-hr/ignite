{
  int writtenSize=writtenSize();
  long newPageSize=Math.max(writtenSize + requestedSize,pageSize);
  long newPagePtr=mem.allocate(newPageSize);
  pages.add(newPageSize);
  pages.add(newPagePtr);
  GridHadoopOffheapBuffer b=out.buffer();
  b.set(newPagePtr,newPageSize);
  if (writtenSize != 0) {
    mem.copyMemory(writeStart,newPagePtr,writtenSize);
    b.move(writtenSize);
  }
  writeStart=newPagePtr;
  return b.move(requestedSize);
}
