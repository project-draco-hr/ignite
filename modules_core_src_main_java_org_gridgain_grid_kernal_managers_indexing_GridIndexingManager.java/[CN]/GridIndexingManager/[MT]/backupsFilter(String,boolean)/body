{
  if (includeBackups || ctx.cache().internalCache(spaceName).context().isReplicated())   return null;
  final UUID nodeId=ctx.localNodeId();
  return new GridIndexingQueryFilter<K,V>(){
    @Override public boolean apply(    String spaceName,    K key,    V val){
      try {
        return ctx.cache().internalCache(spaceName).context().isReplicated() || nodeId.equals(ctx.affinity().mapKeyToNode(spaceName,key).id());
      }
 catch (      GridException e) {
        throw F.wrap(e);
      }
    }
  }
;
}
