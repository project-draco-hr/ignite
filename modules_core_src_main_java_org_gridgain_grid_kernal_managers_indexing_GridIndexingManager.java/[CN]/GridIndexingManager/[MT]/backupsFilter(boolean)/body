{
  if (includeBackups)   return null;
  final UUID nodeId=ctx.localNodeId();
  return new GridIndexingQueryFilter(){
    @Nullable @Override public GridBiPredicate<K,V> forSpace(    final String spaceName) throws GridException {
      GridCacheAdapter<Object,Object> cache=ctx.cache().internalCache(spaceName);
      if (cache.context().isReplicated() || cache.configuration().getBackups() == 0)       return null;
      return new GridBiPredicate<K,V>(){
        @Override public boolean apply(        K k,        V v){
          try {
            return nodeId.equals(ctx.affinity().mapKeyToNode(spaceName,k).id());
          }
 catch (          GridException e) {
            throw F.wrap(e);
          }
        }
      }
;
    }
  }
;
}
