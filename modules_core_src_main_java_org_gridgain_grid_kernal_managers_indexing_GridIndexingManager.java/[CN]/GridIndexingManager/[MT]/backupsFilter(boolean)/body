{
  if (includeBackups)   return null;
  return new IndexingQueryFilter(){
    @Nullable @Override public IgniteBiPredicate<K,V> forSpace(    final String spaceName){
      final GridCacheAdapter<Object,Object> cache=ctx.cache().internalCache(spaceName);
      if (cache.context().isReplicated() || cache.configuration().getBackups() == 0)       return null;
      return new IgniteBiPredicate<K,V>(){
        @Override public boolean apply(        K k,        V v){
          return cache.context().affinity().primary(ctx.discovery().localNode(),k,-1);
        }
      }
;
    }
  }
;
}
