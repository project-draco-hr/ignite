{
  Path fsHome=new Path(primaryFsUri);
  Path srcDir=new Path(fsHome,"/tmp/");
  Path dstDir=new Path(fsHome,"/tmpNew/");
  FSDataOutputStream os=fs.create(new Path(srcDir,"file1"),EnumSet.noneOf(CreateFlag.class),Options.CreateOpts.perms(FsPermission.getDefault()));
  os.close();
  os=fs.create(new Path(dstDir,"file2"),EnumSet.noneOf(CreateFlag.class),Options.CreateOpts.perms(FsPermission.getDefault()));
  os.close();
  try {
    fs.rename(srcDir,dstDir);
    fail("FileAlreadyExistsException expected.");
  }
 catch (  FileAlreadyExistsException ignore) {
  }
  assertPathExists(fs,dstDir);
  assertPathExists(fs,new Path(dstDir,"file2"));
  assertPathExists(fs,srcDir);
  assertPathExists(fs,new Path(srcDir,"file1"));
}
