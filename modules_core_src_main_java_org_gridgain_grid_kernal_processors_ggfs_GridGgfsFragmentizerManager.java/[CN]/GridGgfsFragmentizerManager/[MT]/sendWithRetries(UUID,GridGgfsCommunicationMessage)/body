{
  for (int i=0; i < MESSAGE_SEND_RETRY_COUNT; i++) {
    try {
      ggfsCtx.send(nodeId,topic,msg,SYSTEM_POOL);
      return;
    }
 catch (    GridException e) {
      if (!ggfsCtx.kernalContext().discovery().alive(nodeId))       throw new GridTopologyException("Failed to send message (node left the grid) " + "[nodeId=" + nodeId + ", msg="+ msg+ ']');
      if (i == MESSAGE_SEND_RETRY_COUNT - 1)       throw e;
      U.sleep(MESSAGE_SEND_RETRY_INTERVAL);
    }
  }
}
