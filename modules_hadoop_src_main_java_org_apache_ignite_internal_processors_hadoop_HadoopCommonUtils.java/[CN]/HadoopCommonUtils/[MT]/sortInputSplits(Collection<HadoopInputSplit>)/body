{
  int id=0;
  TreeSet<SplitSortWrapper> sortedSplits=new TreeSet<>();
  for (  HadoopInputSplit split : splits) {
    long len=split instanceof HadoopFileBlock ? ((HadoopFileBlock)split).length() : 0;
    sortedSplits.add(new SplitSortWrapper(id++,split,len));
  }
  ArrayList<HadoopInputSplit> res=new ArrayList<>(sortedSplits.size());
  for (  SplitSortWrapper sortedSplit : sortedSplits)   res.add(sortedSplit.split);
  return res;
}
