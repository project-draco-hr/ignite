{
  int typeId=in.readInt();
  Class<? extends GridPortableObject> cls=typesMap.get(typeId);
  if (cls == null)   throw new IOException("Unknown portable typeId: " + typeId);
  GridPortableObject portable;
  try {
    portable=cls.newInstance();
  }
 catch (  InstantiationException|IllegalAccessException e) {
    throw new IOException("Failed to instantiate portable object: " + cls,e);
  }
  portable.readPortable(this);
  return portable;
}
