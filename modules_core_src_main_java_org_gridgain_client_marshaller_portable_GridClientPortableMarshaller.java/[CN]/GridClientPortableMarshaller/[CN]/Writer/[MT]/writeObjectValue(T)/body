{
  if (obj instanceof Byte) {
    out.writeByte(TYPE_BYTE);
    out.writeByte((Byte)obj);
  }
 else   if (obj instanceof Integer) {
    out.writeByte(TYPE_INT);
    out.writeInt((Integer)obj);
  }
 else   if (obj instanceof Long) {
    out.writeByte(TYPE_LONG);
    out.writeLong((Long)obj);
  }
 else   if (obj instanceof String) {
    out.writeByte(TYPE_STRING);
    writeStringValue((String)obj);
  }
 else   if (obj instanceof GridPortableObject) {
    out.writeByte(TYPE_USER_OBJECT);
    writePortable((GridPortableObject)obj);
  }
 else   if (obj == null)   out.writeInt(TYPE_NULL);
 else   throw new IOException("Unsupported object: " + obj);
}
