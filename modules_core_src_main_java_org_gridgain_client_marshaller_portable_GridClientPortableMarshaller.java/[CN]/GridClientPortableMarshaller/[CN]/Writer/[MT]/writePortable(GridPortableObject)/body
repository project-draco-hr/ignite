{
  if (portable != null) {
    int handle=handles.lookup(portable);
    if (handle >= 0) {
      out.writeByte(OBJECT_TYPE_REF);
      out.writeInt(handle);
    }
 else {
      out.writeByte(OBJECT_TYPE_OBJECT);
      out.writeInt(portable.typeId());
      portable.writePortable(this);
    }
  }
 else   out.writeByte(OBJECT_TYPE_NULL);
}
