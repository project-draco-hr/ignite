{
  depExe.submit(new BusyRunnable(){
    @Override public void run0(){
      for (      Entry<GridServiceConfigurationKey,GridServiceConfiguration> e : cfgs) {
        GridServiceConfiguration cfg=e.getValue();
        if (cfg != null) {
          long topVer=ctx.discovery().topologyVersion();
          GridNode oldest=U.oldest(ctx.discovery().nodes(topVer),null);
          if (oldest.isLocal())           onDeployment(cfg,topVer);
        }
 else {
          String svcName=e.getKey().name();
          Collection<GridServiceContextImpl> ctxs;
synchronized (locSvcs) {
            ctxs=locSvcs.remove(svcName);
          }
          if (ctx != null) {
synchronized (ctxs) {
              cancel(ctxs,ctxs.size());
            }
          }
          GridFutureAdapter<?> fut=futs.get(cfg.getName());
          if (fut != null)           fut.onDone();
        }
      }
    }
  }
);
  return true;
}
