{
  if (setMapper) {
    job.setMapperClass(HadoopWordCount2Mapper.class);
    job.setInputFormatClass(TextInputFormat.class);
  }
  if (setCombiner)   job.setCombinerClass(HadoopWordCount2Combiner.class);
  if (setReducer) {
    job.setReducerClass(HadoopWordCount2Reducer.class);
    job.setOutputFormatClass(TextOutputFormat.class);
  }
  if (outputCompression) {
    job.setOutputFormatClass(SequenceFileOutputFormat.class);
    SequenceFileOutputFormat.setOutputCompressionType(job,SequenceFile.CompressionType.BLOCK);
    SequenceFileOutputFormat.setCompressOutput(job,true);
    job.getConfiguration().set(FileOutputFormat.COMPRESS_CODEC,SnappyCodec.class.getName());
  }
}
