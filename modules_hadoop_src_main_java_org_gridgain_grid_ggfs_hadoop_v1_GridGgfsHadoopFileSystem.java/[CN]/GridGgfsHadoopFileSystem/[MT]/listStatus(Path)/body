{
  A.notNull(f,"f");
  enterBusy();
  try {
    GridGgfsPath path=convert(f);
    GridGgfsMode mode=mode(path);
    if (mode == PROXY) {
      if (secondaryFs == null) {
        assert mgmt;
        return EMPTY_FILE_STATUS;
      }
      FileStatus[] arr=secondaryFs.listStatus(toSecondary(f));
      if (arr != null) {
        for (int i=0; i < arr.length; i++)         arr[i]=toPrimary(arr[i]);
      }
      if (clientLog.isLogEnabled()) {
        String[] fileArr=null;
        if (arr != null) {
          fileArr=new String[arr.length];
          for (int i=0; i < arr.length; i++)           fileArr[i]=arr[i].getPath().toString();
        }
        clientLog.logListDirectory(path,PROXY,fileArr);
      }
      if (arr == null)       throw new FileNotFoundException("File " + f + " does not exist.");
      return arr;
    }
 else {
      Collection<GridGgfsFile> list=rmtClient.listFiles(path);
      if (list == null)       throw new FileNotFoundException("File " + f + " does not exist.");
      List<GridGgfsFile> files=new ArrayList<>(list);
      FileStatus[] arr=new FileStatus[files.size()];
      for (int i=0; i < arr.length; i++)       arr[i]=convert(files.get(i));
      if (clientLog.isLogEnabled()) {
        String[] fileArr=new String[arr.length];
        for (int i=0; i < arr.length; i++)         fileArr[i]=arr[i].getPath().toString();
        clientLog.logListDirectory(path,mode,fileArr);
      }
      return arr;
    }
  }
 catch (  FileNotFoundException ignored) {
    throw new FileNotFoundException("File " + f + " does not exist.");
  }
 finally {
    leaveBusy();
  }
}
